!function(t,i,e){var s=(e.un,e.uns,e["static"]),n=e["class"],r=e.getset,h=e.__newvec,a=laya.utils.Browser,o=laya.utils.Byte,l=laya.filters.ColorFilter,u=laya.utils.Ease,_=laya.events.Event,c=laya.events.EventDispatcher,d=(laya.display.Graphics,laya.html.dom.HTMLDivElement),g=laya.utils.Handler,f=laya.display.Input,p=laya.utils.Log,m=(laya.display.Node,laya.maths.Point),y=laya.maths.Rectangle,v=laya.renders.Render,b=(laya.media.Sound,laya.media.SoundChannel,laya.display.Sprite),w=(laya.display.Stage,laya.display.Text),x=laya.resource.Texture,I=laya.utils.Tween,C=laya.utils.Utils;e["interface"]("fairygui.IAnimationGear"),e["interface"]("fairygui.IColorGear"),e["interface"]("fairygui.IUISource");var S=function(){function t(){this._asset=null,this._asset=e.loader}n(t,"fairygui.AssetProxy");var i=t.prototype;return i.getRes=function(t){return this._asset.getRes(t)},i.load=function(t,i,e,s,n,r){void 0===n&&(n=1),void 0===r&&(r=!0),this._asset.load(t,i,e,s,n,r)},i.setAsset=function(t){this._asset=t},r(1,t,"inst",function(){return null==fairygui.AssetProxy._inst&&(t._inst=new t),fairygui.AssetProxy._inst}),t._inst=null,t}(),O=(function(){function t(){this.callback=null,this._itemList=null,this._objectPool=null,this._index=0,this._itemList=[],this._objectPool=[]}n(t,"fairygui.AsyncOperation");var i=t.prototype;return i.createObject=function(t,i){var e=it.getByName(t);if(!e)throw new Error("package not found: "+t);var s=e.getItemByName(i);if(!s)throw new Error("resource not found: "+i);this.internalCreateObject(s)},i.createObjectFromURL=function(t){var i=it.getItemByURL(t);if(!i)throw new Error("resource not found: "+t);this.internalCreateObject(i)},i.cancel=function(){if(e.timer.clear(this,this.run),this._itemList.length=0,this._objectPool.length>0){var t;for(var i in this._objectPool)t=this._objectPool[i],t.dispose();this._objectPool.length=0}},i.internalCreateObject=function(t){this._itemList.length=0,this._objectPool.length=0,this.collectComponentChildren(t),this._itemList.push(new F(t,null)),this._index=0,e.timer.frameLoop(1,this,this.run)},i.collectComponentChildren=function(t){t.owner.getItemAsset(t);for(var i=t.displayList.length,e=0;i>e;e++){var s=t.displayList[e];if(null!=s.packageItem&&4==s.packageItem.type)this.collectComponentChildren(s.packageItem);else if("list"==s.type){var n=null;s.listItemCount=0;for(var r=s.desc.childNodes,h=r.length,a=0;h>a;a++){var o=r[a];if("item"==o.nodeName){var l=o.getAttribute("url");if(l||(null==n&&(n=s.desc.getAttribute("defaultItem")),l=n)){var u=it.getItemByURL(l);u&&(4==u.type&&this.collectComponentChildren(u),this._itemList.push(new F(u,null)),s.listItemCount++)}}}}this._itemList.push(s)}},i.run=function(){for(var t,i,s=0,n=0,r=a.now(),h=J.frameTimeForAsyncUIConstruction,o=this._itemList.length;this._index<o;){if(i=this._itemList[this._index],null!=i.packageItem)t=tt.newObject(i.packageItem),t.packageItem=i.packageItem,this._objectPool.push(t),it._constructing++,4==i.packageItem.type?(s=this._objectPool.length-i.packageItem.displayList.length-1,t.constructFromResource2(this._objectPool,s),this._objectPool.splice(s,i.packageItem.displayList.length)):t.constructFromResource(),it._constructing--;else if(t=tt.newObject2(i.type),this._objectPool.push(t),"list"==i.type&&i.listItemCount>0){for(s=this._objectPool.length-i.listItemCount-1,n=0;n<i.listItemCount;n++)t.itemPool.returnObject(this._objectPool[n+s]);this._objectPool.splice(s,i.listItemCount)}if(this._index++,this._index%5==0&&a.now()-r>=h)return}e.timer.clear(this,this.run);var l=this._objectPool[0];this._itemList.length=0,this._objectPool.length=0,null!=this.callback&&this.callback.runWith(l)},t}(),function(){function t(){}return n(t,"fairygui.AutoSizeType"),t.parse=function(t){switch(t){case"none":return 0;case"both":return 1;case"height":return 2;default:return 0}},t.None=0,t.Both=1,t.Height=2,t}()),P=function(){function t(){}return n(t,"fairygui.ButtonMode"),t.parse=function(t){switch(t){case"Common":return 0;case"Check":return 1;case"Radio":return 2;default:return 0}},t.Common=0,t.Check=1,t.Radio=2,t}(),j=function(){function t(){this.id=null,this.size=0,this.ttf=!1,this.glyphs=null,this.resizable=!1,this.glyphs={}}return n(t,"fairygui.display.BitmapFont",null,"BitmapFont1"),t}(),k=function(){function t(){this.x=0,this.y=0,this.offsetX=0,this.offsetY=0,this.width=0,this.height=0,this.advance=0,this.lineHeight=0,this.channel=0,this.texture=null}return n(t,"fairygui.display.BMGlyph"),t}(),A=function(){function t(){this.rect=null,this.addDelay=0,this.texture=null,this.rect=new y}return n(t,"fairygui.display.Frame"),t}(),T=function(){function t(){this.reachEnding=!1,this.reversed=!1,this.repeatedCount=0,this._curFrame=0,this._lastTime=0,this._curFrameDelay=0}n(t,"fairygui.display.PlayState");var i=t.prototype;return i.update=function(t){var i=e.timer.currTimer,s=i-this._lastTime;this._lastTime=i,this.reachEnding=!1,this._curFrameDelay+=s;var n=t.interval+t.frames[this._curFrame].addDelay+(0==this._curFrame&&this.repeatedCount>0?t.repeatDelay:0);this._curFrameDelay<n||(this._curFrameDelay-=n,this._curFrameDelay>t.interval&&(this._curFrameDelay=t.interval),t.swing?this.reversed?(this._curFrame--,this._curFrame<0&&(this._curFrame=Math.min(1,t.frameCount-1),this.repeatedCount++,this.reversed=!this.reversed)):(this._curFrame++,this._curFrame>t.frameCount-1&&(this._curFrame=Math.max(0,t.frameCount-2),this.repeatedCount++,this.reachEnding=!0,this.reversed=!this.reversed)):(this._curFrame++,this._curFrame>t.frameCount-1&&(this._curFrame=0,this.repeatedCount++,this.reachEnding=!0)))},i.rewind=function(){this._curFrame=0,this._curFrameDelay=0,this.reversed=!1,this.reachEnding=!1},i.reset=function(){this._curFrame=0,this._curFrameDelay=0,this.repeatedCount=0,this.reachEnding=!1,this.reversed=!1},i.copy=function(t){this._curFrame=t._curFrame,this._curFrameDelay=t._curFrameDelay,this.repeatedCount=t.repeatedCount,this.reachEnding=t.reachEnding,this.reversed=t.reversed},r(0,i,"currentFrame",function(){return this._curFrame},function(t){this._curFrame=t,this._curFrameDelay=0}),t}(),F=function(){function t(t,i){this.packageItem=null,this.type=null,this.desc=null,this.listItemCount=0,this.packageItem=t,this.type=i}return n(t,"fairygui.DisplayListItem"),t}(),L=(function(){function t(){this._agent=null,this._sourceData=null,this._agent=new vt,this._agent.draggable=!0,this._agent.touchable=!1,this._agent.setSize(100,100),this._agent.setPivot(.5,.5,!0),this._agent.sortingOrder=1e6,this._agent.on("fui_drag_end",this,this.__dragEnd)}n(t,"fairygui.DragDropManager");var i=t.prototype;return i.startDrag=function(t,i,s,n){if(void 0===n&&(n=-1),null==this._agent.parent){this._sourceData=s,this._agent.url=i,kt.inst.addChild(this._agent);var r=kt.inst.globalToLocal(e.stage.mouseX,e.stage.mouseY);this._agent.setXY(r.x,r.y),this._agent.startDrag(n)}},i.cancel=function(){null!=this._agent.parent&&(this._agent.stopDrag(),kt.inst.removeChild(this._agent),this._sourceData=null)},i.__dragEnd=function(t){if(null!=this._agent.parent){kt.inst.removeChild(this._agent);var i=this._sourceData;this._sourceData=null;for(var e=M.cast(t.target);null!=e;){if(e.displayObject.hasListener("fui_drop"))return e.requestFocus(),void e.displayObject.event("fui_drop",[i,L.createEvent("fui_drop",e.displayObject,t)]);e=e.parent}}},r(0,i,"dragAgent",function(){return this._agent}),r(0,i,"dragging",function(){return null!=this._agent.parent}),r(1,t,"inst",function(){return null==fairygui.DragDropManager._inst&&(fairygui.DragDropManager._inst=new t),fairygui.DragDropManager._inst}),t._inst=null,t}(),function(){function t(){}return n(t,"fairygui.Events"),t.createEvent=function(t,i,e){return fairygui.Events.$event.setTo(t,i,e?e.target:i),e&&(fairygui.Events.$event.touchId=e.touchId),fairygui.Events.$event._stoped=!1,fairygui.Events.$event},t.dispatch=function(t,i,e){i.event(t,fairygui.Events.createEvent(t,i,e))},t.STATE_CHANGED="fui_state_changed",t.XY_CHANGED="fui_xy_changed",t.SIZE_CHANGED="fui_size_changed",t.SIZE_DELAY_CHANGE="fui_size_delay_change",t.CLICK_ITEM="fui_click_item",t.SCROLL="fui_scroll",t.SCROLL_END="fui_scroll_end",t.DROP="fui_drop",t.FOCUS_CHANGED="fui_focus_changed",t.DRAG_START="fui_drag_start",t.DRAG_MOVE="fui_drag_move",t.DRAG_END="fui_drag_end",t.PULL_DOWN_RELEASE="fui_pull_down_release",t.PULL_UP_RELEASE="fui_pull_up_release",s(t,["$event",function(){return this.$event=new _}]),t}()),B=function(){function t(){}return n(t,"fairygui.FlipType"),t.parse=function(t){switch(t){case"hz":return 1;case"vt":return 2;case"both":return 3;default:return 0}},t.None=0,t.Horizontal=1,t.Vertical=2,t.Both=3,t}(),M=function(){function t(){this.data=null,this.packageItem=null,this._x=0,this._y=0,this._width=0,this._height=0,this._alpha=1,this._rotation=0,this._visible=!0,this._touchable=!0,this._grayed=!1,this._draggable=!1,this._scaleX=1,this._scaleY=1,this._skewX=0,this._skewY=0,this._pivotX=0,this._pivotY=0,this._pivotAsAnchor=!1,this._pivotOffsetX=0,this._pivotOffsetY=0,this._sortingOrder=0,this._internalVisible=1,this._focusable=!1,this._tooltips=null,this._pixelSnapping=!1,this._relations=null,this._group=null,this._gears=null,this._dragBounds=null,this._displayObject=null,this._yOffset=0,this._sizeImplType=0,this._parent=null,this._rawWidth=0,this._rawHeight=0,this._sourceWidth=0,this._sourceHeight=0,this._initWidth=0,this._initHeight=0,this._id=null,this._name=null,this._underConstruct=!1,this._gearLocked=!1,this._touchDownPoint=null,this._id=""+fairygui.GObject._gInstanceCounter++,this._name="",this.createDisplayObject(),this._relations=new q(this),this._gears=h(8,null)}n(t,"fairygui.GObject");var i=t.prototype;return i.setXY=function(i,e){if(this._x!=i||this._y!=e){var s=i-this._x,n=e-this._y;this._x=i,this._y=e,this.handleXYChanged(),this instanceof fairygui.GGroup&&this.moveChildren(s,n),this.updateGear(1),!this._parent||this._parent instanceof fairygui.GList||(this._parent.setBoundsChangedFlag(),this.displayObject.event("fui_xy_changed")),t.draggingObject!=this||t.sUpdateInDragging||this.localToGlobalRect(0,0,this.width,this.height,t.sGlobalRect)}},i.center=function(t){void 0===t&&(t=!1);var i;i=null!=this._parent?this.parent:this.root,this.setXY((i.width-this.width)/2,(i.height-this.height)/2),t&&(this.addRelation(i,3),this.addRelation(i,10))},i.setSize=function(t,i,e){if(void 0===e&&(e=!1),this._rawWidth!=t||this._rawHeight!=i){this._rawWidth=t,this._rawHeight=i,0>t&&(t=0),0>i&&(i=0);var s=t-this._width,n=i-this._height;this._width=t,this._height=i,this.handleSizeChanged(),0==this._pivotX&&0==this._pivotY||(this._pivotAsAnchor?this.applyPivot():(e||this.setXY(this.x-this._pivotX*s,this.y-this._pivotY*n),this.updatePivotOffset())),this.updateGear(2),this._parent&&(this._relations.onOwnerSizeChanged(s,n),this._parent.setBoundsChangedFlag()),this.displayObject.event("fui_size_changed")}},i.ensureSizeCorrect=function(){},i.setScale=function(t,i){this._scaleX==t&&this._scaleY==i||(this._scaleX=t,this._scaleY=i,this.handleScaleChanged(),this.applyPivot(),this.updateGear(2))},i.setSkew=function(t,i){this._skewX==t&&this._skewY==i||(this._skewX=t,this._skewY=i,null!=this._displayObject&&(this._displayObject.skew(t,i),this.applyPivot()))},i.setPivot=function(t,i,e){void 0===i&&(i=0),void 0===e&&(e=!1),this._pivotX==t&&this._pivotY==i&&this._pivotAsAnchor==e||(this._pivotX=t,this._pivotY=i,this._pivotAsAnchor=e,this.updatePivotOffset(),this.handleXYChanged())},i.internalSetPivot=function(t,i,e){this._pivotX=t,this._pivotY=i,this._pivotAsAnchor=e,this._pivotAsAnchor&&this.handleXYChanged()},i.updatePivotOffset=function(){if(null!=this._displayObject)if(!this._displayObject.transform||0==this._pivotX&&0==this._pivotY)this._pivotOffsetX=0,this._pivotOffsetY=0;else{0==this._sizeImplType?(fairygui.GObject.sHelperPoint.x=this._pivotX*this._width,fairygui.GObject.sHelperPoint.y=this._pivotY*this._height):(fairygui.GObject.sHelperPoint.x=this._pivotX*this._sourceWidth,fairygui.GObject.sHelperPoint.y=this._pivotY*this._sourceHeight);var t=this._displayObject.transform.transformPoint(fairygui.GObject.sHelperPoint);this._pivotOffsetX=this._pivotX*this._width-t.x,this._pivotOffsetY=this._pivotY*this._height-t.y}},i.applyPivot=function(){0==this._pivotX&&0==this._pivotY||(this.updatePivotOffset(),this.handleXYChanged())},i.updateAlpha=function(){this._displayObject&&(this._displayObject.alpha=this._alpha),this.updateGear(3)},i.requestFocus=function(){for(var t=this;t&&!t._focusable;)t=t.parent;null!=t&&(this.root.focus=t)},i.getGear=function(t){var i=this._gears[t];if(null==i){switch(t){case 0:i=new ut(this);break;case 1:i=new yt(this);break;case 2:i=new pt(this);break;case 3:i=new dt(this);break;case 4:i=new lt(this);break;case 5:i=new ot(this);break;case 6:i=new mt(this);break;case 7:i=new _t(this);break;default:throw new Error("FairyGUI: invalid gear index!")}this._gears[t]=i}return i},i.updateGear=function(t){null!=this._gears[t]&&this._gears[t].updateState()},i.updateGearFromRelations=function(t,i,e){null!=this._gears[t]&&this._gears[t].updateFromRelations(i,e)},i.addRelation=function(t,i,e){void 0===e&&(e=!1),this._relations.add(t,i,e)},i.removeRelation=function(t,i){void 0===i&&(i=0),this._relations.remove(t,i)},i.removeFromParent=function(){this._parent&&this._parent.removeChild(this)},i.dispose=function(){this.removeFromParent(),this._relations.dispose()},i.onClick=function(t,i,e){this.on("click",t,i,e)},i.offClick=function(t,i){this.off("click",t,i)},i.hasClickListener=function(){return this._displayObject.hasListener("click")},i.on=function(t,i,e,s){this._displayObject.on(t,i,e,s)},i.off=function(t,i,e){this._displayObject.off(t,i,e)},i.startDrag=function(t){void 0===t&&(t=-1),null!=this._displayObject.stage&&this.dragBegin()},i.stopDrag=function(){this.dragEnd()},i.localToGlobal=function(t,i,e){return void 0===t&&(t=0),void 0===i&&(i=0),this._pivotAsAnchor&&(t+=this._pivotX*this._width,i+=this._pivotY*this._height),e?(e.x=t,e.y=i,this._displayObject.localToGlobal(e,!1)):(e=fairygui.GObject.sHelperPoint,e.x=t,e.y=i,this._displayObject.localToGlobal(e,!0))},i.globalToLocal=function(t,i,e){return void 0===t&&(t=0),void 0===i&&(i=0),e?(e.x=t,e.y=i,this._displayObject.globalToLocal(e,!1)):(e=fairygui.GObject.sHelperPoint,e.x=t,e.y=i,e=this._displayObject.globalToLocal(e,!0)),this._pivotAsAnchor&&(e.x-=this._pivotX*this._width,e.y-=this._pivotY*this._height),e},i.localToGlobalRect=function(t,i,e,s,n){void 0===t&&(t=0),void 0===i&&(i=0),void 0===e&&(e=0),void 0===s&&(s=0),null==n&&(n=new y);var r=this.localToGlobal(t,i);return n.x=r.x,n.y=r.y,r=this.localToGlobal(t+e,i+s),n.width=r.x-n.x,n.height=r.y-n.y,n},i.globalToLocalRect=function(t,i,e,s,n){void 0===t&&(t=0),void 0===i&&(i=0),void 0===e&&(e=0),void 0===s&&(s=0),null==n&&(n=new y);var r=this.globalToLocal(t,i);return n.x=r.x,n.y=r.y,r=this.globalToLocal(t+e,i+s),n.width=r.x-n.x,n.height=r.y-n.y,n},i.handleControllerChanged=function(t){for(var i=0;8>i;i++){var e=this._gears[i];null!=e&&e.controller==t&&e.apply()}},i.createDisplayObject=function(){this._displayObject=new b,this._displayObject.$owner=this},i.handleXYChanged=function(){var t=this._x,i=this._y+this._yOffset;this._pivotAsAnchor&&(t-=this._pivotX*this._width,i-=this._pivotY*this._height),this._pixelSnapping&&(t=Math.round(t),i=Math.round(i)),this._displayObject.pos(t+this._pivotOffsetX,i+this._pivotOffsetY)},i.handleSizeChanged=function(){null!=this._displayObject&&(0==this._sizeImplType||0==this._sourceWidth||0==this._sourceHeight?this._displayObject.size(this._width,this._height):this._displayObject.scale(this._width/this._sourceWidth*this._scaleX,this._height/this._sourceHeight*this._scaleY))},i.handleScaleChanged=function(){null!=this._displayObject&&(0==this._sizeImplType||0==this._sourceWidth||0==this._sourceHeight?this._displayObject.scale(this._scaleX,this._scaleY):this._displayObject.scale(this._width/this._sourceWidth*this._scaleX,this._height/this._sourceHeight*this._scaleY))},i.handleGrayedChanged=function(){this._displayObject&&(this._grayed?this._displayObject.filters=[l.GRAY]:this._displayObject.filters=null)},i.constructFromResource=function(){},i.setup_beforeAdd=function(t){var i,e;if(this._id=t.getAttribute("id"),this._name=t.getAttribute("name"),i=t.getAttribute("xy"),e=i.split(","),this.setXY(parseInt(e[0]),parseInt(e[1])),i=t.getAttribute("size"),i&&(e=i.split(","),this._initWidth=parseInt(e[0]),this._initHeight=parseInt(e[1]),this.setSize(this._initWidth,this._initHeight,!0)),i=t.getAttribute("scale"),i&&(e=i.split(","),this.setScale(parseFloat(e[0]),parseFloat(e[1]))),i=t.getAttribute("skew"),i&&(e=i.split(","),this.setSkew(parseFloat(e[0]),parseFloat(e[1]))),i=t.getAttribute("rotation"),i&&(this.rotation=parseInt(i)),i=t.getAttribute("pivot"),i?(e=i.split(","),i=t.getAttribute("anchor"),this.setPivot(parseFloat(e[0]),parseFloat(e[1]),"true"==i)):this.setPivot(0,0,!1),i=t.getAttribute("alpha"),i&&(this.alpha=parseFloat(i)),"false"==t.getAttribute("touchable")&&(this.touchable=!1),"false"==t.getAttribute("visible")&&(this.visible=!1),"true"==t.getAttribute("grayed")&&(this.grayed=!0),this.tooltips=t.getAttribute("tooltips"),i=t.getAttribute("blend"),i&&(this.blendMode=i),i=t.getAttribute("filter"))switch(i){case"color":i=t.getAttribute("filterData"),e=i.split(",");var s=new nt;s.adjustBrightness(parseFloat(e[0])),s.adjustContrast(parseFloat(e[1])),s.adjustSaturation(parseFloat(e[2])),s.adjustHue(parseFloat(e[3]));var n=new l(s);this.filters=[n]}},i.setup_afterAdd=function(t){var i=t.getAttribute("group");i&&(this._group=this._parent.getChildById(i));for(var e=t.childNodes,s=e.length,n=0;s>n;n++){var r=e[n];if(1==r.nodeType){var h=fairygui.GObject.GearXMLKeys[r.nodeName];void 0!=h&&this.getGear(h).setup(r)}}},i.initDrag=function(){this._draggable?this.on("mousedown",this,this.__begin):this.off("mousedown",this,this.__begin)},i.dragBegin=function(){null!=fairygui.GObject.draggingObject&&fairygui.GObject.draggingObject.stopDrag(),fairygui.GObject.sGlobalDragStart.x=e.stage.mouseX,fairygui.GObject.sGlobalDragStart.y=e.stage.mouseY,this.localToGlobalRect(0,0,this.width,this.height,fairygui.GObject.sGlobalRect),fairygui.GObject.draggingObject=this,e.stage.on("mousemove",this,this.__moving2),e.stage.on("mouseup",this,this.__end2)},i.dragEnd=function(){fairygui.GObject.draggingObject==this&&(e.stage.off("mousemove",this,this.__moving2),e.stage.off("mouseup",this,this.__end2),fairygui.GObject.draggingObject=null),fairygui.GObject.sDraggingQuery=!1},i.reset=function(){e.stage.off("mousemove",this,this.__moving),e.stage.off("mouseup",this,this.__end)},i.__begin=function(){null==this._touchDownPoint&&(this._touchDownPoint=new m),this._touchDownPoint.x=e.stage.mouseX,this._touchDownPoint.y=e.stage.mouseY,e.stage.on("mousemove",this,this.__moving),e.stage.on("mouseup",this,this.__end)},i.__end=function(){this.reset()},i.__moving=function(t){var i=J.touchDragSensitivity;null!=this._touchDownPoint&&Math.abs(this._touchDownPoint.x-e.stage.mouseX)<i&&Math.abs(this._touchDownPoint.y-e.stage.mouseY)<i||(this.reset(),fairygui.GObject.sDraggingQuery=!0,L.dispatch("fui_drag_start",this._displayObject,t),fairygui.GObject.sDraggingQuery&&this.dragBegin())},i.__moving2=function(i){var s=e.stage.mouseX-fairygui.GObject.sGlobalDragStart.x+fairygui.GObject.sGlobalRect.x,n=e.stage.mouseY-fairygui.GObject.sGlobalDragStart.y+fairygui.GObject.sGlobalRect.y;if(null!=this._dragBounds){var r=kt.inst.localToGlobalRect(this._dragBounds.x,this._dragBounds.y,this._dragBounds.width,this._dragBounds.height,fairygui.GObject.sDragHelperRect);s<r.x?s=r.x:s+fairygui.GObject.sGlobalRect.width>r.right&&(s=r.right-fairygui.GObject.sGlobalRect.width,s<r.x&&(s=r.x)),n<r.y?n=r.y:n+fairygui.GObject.sGlobalRect.height>r.bottom&&(n=r.bottom-fairygui.GObject.sGlobalRect.height,n<r.y&&(n=r.y))}t.sUpdateInDragging=!0;var h=this.parent.globalToLocal(s,n,fairygui.GObject.sHelperPoint);this.setXY(Math.round(h.x),Math.round(h.y)),t.sUpdateInDragging=!1,L.dispatch("fui_drag_move",this._displayObject,i)},i.__end2=function(t){fairygui.GObject.draggingObject==this&&(this.stopDrag(),L.dispatch("fui_drag_end",this._displayObject,t))},r(0,i,"id",function(){return this._id}),r(0,i,"name",function(){return this._name},function(t){this._name=t}),r(0,i,"rotation",function(){return this._rotation},function(t){this._rotation!=t&&(this._rotation=t,null!=this._displayObject&&(this._displayObject.rotation=this.normalizeRotation,this.applyPivot()),this.updateGear(3))}),r(0,i,"width",function(){return this.ensureSizeCorrect(),this._relations.sizeDirty&&this._relations.ensureRelationsSizeCorrect(),this._width},function(t){this.setSize(t,this._rawHeight)}),r(0,i,"x",function(){return this._x},function(t){this.setXY(t,this._y)}),r(0,i,"draggable",function(){return this._draggable},function(t){this._draggable!=t&&(this._draggable=t,this.initDrag())}),r(0,i,"y",function(){return this._y},function(t){this.setXY(this._x,t)}),r(0,i,"sourceWidth",function(){return this._sourceWidth}),r(0,i,"sourceHeight",function(){return this._sourceHeight}),r(0,i,"pixelSnapping",function(){return this._pixelSnapping},function(t){this._pixelSnapping!=t&&(this._pixelSnapping=t,this.handleXYChanged())}),r(0,i,"height",function(){return this.ensureSizeCorrect(),this._relations.sizeDirty&&this._relations.ensureRelationsSizeCorrect(),this._height},function(t){this.setSize(this._rawWidth,t)}),r(0,i,"initHeight",function(){return this._initHeight}),r(0,i,"initWidth",function(){return this._initWidth}),r(0,i,"asButton",function(){return this}),r(0,i,"actualWidth",function(){return this.width*Math.abs(this._scaleX)}),r(0,i,"actualHeight",function(){return this.height*Math.abs(this._scaleY)}),r(0,i,"blendMode",function(){return this._displayObject.blendMode},function(t){this._displayObject.blendMode=t}),r(0,i,"scaleX",function(){return this._scaleX},function(t){this.setScale(t,this._scaleY)}),r(0,i,"scaleY",function(){return this._scaleY},function(t){this.setScale(this._scaleX,t)}),r(0,i,"skewX",function(){return this._skewX},function(t){this.setScale(t,this._skewY)}),r(0,i,"skewY",function(){return this._skewY},function(t){this.setSkew(this._skewX,t)}),r(0,i,"pivotX",function(){return this._pivotX},function(t){this.setPivot(t,this._pivotY)}),r(0,i,"asTextInput",function(){return this}),r(0,i,"asLoader",function(){return this}),r(0,i,"pivotY",function(){return this._pivotY},function(t){this.setPivot(this._pivotX,t)}),r(0,i,"displayObject",function(){return this._displayObject}),r(0,i,"normalizeRotation",function(){var t=this._rotation%360;return t>180?t-=360:-180>t&&(t=360+t),t}),r(0,i,"touchable",function(){return this._touchable},function(t){this._touchable=t,this instanceof fairygui.GImage||this instanceof fairygui.GMovieClip||!(!(this instanceof fairygui.GTextField)||this instanceof fairygui.GTextInput||this instanceof fairygui.GRichTextField)||null!=this._displayObject&&(this._displayObject.mouseEnabled=this._touchable)}),r(0,i,"alpha",function(){return this._alpha},function(t){this._alpha!=t&&(this._alpha=t,this.updateAlpha())}),r(0,i,"grayed",function(){return this._grayed},function(t){this._grayed!=t&&(this._grayed=t,this.handleGrayedChanged(),this.updateGear(3))}),r(0,i,"dragBounds",function(){return this._dragBounds},function(t){this._dragBounds=t}),r(0,i,"asProgress",function(){return this}),r(0,i,"enabled",function(){return!this._grayed&&this._touchable},function(t){this.grayed=!t,this.touchable=t}),r(0,i,"sortingOrder",function(){return this._sortingOrder},function(t){if(0>t&&(t=0),this._sortingOrder!=t){var i=this._sortingOrder;this._sortingOrder=t,null!=this._parent&&this._parent.childSortingOrderChanged(this,i,this._sortingOrder)}}),r(0,i,"visible",function(){return this._visible},function(t){this._visible!=t&&(this._visible=t,this._displayObject&&(this._displayObject.visible=this._visible),this._parent&&(this._parent.childStateChanged(this),this._parent.setBoundsChangedFlag()))}),r(0,i,"internalVisible",function(){return this._internalVisible},function(t){0>t&&(t=0);var i=this._internalVisible>0,e=t>0;this._internalVisible=t,i!=e&&this._parent&&this._parent.childStateChanged(this)}),r(0,i,"finalVisible",function(){return this._visible&&this._internalVisible>0&&(!this._group||this._group.finalVisible)}),r(0,i,"asGraph",function(){return this}),r(0,i,"gearSize",function(){return this.getGear(2)}),r(0,i,"focusable",function(){return this._focusable},function(t){this._focusable=t}),r(0,i,"focused",function(){return this.root.focus==this}),r(0,i,"tooltips",function(){return this._tooltips},function(t){this._tooltips=t}),r(0,i,"dragging",function(){return fairygui.GObject.draggingObject==this}),r(0,i,"group",function(){return this._group},function(t){this._group=t}),r(0,i,"filters",function(){return this._displayObject.filters},function(t){this._displayObject.filters=t}),r(0,i,"inContainer",function(){return null!=this._displayObject&&null!=this._displayObject.parent}),r(0,i,"resourceURL",function(){return null!=this.packageItem?"ui://"+this.packageItem.owner.id+this.packageItem.id:null}),r(0,i,"onStage",function(){return null!=this._displayObject&&null!=this._displayObject.stage}),r(0,i,"gearXY",function(){return this.getGear(1)}),r(0,i,"root",function(){if(this instanceof fairygui.GRoot)return this;for(var t=this._parent;t;){if(t instanceof fairygui.GRoot)return t;t=t.parent}return kt.inst}),r(0,i,"gearLook",function(){return this.getGear(3)}),r(0,i,"asCom",function(){return this}),r(0,i,"relations",function(){return this._relations}),r(0,i,"parent",function(){return this._parent},function(t){this._parent=t}),r(0,i,"asLabel",function(){return this}),r(0,i,"asTextField",function(){return this}),r(0,i,"asImage",function(){return this}),r(0,i,"asGroup",function(){return this}),r(0,i,"asRichTextField",function(){return this}),r(0,i,"asList",function(){return this}),r(0,i,"asSlider",function(){return this}),r(0,i,"asComboBox",function(){return this}),r(0,i,"asMovieClip",function(){return this}),r(0,i,"text",function(){return null},function(t){}),r(0,i,"icon",function(){return null},function(t){}),t.cast=function(t){return t.$owner},t.draggingObject=null,t._gInstanceCounter=0,t.sDraggingQuery=!1,t.sUpdateInDragging=!1,s(t,["GearXMLKeys",function(){return this.GearXMLKeys={gearDisplay:0,gearXY:1,gearSize:2,gearLook:3,gearColor:4,gearAni:5,gearText:6,gearIcon:7}},"sGlobalDragStart",function(){return this.sGlobalDragStart=new m},"sGlobalRect",function(){return this.sGlobalRect=new y},"sHelperPoint",function(){return this.sHelperPoint=new m},"sDragHelperRect",function(){return this.sDragHelperRect=new y}]),t}(),H=function(){function t(t){this._tween=!1,this._easeType=null,this._tweenTime=.3,this._delay=0,this._owner=null,this._controller=null,this._owner=t,this._easeType=u.quadOut}n(t,"fairygui.GearBase");var i=t.prototype;return i.setup=function(t){if(this._controller=this._owner.parent.getController(t.getAttribute("controller")),null!=this._controller){this.init();var i;if(i=t.getAttribute("tween"),i&&(this._tween=!0),i=t.getAttribute("ease"),i&&(this._easeType=et.parseEaseType(i)),i=t.getAttribute("duration"),i&&(this._tweenTime=parseFloat(i)),i=t.getAttribute("delay"),i&&(this._delay=parseFloat(i)),this instanceof fairygui.GearDisplay){if(i=t.getAttribute("pages")){var e=i.split(",");this.pages=e}}else{var s,n;if(i=t.getAttribute("pages"),i&&(s=i.split(",")),i=t.getAttribute("values"),i&&(n=i.split("|")),s&&n)for(var r=0;r<n.length;r++)this.addStatus(s[r],n[r]);i=t.getAttribute("default"),i&&this.addStatus(null,i)}}},i.updateFromRelations=function(t,i){},i.addStatus=function(t,i){},i.init=function(){},i.apply=function(){},i.updateState=function(){},r(0,i,"controller",function(){return this._controller},function(t){t!=this._controller&&(this._controller=t,this._controller&&this.init())}),r(0,i,"tween",function(){return this._tween},function(t){this._tween=t}),r(0,i,"delay",function(){return this._delay},function(t){this._delay=t}),r(0,i,"tweenTime",function(){return this._tweenTime},function(t){this._tweenTime=t}),r(0,i,"easeType",function(){return this._easeType},function(t){this._easeType=t}),t.disableAllTweenEffect=!1,t}(),N=function(){function t(){this._pool=null,this._count=0,this._pool={}}n(t,"fairygui.GObjectPool");var i=t.prototype;return i.clear=function(){for(var t=this._pool.length,i=0;t>i;i++)for(var e=this._pool[i],s=e.length,n=0;s>n;n++)e[n].dispose();this._pool={},this._count=0},i.getObject=function(t){var i=this._pool[t];if(null==i&&(i=[],this._pool[t]=i),i.length)return this._count--,i.shift();var e=it.createObjectFromURL(t);return e},i.returnObject=function(t){var i=t.resourceURL;if(i){var e=this._pool[i];null==e&&(e=[],this._pool[i]=e),this._count++,e.push(t)}},r(0,i,"count",function(){return this._count}),t}(),G=function(){function t(){}return n(t,"fairygui.ListLayoutType"),t.parse=function(t){switch(t){case"column":return 0;case"row":return 1;case"flow_hz":return 2;case"flow_vt":return 3;case"pagination":return 4;default:return 0}},t.SingleColumn=0,t.SingleRow=1,t.FlowHorizontal=2,t.FlowVertical=3,t.Pagination=4,t}(),W=function(){function t(){}return n(t,"fairygui.ListSelectionMode"),t.parse=function(t){switch(t){case"single":return 0;case"multiple":return 1;case"multipleSingleClick":return 2;case"none":return 3;default:return 0}},t.Single=0,t.Multiple=1,t.Multiple_SingleClick=2,t.None=3,t}(),z=function(){function t(){}return n(t,"fairygui.LoaderFillType"),t.parse=function(t){switch(t){case"none":return 0;case"scale":return 1;case"scaleMatchHeight":return 2;case"scaleMatchWidth":return 3;case"scaleFree":return 4;default:return 0}},t.None=0,t.Scale=1,t.ScaleMatchHeight=2,t.ScaleMatchWidth=3,t.ScaleFree=4,t}(),R=function(){function t(){this.left=0,this.right=0,this.top=0,this.bottom=0}n(t,"fairygui.Margin");var i=t.prototype;return i.parse=function(t){if(!t)return this.left=0,this.right=0,this.top=0,void(this.bottom=0);var i=t.split(",");if(1==i.length){var e=parseInt(i[0]);this.top=e,this.bottom=e,this.left=e,this.right=e}else this.top=parseInt(i[0]),this.bottom=parseInt(i[1]),this.left=parseInt(i[2]),this.right=parseInt(i[3])},i.copy=function(t){this.top=t.top,this.bottom=t.bottom,this.left=t.left,this.right=t.right},t}(),V=function(){function t(){}return n(t,"fairygui.OverflowType"),t.parse=function(t){switch(t){case"visible":return 0;case"hidden":return 1;case"scroll":return 2;case"scale":return 3;case"scaleFree":return 4;default:return 0}},t.Visible=0,t.Hidden=1,t.Scroll=2,t.Scale=3,t.ScaleFree=4,t}(),E=function(){function t(){this.owner=null,this.type=0,this.id=null,this.name=null,this.width=0,this.height=0,this.file=null,this.decoded=!1,this.scale9Grid=null,this.scaleByTile=!1,this.tileGridIndice=0,this.smoothing=!1,this.texture=null,this.interval=0,this.repeatDelay=0,this.swing=!1,this.frames=null,this.componentData=null,this.displayList=null,this.sound=null,this.bitmapFont=null}n(t,"fairygui.PackageItem");var i=t.prototype;return i.load=function(){return this.owner.getItemAsset(this)},i.toString=function(){return this.name},t}(),D=function(){function t(){}return n(t,"fairygui.PackageItemType"),t.parse=function(t){switch(t){case"image":return 0;case"movieclip":return 2;case"sound":return 3;case"component":return 4;case"swf":return 1;case"font":return 6;case"atlas":return 7}return 0},t.Image=0,t.Swf=1,t.MovieClip=2,t.Sound=3,t.Component=4,t.Misc=5,t.Font=6,t.Atlas=7,t}(),X=function(){function t(){this._controller=null,this._id=null}n(t,"fairygui.PageOption");var i=t.prototype;return i.clear=function(){this._id=null},r(0,i,"controller",null,function(t){this._controller=t}),r(0,i,"index",function(){return this._id?this._controller.getPageIndexById(this._id):-1},function(t){this._id=this._controller.getPageId(t)}),r(0,i,"name",function(){return this._id?this._controller.getPageNameById(this._id):null},function(t){this._id=this._controller.getPageIdByName(t)}),r(0,i,"id",function(){return this._id},function(t){this._id=t}),t}(),Y=(function(){function t(t){if(this._contentPane=null,this._list=null,
!t&&(t=J.popupMenu,!t))throw"UIConfig.popupMenu not defined";this._contentPane=it.createObjectFromURL(t).asCom,this._contentPane.on("display",this,this.__addedToStage),this._list=this._contentPane.getChild("list"),this._list.removeChildrenToPool(),this._list.addRelation(this._contentPane,14),this._list.removeRelation(this._contentPane,15),this._contentPane.addRelation(this._list,15),this._list.on("fui_click_item",this,this.__clickItem)}n(t,"fairygui.PopupMenu");var i=t.prototype;return i.dispose=function(){this._contentPane.dispose()},i.addItem=function(t,i){var e=this._list.addItemFromPool().asButton;e.title=t,e.data=i,e.grayed=!1;var s=e.getController("checked");return null!=s&&(s.selectedIndex=0),e},i.addItemAt=function(t,i,e){var s=this._list.getFromPool().asButton;this._list.addChildAt(s,i),s.title=t,s.data=e,s.grayed=!1;var n=s.getController("checked");return null!=n&&(n.selectedIndex=0),s},i.addSeperator=function(){if(null==J.popupMenu_seperator)throw"UIConfig.popupMenu_seperator not defined";this.list.addItemFromPool(J.popupMenu_seperator)},i.getItemName=function(t){var i=this._list.getChildAt(t);return i.name},i.setItemText=function(t,i){var e=this._list.getChild(t).asButton;e.title=i},i.setItemVisible=function(t,i){var e=this._list.getChild(t).asButton;e.visible!=i&&(e.visible=i,this._list.setBoundsChangedFlag())},i.setItemGrayed=function(t,i){var e=this._list.getChild(t).asButton;e.grayed=i},i.setItemCheckable=function(t,i){var e=this._list.getChild(t).asButton,s=e.getController("checked");null!=s&&(i?0==s.selectedIndex&&(s.selectedIndex=1):s.selectedIndex=0)},i.setItemChecked=function(t,i){var e=this._list.getChild(t).asButton,s=e.getController("checked");null!=s&&(s.selectedIndex=i?2:1)},i.isItemChecked=function(t){var i=this._list.getChild(t).asButton,e=i.getController("checked");return null!=e?2==e.selectedIndex:!1},i.removeItem=function(t){var i=this._list.getChild(t);if(null!=i){var e=this._list.getChildIndex(i);return this._list.removeChildToPoolAt(e),!0}return!1},i.clearItems=function(){this._list.removeChildrenToPool()},i.show=function(t,i){var e=null!=t?t.root:kt.inst;e.showPopup(this.contentPane,t instanceof fairygui.GRoot?null:t,i)},i.__clickItem=function(t){e.timer.once(100,this,this.__clickItem2,[t])},i.__clickItem2=function(t){var i=t.asButton;if(null!=i){if(i.grayed)return void(this._list.selectedIndex=-1);var e=i.getController("checked");null!=e&&0!=e.selectedIndex&&(1==e.selectedIndex?e.selectedIndex=2:e.selectedIndex=1);var s=this._contentPane.parent;s.hidePopup(this.contentPane),null!=i.data&&i.data.run()}},i.__addedToStage=function(){this._list.selectedIndex=-1,this._list.resizeToFit(1e5,10)},r(0,i,"itemCount",function(){return this._list.numChildren}),r(0,i,"contentPane",function(){return this._contentPane}),r(0,i,"list",function(){return this._list}),t}(),function(){function t(){}return n(t,"fairygui.ProgressTitleType"),t.parse=function(t){switch(t){case"percent":return 0;case"valueAndmax":return 1;case"value":return 2;case"max":return 3;default:return 0}},t.Percent=0,t.ValueAndMax=1,t.Value=2,t.Max=3,t}()),U=function(){function t(t){this._owner=null,this._target=null,this._defs=null,this._targetX=NaN,this._targetY=NaN,this._targetWidth=NaN,this._targetHeight=NaN,this._owner=t,this._defs=[]}var i;n(t,"fairygui.RelationItem");var e=t.prototype;return e.add=function(t,i){if(24==t)return this.add(14,i),void this.add(15,i);for(var e=this._defs.length,s=0;e>s;s++){var n=this._defs[s];if(n.type==t)return}this.internalAdd(t,i)},e.internalAdd=function(t,e){if(24==t)return this.internalAdd(14,e),void this.internalAdd(15,e);var s=new i;s.percent=e,s.type=t,this._defs.push(s),(e||1==t||3==t||5==t||8==t||10==t||12==t)&&(this._owner.pixelSnapping=!0)},e.remove=function(t){if(void 0===t&&(t=0),24==t)return this.remove(14),void this.remove(15);for(var i=this._defs.length,e=0;i>e;e++)if(this._defs[e].type==t){this._defs.splice(e,1);break}},e.copyFrom=function(t){this.target=t.target,this._defs.length=0;for(var e=t._defs.length,s=0;e>s;s++){var n=t._defs[s],r=new i;r.copyFrom(n),this._defs.push(r)}},e.dispose=function(){null!=this._target&&(this.releaseRefTarget(this._target),this._target=null)},e.applyOnSelfResized=function(t,i){for(var e=this._owner.x,s=this._owner.y,n=this._defs.length,r=0;n>r;r++){var h=this._defs[r];switch(h.type){case 3:case 5:this._owner.x-=t/2;break;case 4:case 6:this._owner.x-=t;break;case 10:case 12:this._owner.y-=i/2;break;case 11:case 13:this._owner.y-=i}}if((e!=this._owner.x||s!=this._owner.y)&&(e=this._owner.x-e,s=this._owner.y-s,this._owner.updateGearFromRelations(1,e,s),null!=this._owner.parent)){var a=this._owner.parent._transitions.length;if(a>0)for(r=0;a>r;++r)this._owner.parent._transitions[r].updateFromRelations(this._owner.id,e,s)}},e.applyOnXYChanged=function(t,i,e){var s=NaN;switch(t.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:this._owner.x+=i;break;case 7:case 8:case 9:case 10:case 11:case 12:case 13:this._owner.y+=e;break;case 14:case 15:break;case 16:case 17:s=this._owner.x,this._owner.x+=i,this._owner.width=this._owner._rawWidth-(this._owner.x-s);break;case 18:case 19:this._owner.width=this._owner._rawWidth+i;break;case 20:case 21:s=this._owner.y,this._owner.y+=e,this._owner.height=this._owner._rawHeight-(this._owner.y-s);break;case 22:case 23:this._owner.height=this._owner._rawHeight+e}},e.applyOnSizeChanged=function(t){var i=NaN,e=NaN;this._target!=this._owner.parent?(i=this._target.x,e=this._target.y):(i=0,e=0);var s=NaN,n=NaN;switch(t.type){case 0:break;case 1:s=this._owner.x-(i+this._targetWidth/2),t.percent&&(s=s/this._targetWidth*this._target._rawWidth),this._owner.x=i+this._target._rawWidth/2+s;break;case 2:s=this._owner.x-(i+this._targetWidth),t.percent&&(s=s/this._targetWidth*this._target._rawWidth),this._owner.x=i+this._target._rawWidth+s;break;case 3:s=this._owner.x+this._owner._rawWidth/2-(i+this._targetWidth/2),t.percent&&(s=s/this._targetWidth*this._target._rawWidth),this._owner.x=i+this._target._rawWidth/2+s-this._owner._rawWidth/2;break;case 4:s=this._owner.x+this._owner._rawWidth-i,t.percent&&(s=s/this._targetWidth*this._target._rawWidth),this._owner.x=i+s-this._owner._rawWidth;break;case 5:s=this._owner.x+this._owner._rawWidth-(i+this._targetWidth/2),t.percent&&(s=s/this._targetWidth*this._target._rawWidth),this._owner.x=i+this._target._rawWidth/2+s-this._owner._rawWidth;break;case 6:s=this._owner.x+this._owner._rawWidth-(i+this._targetWidth),t.percent&&(s=s/this._targetWidth*this._target._rawWidth),this._owner.x=i+this._target._rawWidth+s-this._owner._rawWidth;break;case 7:break;case 8:s=this._owner.y-(e+this._targetHeight/2),t.percent&&(s=s/this._targetHeight*this._target._rawHeight),this._owner.y=e+this._target._rawHeight/2+s;break;case 9:s=this._owner.y-(e+this._targetHeight),t.percent&&(s=s/this._targetHeight*this._target._rawHeight),this._owner.y=e+this._target._rawHeight+s;break;case 10:s=this._owner.y+this._owner._rawHeight/2-(e+this._targetHeight/2),t.percent&&(s=s/this._targetHeight*this._target._rawHeight),this._owner.y=e+this._target._rawHeight/2+s-this._owner._rawHeight/2;break;case 11:s=this._owner.y+this._owner._rawHeight-e,t.percent&&(s=s/this._targetHeight*this._target._rawHeight),this._owner.y=e+s-this._owner._rawHeight;break;case 12:s=this._owner.y+this._owner._rawHeight-(e+this._targetHeight/2),t.percent&&(s=s/this._targetHeight*this._target._rawHeight),this._owner.y=e+this._target._rawHeight/2+s-this._owner._rawHeight;break;case 13:s=this._owner.y+this._owner._rawHeight-(e+this._targetHeight),t.percent&&(s=s/this._targetHeight*this._target._rawHeight),this._owner.y=e+this._target._rawHeight+s-this._owner._rawHeight;break;case 14:s=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceWidth-this._target._initWidth:this._owner._rawWidth-this._targetWidth,t.percent&&(s=s/this._targetWidth*this._target._rawWidth),this._target==this._owner.parent?this._owner.setSize(this._target._rawWidth+s,this._owner._rawHeight,!0):this._owner.width=this._target._rawWidth+s;break;case 15:s=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceHeight-this._target._initHeight:this._owner._rawHeight-this._targetHeight,t.percent&&(s=s/this._targetHeight*this._target._rawHeight),this._target==this._owner.parent?this._owner.setSize(this._owner._rawWidth,this._target._rawHeight+s,!0):this._owner.height=this._target._rawHeight+s;break;case 16:break;case 17:s=this._owner.x-(i+this._targetWidth),t.percent&&(s=s/this._targetWidth*this._target._rawWidth),n=this._owner.x,this._owner.x=i+this._target._rawWidth+s,this._owner.width=this._owner._rawWidth-(this._owner.x-n);break;case 18:break;case 19:s=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceWidth-(i+this._target._initWidth):this._owner.width-(i+this._targetWidth),this._owner!=this._target.parent&&(s+=this._owner.x),t.percent&&(s=s/this._targetWidth*this._target._rawWidth),this._owner!=this._target.parent?this._owner.width=i+this._target._rawWidth+s-this._owner.x:this._owner.width=i+this._target._rawWidth+s;break;case 20:break;case 21:s=this._owner.y-(e+this._targetHeight),t.percent&&(s=s/this._targetHeight*this._target._rawHeight),n=this._owner.y,this._owner.y=e+this._target._rawHeight+s,this._owner.height=this._owner._rawHeight-(this._owner.y-n);break;case 22:break;case 23:s=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceHeight-(e+this._target._initHeight):this._owner._rawHeight-(e+this._targetHeight),this._owner!=this._target.parent&&(s+=this._owner.y),t.percent&&(s=s/this._targetHeight*this._target._rawHeight),this._owner!=this._target.parent?this._owner.height=e+this._target._rawHeight+s-this._owner.y:this._owner.height=e+this._target._rawHeight+s}},e.addRefTarget=function(t){t!=this._owner.parent&&t.on("fui_xy_changed",this,this.__targetXYChanged),t.on("fui_size_changed",this,this.__targetSizeChanged),t.on("fui_size_delay_change",this,this.__targetSizeWillChange),this._targetX=this._target.x,this._targetY=this._target.y,this._targetWidth=this._target._rawWidth,this._targetHeight=this._target._rawHeight},e.releaseRefTarget=function(t){t.off("fui_xy_changed",this,this.__targetXYChanged),t.off("fui_size_changed",this,this.__targetSizeChanged),t.off("fui_size_delay_change",this,this.__targetSizeWillChange)},e.__targetXYChanged=function(){if(null!=this._owner.relations.handling||null!=this._owner.group&&this._owner.group._updating)return this._targetX=this._target.x,void(this._targetY=this._target.y);this._owner.relations.handling=this._target;for(var t=this._owner.x,i=this._owner.y,e=this._target.x-this._targetX,s=this._target.y-this._targetY,n=this._defs.length,r=0;n>r;r++){var h=this._defs[r];this.applyOnXYChanged(h,e,s)}if(this._targetX=this._target.x,this._targetY=this._target.y,(t!=this._owner.x||i!=this._owner.y)&&(t=this._owner.x-t,i=this._owner.y-i,this._owner.updateGearFromRelations(1,t,i),null!=this._owner.parent)){var a=this._owner.parent._transitions.length;if(a>0)for(r=0;a>r;++r)this._owner.parent._transitions[r].updateFromRelations(this._owner.id,t,i)}this._owner.relations.handling=null},e.__targetSizeChanged=function(){if(null==this._owner.relations.handling){this._owner.relations.handling=this._target;for(var t=this._owner.x,i=this._owner.y,e=this._owner._rawWidth,s=this._owner._rawHeight,n=this._defs.length,r=0;n>r;r++){var h=this._defs[r];this.applyOnSizeChanged(h)}if(this._targetWidth=this._target._rawWidth,this._targetHeight=this._target._rawHeight,(t!=this._owner.x||i!=this._owner.y)&&(t=this._owner.x-t,i=this._owner.y-i,this._owner.updateGearFromRelations(1,t,i),null!=this._owner.parent)){var a=this._owner.parent._transitions.length;if(a>0)for(r=0;a>r;++r)this._owner.parent._transitions[r].updateFromRelations(this._owner.id,t,i)}e==this._owner._rawWidth&&s==this._owner._rawHeight||(e=this._owner._rawWidth-e,s=this._owner._rawHeight-s,this._owner.updateGearFromRelations(2,e,s)),this._owner.relations.handling=null}},e.__targetSizeWillChange=function(){this._owner.relations.sizeDirty=!0},r(0,e,"owner",function(){return this._owner}),r(0,e,"target",function(){return this._target},function(t){this._target!=t&&(this._target&&this.releaseRefTarget(this._target),this._target=t,this._target&&this.addRefTarget(this._target))}),r(0,e,"isEmpty",function(){return 0==this._defs.length}),t.__init$=function(){i=function(){function t(){this.percent=!1,this.type=NaN}n(t,"");var i=t.prototype;return i.copyFrom=function(t){this.percent=t.percent,this.type=t.type},t}()},t}(),q=function(){function t(t){this._owner=null,this._items=null,this.handling=null,this.sizeDirty=!1,this._owner=t,this._items=[]}n(t,"fairygui.Relations");var i=t.prototype;return i.add=function(t,i,e){void 0===e&&(e=!1);for(var s=this._items.length,n=0;s>n;n++){var r=this._items[n];if(r.target==t)return void r.add(i,e)}var h=new U(this._owner);h.target=t,h.add(i,e),this._items.push(h)},i.addItems=function(t,i){var e,s=i.split(","),n=!1,r=NaN,h=new U(this._owner);for(h.target=t,r=0;2>r;r++)if(e=s[r]){"%"==e.charAt(e.length-1)?(e=e.substr(0,e.length-1),n=!0):n=!1;var a=e.indexOf("-");-1==a&&(e=e+"-"+e);var o=fairygui.Relations.RELATION_NAMES.indexOf(e);if(-1==o)throw"invalid relation type";h.internalAdd(o,n)}this._items.push(h)},i.remove=function(t,i){void 0===i&&(i=0);for(var e=this._items.length,s=0;e>s;){var n=this._items[s];n.target==t?(n.remove(i),n.isEmpty?(n.dispose(),this._items.splice(s,1),e--):s++):s++}},i.contains=function(t){for(var i=this._items.length,e=0;i>e;e++){var s=this._items[e];if(s.target==t)return!0}return!1},i.clearFor=function(t){for(var i=this._items.length,e=0;i>e;){var s=this._items[e];s.target==t?(s.dispose(),this._items.splice(e,1),i--):e++}},i.clearAll=function(){for(var t=this._items.length,i=0;t>i;i++){var e=this._items[i];e.dispose()}this._items.length=0},i.copyFrom=function(t){this.clearAll();for(var i=t._items,e=i.length,s=0;e>s;s++){var n=i[s],r=new U(this._owner);r.copyFrom(n),this._items.push(r)}},i.dispose=function(){this.clearAll()},i.onOwnerSizeChanged=function(t,i){if(0!=this._items.length)for(var e=this._items.length,s=0;e>s;s++){var n=this._items[s];n.applyOnSelfResized(t,i)}},i.ensureRelationsSizeCorrect=function(){if(0!=this._items.length){this.sizeDirty=!1;for(var t=this._items.length,i=0;t>i;i++){var e=this._items[i];e.target.ensureSizeCorrect()}}},i.setup=function(t){for(var i,e,s=t.childNodes,n=s.length,r=0;n>r;r++){var h=s[r];"relation"==h.nodeName&&(i=h.getAttribute("target"),e=this._owner.parent?i?this._owner.parent.getChildById(i):this._owner.parent:this._owner.getChildById(i),e&&this.addItems(e,h.getAttribute("sidePair")))}},r(0,i,"empty",function(){return 0==this._items.length}),s(t,["RELATION_NAMES",function(){return this.RELATION_NAMES=["left-left","left-center","left-right","center-center","right-left","right-center","right-right","top-top","top-middle","top-bottom","middle-middle","bottom-top","bottom-middle","bottom-bottom","width-width","height-height","leftext-left","leftext-right","rightext-left","rightext-right","topext-top","topext-bottom","bottomext-top","bottomext-bottom"]}]),t}(),$=(function(){function t(){}return n(t,"fairygui.RelationType"),t.Left_Left=0,t.Left_Center=1,t.Left_Right=2,t.Center_Center=3,t.Right_Left=4,t.Right_Center=5,t.Right_Right=6,t.Top_Top=7,t.Top_Middle=8,t.Top_Bottom=9,t.Middle_Middle=10,t.Bottom_Top=11,t.Bottom_Middle=12,t.Bottom_Bottom=13,t.Width=14,t.Height=15,t.LeftExt_Left=16,t.LeftExt_Right=17,t.RightExt_Left=18,t.RightExt_Right=19,t.TopExt_Top=20,t.TopExt_Bottom=21,t.BottomExt_Top=22,t.BottomExt_Bottom=23,t.Size=24,t}(),function(){function t(){}return n(t,"fairygui.ScrollBarDisplayType"),t.parse=function(t){switch(t){case"default":return 0;case"visible":return 1;case"auto":return 2;case"hidden":return 3;default:return 0}},t.Default=0,t.Visible=1,t.Auto=2,t.Hidden=3,t}()),K=function(){function t(t,e,s,n,r,h,a){if(this._owner=null,this._maskContainer=null,this._container=null,this._viewWidth=0,this._viewHeight=0,this._contentWidth=0,this._contentHeight=0,this._scrollType=0,this._scrollSpeed=0,this._mouseWheelSpeed=0,this._scrollBarMargin=null,this._bouncebackEffect=!1,this._touchEffect=!1,this._scrollBarDisplayAuto=!1,this._vScrollNone=!1,this._hScrollNone=!1,this._displayOnLeft=!1,this._snapToItem=!1,this._displayInDemand=!1,this._mouseWheelEnabled=!1,this._pageMode=!1,this._pageSizeH=NaN,this._pageSizeV=NaN,this._inertiaDisabled=!1,this._yPerc=NaN,this._xPerc=NaN,this._xPos=NaN,this._yPos=NaN,this._xOverlap=NaN,this._yOverlap=NaN,this._tweening=NaN,this._tweenHelper=null,this._tweener=null,this._needRefresh=!1,this._time1=NaN,this._time2=NaN,this._y1=NaN,this._y2=NaN,this._yOffset=NaN,this._x1=NaN,this._x2=NaN,this._xOffset=NaN,this._isMouseMoved=!1,this._holdAreaPoint=null,this._isHoldAreaDone=!1,this._aniFlag=0,this._scrollBarVisible=!1,this._hzScrollBar=null,this._vtScrollBar=null,null==fairygui.ScrollPane._easeTypeFunc&&(fairygui.ScrollPane._easeTypeFunc=u.cubicOut),this._tweenHelper=new i,this._owner=t,this._maskContainer=new b,this._owner.displayObject.addChild(this._maskContainer),this._container=this._owner._container,this._container.pos(0,0),this._maskContainer.addChild(this._container),this._scrollType=e,this._scrollBarMargin=s,this._bouncebackEffect=J.defaultScrollBounceEffect,this._touchEffect=J.defaultScrollTouchEffect,this._scrollSpeed=J.defaultScrollSpeed,this._mouseWheelSpeed=2*this._scrollSpeed,this._displayOnLeft=0!=(1&r),this._snapToItem=0!=(2&r),this._displayInDemand=0!=(4&r),this._pageMode=0!=(8&r),16&r?this._touchEffect=!0:32&r?this._touchEffect=!1:this._touchEffect=J.defaultScrollTouchEffect,64&r?this._bouncebackEffect=!0:128&r?this._bouncebackEffect=!1:this._bouncebackEffect=J.defaultScrollBounceEffect,this._inertiaDisabled=0!=(256&r),0==(512&r)&&(this._maskContainer.scrollRect=new y),this._xPerc=0,this._yPerc=0,this._xPos=0,this._yPos=0,this._xOverlap=0,this._yOverlap=0,this._aniFlag=0,this._scrollBarVisible=!0,this._mouseWheelEnabled=!0,this._holdAreaPoint=new m,0==n&&(n=J.defaultScrollBarDisplay),3!=n){if(2==this._scrollType||1==this._scrollType){var o=h?h:J.verticalScrollBar;if(o){if(this._vtScrollBar=it.createObjectFromURL(o),!this._vtScrollBar)throw"cannot create scrollbar from "+o;this._vtScrollBar.setScrollPane(this,!0),this._owner.displayObject.addChild(this._vtScrollBar.displayObject)}}if((2==this._scrollType||0==this._scrollType)&&(o=a?a:J.horizontalScrollBar)){if(this._hzScrollBar=it.createObjectFromURL(o),!this._hzScrollBar)throw"cannot create scrollbar from "+o;this._hzScrollBar.setScrollPane(this,!1),this._owner.displayObject.addChild(this._hzScrollBar.displayObject)}this._scrollBarDisplayAuto=2==n,this._scrollBarDisplayAuto&&(this._scrollBarVisible=!1,this._vtScrollBar&&(this._vtScrollBar.displayObject.visible=!1),this._hzScrollBar&&(this._hzScrollBar.displayObject.visible=!1))}this._contentWidth=0,this._contentHeight=0,this.setSize(t.width,t.height),this._owner.on("mousedown",this,this.__mouseDown),this._owner.on("mousewheel",this,this.__mouseWheel)}var i;n(t,"fairygui.ScrollPane");var h=t.prototype;return h.setPercX=function(t,i){void 0===i&&(i=!1),this._owner.ensureBoundsCorrect(),t=et.clamp01(t),t!=this._xPerc&&(this._xPerc=t,this._xPos=this._xPerc*this._xOverlap,this.posChanged(i))},h.setPercY=function(t,i){void 0===i&&(i=!1),this._owner.ensureBoundsCorrect(),t=et.clamp01(t),t!=this._yPerc&&(this._yPerc=t,this._yPos=this._yPerc*this._yOverlap,this.posChanged(i))},h.setPosX=function(t,i){void 0===i&&(i=!1),t!=this._xPos&&(this._xPos=et.clamp(t,0,this._xOverlap),this._xPerc=0==this._xOverlap?0:this._xPos/this._xOverlap,this.posChanged(i))},h.setPosY=function(t,i){void 0===i&&(i=!1),t!=this._yPos&&(this._yPos=et.clamp(t,0,this._yOverlap),this._yPerc=0==this._yOverlap?0:this._yPos/this._yOverlap,this.posChanged(i))},h.getDeltaX=function(t){return t/(this._contentWidth-this._viewWidth)},h.getDeltaY=function(t){return t/(this._contentHeight-this._viewHeight)},h.scrollTop=function(t){void 0===t&&(t=!1),this.setPercY(0,t)},h.scrollBottom=function(t){void 0===t&&(t=!1),this.setPercY(1,t)},h.scrollUp=function(t,i){void 0===t&&(t=1),void 0===i&&(i=!1),this.setPercY(this._yPerc-this.getDeltaY(this._scrollSpeed*t),i)},h.scrollDown=function(t,i){void 0===t&&(t=1),void 0===i&&(i=!1),this.setPercY(this._yPerc+this.getDeltaY(this._scrollSpeed*t),i)},h.scrollLeft=function(t,i){void 0===t&&(t=1),void 0===i&&(i=!1),this.setPercX(this._xPerc-this.getDeltaX(this._scrollSpeed*t),i)},h.scrollRight=function(t,i){void 0===t&&(t=1),void 0===i&&(i=!1),this.setPercX(this._xPerc+this.getDeltaX(this._scrollSpeed*t),i)},h.scrollToView=function(t,i,e){void 0===i&&(i=!1),void 0===e&&(e=!1),this._owner.ensureBoundsCorrect(),this._needRefresh&&this.refresh();var s;if(t instanceof fairygui.GObject?t.parent!=this._owner?(t.parent.localToGlobalRect(t.x,t.y,t.width,t.height,fairygui.ScrollPane.sHelperRect),s=this._owner.globalToLocalRect(fairygui.ScrollPane.sHelperRect.x,fairygui.ScrollPane.sHelperRect.y,fairygui.ScrollPane.sHelperRect.width,fairygui.ScrollPane.sHelperRect.height,fairygui.ScrollPane.sHelperRect)):(s=fairygui.ScrollPane.sHelperRect,s.setTo(t.x,t.y,t.width,t.height)):s=t,this._yOverlap>0){var n=this.posY,r=n+this._viewHeight;e||s.y<n||s.height>=this._viewHeight?this._pageMode?this.setPosY(Math.floor(s.y/this._pageSizeV)*this._pageSizeV,i):this.setPosY(s.y,i):s.y+s.height>r&&(this._pageMode?this.setPosY(Math.floor(s.y/this._pageSizeV)*this._pageSizeV,i):s.height<=this._viewHeight/2?this.setPosY(s.y+2*s.height-this._viewHeight,i):this.setPosY(s.y+s.height-this._viewHeight,i))}if(this._xOverlap>0){var h=this.posX,a=h+this._viewWidth;e||s.x<h||s.width>=this._viewWidth?this._pageMode?this.setPosX(Math.floor(s.x/this._pageSizeH)*this._pageSizeH,i):this.setPosX(s.x,i):s.x+s.width>a&&(this._pageMode?this.setPosX(Math.floor(s.x/this._pageSizeH)*this._pageSizeH,i):s.width<=this._viewWidth/2?this.setPosX(s.x+2*s.width-this._viewWidth,i):this.setPosX(s.x+s.width-this._viewWidth,i))}!i&&this._needRefresh&&this.refresh()},h.isChildInView=function(t){var i=NaN;return this._yOverlap>0&&(i=t.y+this._container.y,i<-t.height-20||i>this._viewHeight+20)?!1:!(this._xOverlap>0&&(i=t.x+this._container.x,i<-t.width-20||i>this._viewWidth+20))},h.cancelDragging=function(){this._owner.displayObject.stage.off("mousemove",this,this.__mouseMove),this._owner.displayObject.stage.off("mouseup",this,this.__mouseUp),this._owner.displayObject.stage.off("click",this,this.__click),t.draggingPane==this&&(t.draggingPane=null),t._gestureFlag=0,this._isMouseMoved=!1},h.onOwnerSizeChanged=function(){this.setSize(this._owner.width,this._owner.height),this.posChanged(!1)},h.adjustMaskContainer=function(){var t=NaN,i=NaN;t=this._displayOnLeft&&null!=this._vtScrollBar?Math.floor(this._owner.margin.left+this._vtScrollBar.width):Math.floor(this._owner.margin.left),i=Math.floor(this._owner.margin.top),t+=this._owner._alignOffset.x,i+=this._owner._alignOffset.y,this._maskContainer.pos(t,i)},h.setSize=function(t,i){this.adjustMaskContainer(),this._hzScrollBar&&(this._hzScrollBar.y=i-this._hzScrollBar.height,this._vtScrollBar&&!this._vScrollNone?(this._hzScrollBar.width=t-this._vtScrollBar.width-this._scrollBarMargin.left-this._scrollBarMargin.right,this._displayOnLeft?this._hzScrollBar.x=this._scrollBarMargin.left+this._vtScrollBar.width:this._hzScrollBar.x=this._scrollBarMargin.left):(this._hzScrollBar.width=t-this._scrollBarMargin.left-this._scrollBarMargin.right,this._hzScrollBar.x=this._scrollBarMargin.left)),this._vtScrollBar&&(this._displayOnLeft||(this._vtScrollBar.x=t-this._vtScrollBar.width),this._hzScrollBar?this._vtScrollBar.height=i-this._hzScrollBar.height-this._scrollBarMargin.top-this._scrollBarMargin.bottom:this._vtScrollBar.height=i-this._scrollBarMargin.top-this._scrollBarMargin.bottom,this._vtScrollBar.y=this._scrollBarMargin.top),this._viewWidth=t,this._viewHeight=i,this._hzScrollBar&&!this._hScrollNone&&(this._viewHeight-=this._hzScrollBar.height),this._vtScrollBar&&!this._vScrollNone&&(this._viewWidth-=this._vtScrollBar.width),this._viewWidth-=this._owner.margin.left+this._owner.margin.right,this._viewHeight-=this._owner.margin.top+this._owner.margin.bottom,this._viewWidth=Math.max(1,this._viewWidth),this._viewHeight=Math.max(1,this._viewHeight),this._pageSizeH=this._viewWidth,this._pageSizeV=this._viewHeight,this.handleSizeChanged()},h.setContentSize=function(t,i){this._contentWidth==t&&this._contentHeight==i||(this._contentWidth=t,this._contentHeight=i,this.handleSizeChanged())},h.changeContentSizeOnScrolling=function(t,i,e,s){this._contentWidth+=t,this._contentHeight+=i,this._isMouseMoved?(0!=e&&(this._container.x-=e),0!=s&&(this._container.y-=s),this.validateHolderPos(),this._xOffset+=e,this._yOffset+=s,this._y1=this._y2=this._container.y,this._x1=this._x2=this._container.x,this._yPos=-this._container.y,this._xPos=-this._container.x):2==this._tweening&&(0!=e&&(this._container.x-=e,this._tweenHelper.start.x-=e),0!=s&&(this._container.y-=s,this._tweenHelper.start.y-=s)),this.handleSizeChanged(!0)},h.handleSizeChanged=function(t){void 0===t&&(t=!1),this._displayInDemand&&(this._vtScrollBar&&(this._contentHeight<=this._viewHeight?this._vScrollNone||(this._vScrollNone=!0,this._viewWidth+=this._vtScrollBar.width):this._vScrollNone&&(this._vScrollNone=!1,this._viewWidth-=this._vtScrollBar.width)),this._hzScrollBar&&(this._contentWidth<=this._viewWidth?this._hScrollNone||(this._hScrollNone=!0,this._viewHeight+=this._vtScrollBar.height):this._hScrollNone&&(this._hScrollNone=!1,this._viewHeight-=this._vtScrollBar.height))),this._vtScrollBar&&(this._viewHeight<this._vtScrollBar.minSize?this._vtScrollBar.displayObject.visible=!1:(this._vtScrollBar.displayObject.visible=this._scrollBarVisible&&!this._vScrollNone,0==this._contentHeight?this._vtScrollBar.displayPerc=0:this._vtScrollBar.displayPerc=Math.min(1,this._viewHeight/this._contentHeight))),this._hzScrollBar&&(this._viewWidth<this._hzScrollBar.minSize?this._hzScrollBar.displayObject.visible=!1:(this._hzScrollBar.displayObject.visible=this._scrollBarVisible&&!this._hScrollNone,0==this._contentWidth?this._hzScrollBar.displayPerc=0:this._hzScrollBar.displayPerc=Math.min(1,this._viewWidth/this._contentWidth)));var i=this._maskContainer.scrollRect;null!=i&&(i.width=this._viewWidth,i.height=this._viewHeight,this._maskContainer.scrollRect=i),0==this._scrollType||2==this._scrollType?this._xOverlap=Math.ceil(Math.max(0,this._contentWidth-this._viewWidth)):this._xOverlap=0,1==this._scrollType||2==this._scrollType?this._yOverlap=Math.ceil(Math.max(0,this._contentHeight-this._viewHeight)):this._yOverlap=0,0==this._tweening&&t?(0!=this._xPerc&&1!=this._xPerc||(this._xPos=this._xPerc*this._xOverlap,this._container.x=-this._xPos),0!=this._yPerc&&1!=this._yPerc||(this._yPos=this._yPerc*this._yOverlap,this._container.y=-this._yPos)):(this._xPos=et.clamp(this._xPos,0,this._xOverlap),this._xPerc=this._xOverlap>0?this._xPos/this._xOverlap:0,this._yPos=et.clamp(this._yPos,0,this._yOverlap),this._yPerc=this._yOverlap>0?this._yPos/this._yOverlap:0),this.validateHolderPos(),null!=this._vtScrollBar&&(this._vtScrollBar.scrollPerc=this._yPerc),null!=this._hzScrollBar&&(this._hzScrollBar.scrollPerc=this._xPerc)},h.validateHolderPos=function(){this._container.x=et.clamp(this._container.x,-this._xOverlap,0),this._container.y=et.clamp(this._container.y,-this._yOverlap,0)},h.posChanged=function(t){0==this._aniFlag?this._aniFlag=t?1:-1:1!=this._aniFlag||t||(this._aniFlag=-1),this._needRefresh=!0,e.timer.callLater(this,this.refresh),2==this._tweening&&this.killTween()},h.killTween=function(){1==this._tweening?(this._tweener.clear(),this._tweening=0,this._tweener=null,this.syncScrollBar(!0)):2==this._tweening&&(this._tweener.clear(),this._tweener=null,this._tweening=0,this.validateHolderPos(),this.syncScrollBar(!0),L.dispatch("fui_scroll_end",this._owner.displayObject))},h.refresh=function(){if(this._needRefresh=!1,e.timer.clear(this,this.refresh),this._pageMode){var i=0,s=NaN;this._yOverlap>0&&1!=this._yPerc&&0!=this._yPerc&&(i=Math.floor(this._yPos/this._pageSizeV),s=this._yPos-i*this._pageSizeV,s>this._pageSizeV/2&&i++,this._yPos=i*this._pageSizeV,this._yPos>this._yOverlap?(this._yPos=this._yOverlap,this._yPerc=1):this._yPerc=this._yPos/this._yOverlap),this._xOverlap&&1!=this._xPerc&&0!=this._xPerc&&(i=Math.floor(this._xPos/this._pageSizeH),s=this._xPos-i*this._pageSizeH,s>this._pageSizeH/2&&i++,this._xPos=i*this._pageSizeH,this._xPos>this._xOverlap?(this._xPos=this._xOverlap,this._xPerc=1):this._xPerc=this._xPos/this._xOverlap)}else if(this._snapToItem){var n=this._owner.getSnappingPosition(1==this._xPerc?0:this._xPos,1==this._yPerc?0:this._yPos,t.sHelperPoint);1!=this._xPerc&&n.x!=this._xPos&&(this._xPos=n.x,this._xPerc=this._xPos/this._xOverlap,this._xPerc>1&&(this._xPerc=1,this._xPos=this._xOverlap)),1!=this._yPerc&&n.y!=this._yPos&&(this._yPos=n.y,this._yPerc=this._yPos/this._yOverlap,this._yPerc>1&&(this._yPerc=1,this._yPos=this._yOverlap))}this.refresh2(),L.dispatch("fui_scroll",this._owner.displayObject),this._needRefresh&&(this._needRefresh=!1,e.timer.clear(this,this.refresh),this.refresh2()),this._aniFlag=0},h.refresh2=function(){var t=Math.floor(this._xPos),i=Math.floor(this._yPos);if(this._aniFlag&&!this._isMouseMoved){var e=this._container.x,s=this._container.y;this._yOverlap>0?s=-i:0!=this._container.y&&(this._container.y=0),this._xOverlap>0?e=-t:0!=this._container.x&&(this._container.x=0),e==this._container.x&&s==this._container.y||(this.killTween(),this._maskContainer.mouseEnabled=!1,this._tweening=1,this._tweener=I.to(this._container,{x:e,y:s},500,fairygui.ScrollPane._easeTypeFunc,g.create(this,this.__tweenComplete)),this._tweener.update=g.create(this,this.__tweenUpdate,null,!1))}else null!=this._tweener&&this.killTween(),this._isMouseMoved&&(this._xOffset+=this._container.x- -t,this._yOffset+=this._container.y- -i),this._container.pos(-t,-i),this._isMouseMoved&&(this._y1=this._y2=this._container.y,this._x1=this._x2=this._container.x),this._vtScrollBar&&(this._vtScrollBar.scrollPerc=this._yPerc),this._hzScrollBar&&(this._hzScrollBar.scrollPerc=this._xPerc)},h.syncPos=function(){this._xOverlap>0&&(this._xPos=et.clamp(-this._container.x,0,this._xOverlap),this._xPerc=this._xPos/this._xOverlap),this._yOverlap>0&&(this._yPos=et.clamp(-this._container.y,0,this._yOverlap),this._yPerc=this._yPos/this._yOverlap)},h.syncScrollBar=function(t){void 0===t&&(t=!1),t?(this._vtScrollBar&&this._scrollBarDisplayAuto&&this.showScrollBar(!1),this._hzScrollBar&&this._scrollBarDisplayAuto&&this.showScrollBar(!1),this._maskContainer.mouseEnabled=!0):(this._vtScrollBar&&(this._vtScrollBar.scrollPerc=0==this._yOverlap?0:et.clamp(-this._container.y,0,this._yOverlap)/this._yOverlap,this._scrollBarDisplayAuto&&this.showScrollBar(!0)),this._hzScrollBar&&(this._hzScrollBar.scrollPerc=0==this._xOverlap?0:et.clamp(-this._container.x,0,this._xOverlap)/this._xOverlap,this._scrollBarDisplayAuto&&this.showScrollBar(!0)))},h.__mouseDown=function(){this._touchEffect&&(null!=this._tweener&&this.killTween(),this._owner.globalToLocal(e.stage.mouseX,e.stage.mouseY,fairygui.ScrollPane.sHelperPoint),this._x1=this._x2=this._container.x,this._y1=this._y2=this._container.y,this._xOffset=fairygui.ScrollPane.sHelperPoint.x-this._container.x,this._yOffset=fairygui.ScrollPane.sHelperPoint.y-this._container.y,this._time1=this._time2=e.timer.currTimer,this._holdAreaPoint.x=fairygui.ScrollPane.sHelperPoint.x,this._holdAreaPoint.y=fairygui.ScrollPane.sHelperPoint.y,this._isHoldAreaDone=!1,this._isMouseMoved=!1,this._owner.displayObject.stage.on("mousemove",this,this.__mouseMove),this._owner.displayObject.stage.on("mouseup",this,this.__mouseUp),this._owner.displayObject.stage.on("click",this,this.__click))},h.__mouseMove=function(){if(this._touchEffect&&(null==t.draggingPane||t.draggingPane==this)&&null==M.draggingObject){var i=J.touchScrollSensitivity,s=this._owner.globalToLocal(e.stage.mouseX,e.stage.mouseY,fairygui.ScrollPane.sHelperPoint),n=NaN,r=NaN,h=!1,a=!1,o=!1;
if(1==this._scrollType){if(!this._isHoldAreaDone){if(t._gestureFlag|=1,n=Math.abs(this._holdAreaPoint.y-this._maskContainer.mouseY),i>n)return;if(0!=(2&t._gestureFlag)&&(r=Math.abs(this._holdAreaPoint.x-this._maskContainer.mouseX),r>n))return}h=!0}else if(0==this._scrollType){if(!this._isHoldAreaDone){if(t._gestureFlag|=2,n=Math.abs(this._holdAreaPoint.x-this._maskContainer.mouseX),i>n)return;if(0!=(1&t._gestureFlag)&&(r=Math.abs(this._holdAreaPoint.y-this._maskContainer.mouseY),r>n))return}a=!0}else{if(t._gestureFlag=3,!this._isHoldAreaDone&&(n=Math.abs(this._holdAreaPoint.y-this._maskContainer.mouseY),i>n&&(n=Math.abs(this._holdAreaPoint.x-this._maskContainer.mouseX),i>n)))return;h=a=!0}var l=e.timer.currTimer;if(l-this._time2>50&&(this._time2=this._time1,this._time1=l,o=!0),h){var u=Math.floor(s.y-this._yOffset);u>0?!this._bouncebackEffect||this._inertiaDisabled?this._container.y=0:this._container.y=Math.floor(.5*u):u<-this._yOverlap?!this._bouncebackEffect||this._inertiaDisabled?this._container.y=-Math.floor(this._yOverlap):this._container.y=Math.floor(.5*(u-this._yOverlap)):this._container.y=u,o&&(this._y2=this._y1,this._y1=this._container.y)}if(a){var _=Math.floor(s.x-this._xOffset);_>0?!this._bouncebackEffect||this._inertiaDisabled?this._container.x=0:this._container.x=Math.floor(.5*_):_<0-this._xOverlap||this._inertiaDisabled?this._bouncebackEffect?this._container.x=Math.floor(.5*(_-this._xOverlap)):this._container.x=-Math.floor(this._xOverlap):this._container.x=_,o&&(this._x2=this._x1,this._x1=this._container.x)}t.draggingPane=this,this._maskContainer.mouseEnabled=!1,this._isHoldAreaDone=!0,this._isMouseMoved=!0,this.syncPos(),this.syncScrollBar(),L.dispatch("fui_scroll",this._owner.displayObject)}},h.__mouseUp=function(){if(this._owner.displayObject.stage.off("mousemove",this,this.__mouseMove),this._owner.displayObject.stage.off("mouseup",this,this.__mouseUp),this._owner.displayObject.stage.off("click",this,this.__click),!this._touchEffect)return void(this._isMouseMoved=!1);if(t.draggingPane==this&&(t.draggingPane=null),t._gestureFlag=0,!this._isMouseMoved||!this._touchEffect||this._inertiaDisabled)return void(this._isMouseMoved=!1);this._isMouseMoved=!1;var s=(e.timer.currTimer-this._time2)/1e3;0==s&&(s=.001);var n=(this._container.y-this._y2)/s,r=(this._container.x-this._x2)/s,h=.3;this._tweenHelper.start.x=this._container.x,this._tweenHelper.start.y=this._container.y;var a=this._tweenHelper.change1,o=this._tweenHelper.change2,l=0,u=0,_=0,c=0,d=0,f=NaN;if(2==this._scrollType||0==this._scrollType?(this._container.x>J.touchDragSensitivity?d=1:this._container.x<-this._xOverlap-J.touchDragSensitivity&&(d=2),a.x=i.calculateChange(r,h),o.x=0,l=this._container.x+a.x,this._pageMode&&0>l&&l>-this._xOverlap&&(_=Math.floor(-l/this._pageSizeH),f=Math.min(this._pageSizeH,this._contentWidth-(_+1)*this._pageSizeH),c=-l-_*this._pageSizeH,Math.abs(a.x)>this._pageSizeH?c>.5*f&&_++:c>f*(a.x<0?.3:.7)&&_++,l=-_*this._pageSizeH,l<-this._xOverlap&&(l=-this._xOverlap),a.x=l-this._container.x)):a.x=o.x=0,2==this._scrollType||1==this._scrollType?(this._container.y>J.touchDragSensitivity?d=1:this._container.y<-this._yOverlap-J.touchDragSensitivity&&(d=2),a.y=i.calculateChange(n,h),o.y=0,u=this._container.y+a.y,this._pageMode&&0>u&&u>-this._yOverlap&&(_=Math.floor(-u/this._pageSizeV),f=Math.min(this._pageSizeV,this._contentHeight-(_+1)*this._pageSizeV),c=-u-_*this._pageSizeV,Math.abs(a.y)>this._pageSizeV?c>.5*f&&_++:c>f*(a.y<0?.3:.7)&&_++,u=-_*this._pageSizeV,u<-this._yOverlap&&(u=-this._yOverlap),a.y=u-this._container.y)):a.y=o.y=0,this._snapToItem&&!this._pageMode){l=-l,u=-u;var p=this._owner.getSnappingPosition(l,u,fairygui.ScrollPane.sHelperPoint);l=-p.x,u=-p.y,a.x=l-this._container.x,a.y=u-this._container.y}this._bouncebackEffect?(l>0?o.x=0-this._container.x-a.x:l<-this._xOverlap&&(o.x=-this._xOverlap-this._container.x-a.x),u>0?o.y=0-this._container.y-a.y:u<-this._yOverlap&&(o.y=-this._yOverlap-this._container.y-a.y)):(l>0?a.x=0-this._container.x:l<-this._xOverlap&&(a.x=-this._xOverlap-this._container.x),u>0?a.y=0-this._container.y:u<-this._yOverlap&&(a.y=-this._yOverlap-this._container.y)),this._tweenHelper.value=0,this._tweenHelper.change1=a,this._tweenHelper.change2=o,null!=this._tweener&&this.killTween(),this._tweening=2,this._tweener=I.to(this._tweenHelper,{value:1},1e3*h,fairygui.ScrollPane._easeTypeFunc,g.create(this,this.__tweenComplete2)),this._tweener.update=g.create(this,this.__tweenUpdate2,null,!1),1==d?L.dispatch("fui_pull_down_release",this._owner.displayObject):2==d&&L.dispatch("fui_pull_up_release",this._owner.displayObject)},h.__click=function(){this._isMouseMoved=!1},h.__mouseWheel=function(t){if(this._mouseWheelEnabled){var i=(this._owner.globalToLocal(e.stage.mouseX,e.stage.mouseY,fairygui.ScrollPane.sHelperPoint),t.delta);this._xOverlap>0&&0==this._yOverlap?0>i?this.setPercX(this._xPerc+this.getDeltaX(this._mouseWheelSpeed),!1):this.setPercX(this._xPerc-this.getDeltaX(this._mouseWheelSpeed),!1):0>i?this.setPercY(this._yPerc+this.getDeltaY(this._mouseWheelSpeed),!1):this.setPercY(this._yPerc-this.getDeltaY(this._mouseWheelSpeed),!1)}},h.__rollOver=function(){this.showScrollBar(!0)},h.__rollOut=function(){this.showScrollBar(!1)},h.showScrollBar=function(t){t?(this.__showScrollBar(!0),e.timer.clear(this,this.__showScrollBar)):e.timer.once(500,this,this.__showScrollBar,[t])},h.__showScrollBar=function(t){this._scrollBarVisible=t&&this._viewWidth>0&&this._viewHeight>0,this._vtScrollBar&&(this._vtScrollBar.displayObject.visible=this._scrollBarVisible&&!this._vScrollNone),this._hzScrollBar&&(this._hzScrollBar.displayObject.visible=this._scrollBarVisible&&!this._hScrollNone)},h.__tweenUpdate=function(){this.syncScrollBar(),L.dispatch("fui_scroll",this._owner.displayObject)},h.__tweenComplete=function(){this._tweener=null,this._tweening=0,this.validateHolderPos(),this.syncScrollBar(!0),L.dispatch("fui_scroll",this._owner.displayObject)},h.__tweenUpdate2=function(){this._container.pos(Math.floor(this._tweenHelper.start.x+this._tweenHelper.change1.x*this._tweenHelper.value+this._tweenHelper.change2.x*this._tweenHelper.value*this._tweenHelper.value),Math.floor(this._tweenHelper.start.y+this._tweenHelper.change1.y*this._tweenHelper.value+this._tweenHelper.change2.y*this._tweenHelper.value*this._tweenHelper.value)),this.syncPos(),this.syncScrollBar(),L.dispatch("fui_scroll",this._owner.displayObject)},h.__tweenComplete2=function(){this._tweener=null,this._tweening=0,this.validateHolderPos(),this.syncPos(),this.syncScrollBar(!0),L.dispatch("fui_scroll",this._owner.displayObject),L.dispatch("fui_scroll_end",this._owner.displayObject)},r(0,h,"viewWidth",function(){return this._viewWidth},function(t){t=t+this._owner.margin.left+this._owner.margin.right,null!=this._vtScrollBar&&(t+=this._vtScrollBar.width),this._owner.width=t}),r(0,h,"owner",function(){return this._owner}),r(0,h,"percY",function(){return this._yPerc},function(t){this.setPercY(t,!1)}),r(0,h,"scrollSpeed",function(){return this._scrollSpeed},function(t){this._scrollSpeed=this.scrollSpeed,0==this._scrollSpeed&&(this._scrollSpeed=J.defaultScrollSpeed),this._mouseWheelSpeed=2*this._scrollSpeed}),r(0,h,"percX",function(){return this._xPerc},function(t){this.setPercX(t,!1)}),r(0,h,"bouncebackEffect",function(){return this._bouncebackEffect},function(t){this._bouncebackEffect=t}),r(0,h,"isBottomMost",function(){return 1==this._yPerc||0==this._yOverlap}),r(0,h,"touchEffect",function(){return this._touchEffect},function(t){this._touchEffect=t}),r(0,h,"viewHeight",function(){return this._viewHeight},function(t){t=t+this._owner.margin.top+this._owner.margin.bottom,null!=this._hzScrollBar&&(t+=this._hzScrollBar.height),this._owner.height=t}),r(0,h,"snapToItem",function(){return this._snapToItem},function(t){this._snapToItem=t}),r(0,h,"posX",function(){return this._xPos},function(t){this.setPosX(t,!1)}),r(0,h,"posY",function(){return this._yPos},function(t){this.setPosY(t,!1)}),r(0,h,"isRightMost",function(){return 1==this._xPerc||0==this._xOverlap}),r(0,h,"currentPageX",function(){return this._pageMode?Math.floor(this.posX/this._pageSizeH):0},function(t){this._pageMode&&this._xOverlap>0&&this.setPosX(t*this._pageSizeH,!1)}),r(0,h,"currentPageY",function(){return this._pageMode?Math.floor(this.posY/this._pageSizeV):0},function(t){this._pageMode&&this._yOverlap>0&&this.setPosY(t*this._pageSizeV,!1)}),r(0,h,"scrollingPosX",function(){return et.clamp(-this._container.x,0,this._xOverlap)}),r(0,h,"scrollingPosY",function(){return et.clamp(-this._container.y,0,this._yOverlap)}),r(0,h,"contentWidth",function(){return this._contentWidth}),r(0,h,"contentHeight",function(){return this._contentHeight}),t._easeTypeFunc=null,t.draggingPane=null,t._gestureFlag=0,s(t,["sHelperRect",function(){return this.sHelperRect=new y},"sHelperPoint",function(){return this.sHelperPoint=new m}]),t.__init$=function(){i=function(){function t(){this.value=NaN,this.start=null,this.change1=null,this.change2=null,this.start=new m,this.change1=new m,this.change2=new m}return n(t,""),t.calculateChange=function(i,e){return e*t.checkpoint*i/t.easeOutCubic(t.checkpoint,0,1,1)},t.easeOutCubic=function(t,i,e,s){return e*((t=t/s-1)*t*t+1)+i},t.checkpoint=.05,t}()},t}(),Q=function(){function t(){}return n(t,"fairygui.ScrollType"),t.parse=function(t){switch(t){case"horizontal":return 0;case"vertical":return 1;case"both":return 2;default:return 1}},t.Horizontal=0,t.Vertical=1,t.Both=2,t}(),Z=function(){function t(t){this.name=null,this.autoPlayRepeat=1,this.autoPlayDelay=0,this._owner=null,this._ownerBaseX=0,this._ownerBaseY=0,this._items=null,this._totalTimes=0,this._totalTasks=0,this._playing=!1,this._onComplete=null,this._options=0,this._reversed=!1,this._maxTime=0,this._autoPlay=!1,this.OPTION_IGNORE_DISPLAY_CONTROLLER=1,this.FRAME_RATE=24,this._owner=t,this._items=[]}var i,s,h;n(t,"fairygui.Transition");var a=t.prototype;return a.play=function(t,i,e){void 0===i&&(i=1),void 0===e&&(e=0),this._play(t,i,e,!1)},a.playReverse=function(t,i,e){void 0===i&&(i=1),void 0===e&&(e=0),this._play(t,i,e,!0)},a._play=function(t,i,e,s){if(void 0===i&&(i=1),void 0===e&&(e=0),void 0===s&&(s=!1),this.stop(),0==i?i=1:-1==i&&(i=Number.MAX_VALUE),this._totalTimes=i,this._reversed=s,this.internalPlay(e),this._playing=this._totalTasks>0,this._playing){if(this._onComplete=t,this._owner.internalVisible++,0!=(this._options&this.OPTION_IGNORE_DISPLAY_CONTROLLER))for(var n=this._items.length,r=0;n>r;r++){var h=this._items[r];null!=h.target&&h.target!=this._owner&&h.target.internalVisible++}}else null!=t&&t.run()},a.stop=function(t,i){if(void 0===t&&(t=!0),void 0===i&&(i=!1),this._playing){this._playing=!1,this._totalTasks=0,this._totalTimes=0;var e=this._onComplete;this._onComplete=null,this._owner.internalVisible--;var s,n=this._items.length,r=NaN;if(this._reversed)for(r=n-1;r>=0;r--)s=this._items[r],null!=s.target&&this.stopItem(s,t);else for(r=0;n>r;r++)s=this._items[r],null!=s.target&&this.stopItem(s,t);i&&null!=e&&e.run()}},a.stopItem=function(t,i){if(0!=(this._options&this.OPTION_IGNORE_DISPLAY_CONTROLLER)&&t.target!=this._owner&&t.target.internalVisible--,12==t.type&&(t.target.filters=null),!t.completed)if(null!=t.tweener&&(t.tweener.clear(),t.tweener=null),10==t.type){var s=t.target.getTransition(t.value.s);null!=s&&s.stop(i,!1)}else 11==t.type?(e.timer.clear(t,t.__shake),t.target._gearLocked=!0,t.target.setXY(t.target.x-t.startValue.f1,t.target.y-t.startValue.f2),t.target._gearLocked=!1):i&&(t.tween?t.yoyo&&t.repeat%2!=0?this.applyValue(t,this._reversed?t.endValue:t.startValue):this.applyValue(t,this._reversed?t.startValue:t.endValue):9!=t.type&&this.applyValue(t,t.value))},a.dispose=function(){if(this._playing){this._playing=!1;for(var t=this._items.length,i=0;t>i;i++){var s=this._items[i];if(null!=s.target&&!s.completed)if(null!=s.tweener&&(s.tweener.clear(),s.tweener=null),10==s.type){var n=s.target.getTransition(s.value.s);null!=n&&n.dispose()}else 11==s.type&&e.timer.clear(s,s.__shake)}}},a.setValue=function(t,i){for(var e=[],s=1,n=arguments.length;n>s;s++)e.push(arguments[s]);for(var r,h=this._items.length,s=0;h>s;s++){var a=this._items[s];if(null!=a.label||null!=a.label2){if(a.label==t)r=a.tween?a.startValue:a.value;else{if(a.label2!=t)continue;r=a.endValue}switch(a.type){case 0:case 1:case 3:case 2:case 13:r.b1=!0,r.b2=!0,r.f1=parseFloat(e[0]),r.f2=parseFloat(e[1]);break;case 4:r.f1=parseFloat(e[0]);break;case 5:r.i=parseInt(e[0]);break;case 6:r.s=e[0];break;case 7:r.i=parseInt(e[0]),e.length>1&&(r.b=e[1]);break;case 8:r.b=e[0];break;case 9:r.s=e[0],e.length>1&&(r.f1=parseFloat(e[1]));break;case 10:r.s=e[0],e.length>1&&(r.i=parseInt(e[1]));break;case 11:r.f1=parseFloat(e[0]),e.length>1&&(r.f2=parseFloat(e[1]));break;case 12:r.f1=parseFloat(e[0]),r.f2=parseFloat(e[1]),r.f3=parseFloat(e[2]),r.f4=parseFloat(e[3])}}}},a.setHook=function(t,i){for(var e=this._items.length,s=0;e>s;s++){var n=this._items[s];if(n.label==t){n.hook=i;break}if(n.label2==t){n.hook2=i;break}}},a.clearHooks=function(){for(var t=this._items.length,i=0;t>i;i++){var e=this._items[i];e.hook=null,e.hook2=null}},a.setTarget=function(t,i){for(var e=this._items.length,s=0;e>s;s++){var n=this._items[s];n.label==t&&(n.targetId=i.id)}},a.setDuration=function(t,i){for(var e=this._items.length,s=0;e>s;s++){var n=this._items[s];n.tween&&n.label==t&&(n.duration=i)}},a.updateFromRelations=function(t,i,e){var s=this._items.length;if(0!=s)for(var n=0;s>n;n++){var r=this._items[n];0==r.type&&r.targetId==t&&(r.tween?(r.startValue.f1+=i,r.startValue.f2+=e,r.endValue.f1+=i,r.endValue.f2+=e):(r.value.f1+=i,r.value.f2+=e))}},a.internalPlay=function(t){void 0===t&&(t=0),this._ownerBaseX=this._owner.x,this._ownerBaseY=this._owner.y,this._totalTasks=0;for(var i,e=this._items.length,s=NaN,n=0;e>n;n++)i=this._items[n],i.targetId?i.target=this._owner.getChildById(i.targetId):i.target=this._owner,null!=i.target&&(i.tween?(s=this._reversed?t+1e3*(this._maxTime-i.time-i.duration):t+1e3*i.time,s>0?(this._totalTasks++,i.completed=!1,i.tweener=I.to(i.value,{},s,null,g.create(this,this.__delayCall,[i])),i.tweener.update=null):this.startTween(i)):(s=this._reversed?t+1e3*(this._maxTime-i.time):t+1e3*i.time,0==s?this.applyValue(i,i.value):(i.completed=!1,this._totalTasks++,i.tweener=I.to(i.value,{},s,null,g.create(this,this.__delayCall2,[i])),i.tweener.update=null)))},a.prepareValue=function(t,i,e){void 0===e&&(e=!1);var s,n;switch(this._reversed?(s=t.endValue,n=t.startValue):(s=t.startValue,n=t.endValue),t.type){case 0:case 1:0==t.type?t.target==this._owner?(s.b1||(s.f1=0),s.b2||(s.f2=0)):(s.b1||(s.f1=t.target.x),s.b2||(s.f2=t.target.y)):(s.b1||(s.f1=t.target.width),s.b2||(s.f2=t.target.height)),t.value.f1=s.f1,t.value.f2=s.f2,t.value.b1=s.b1,t.value.b2=s.b2,n.b1||(n.f1=t.value.f1),n.b2||(n.f2=t.value.f2),i.f1=n.f1,i.f2=n.f2;break;case 2:case 13:t.value.f1=s.f1,t.value.f2=s.f2,i.f1=n.f1,i.f2=n.f2;break;case 4:t.value.f1=s.f1,i.f1=n.f1;break;case 5:t.value.i=s.i,i.i=n.i;break;case 12:t.value.f1=s.f1,t.value.f2=s.f2,t.value.f3=s.f3,t.value.f4=s.f4,i.f1=n.f1,i.f2=n.f2,i.f3=n.f3,i.f4=n.f4}i.dummy=0},a.startTween=function(t){var i={};this.prepareValue(t,i,this._reversed),this.applyValue(t,t.value);var e;0!=t.repeat?(t.tweenTimes=0,e=g.create(this,this.__tweenRepeatComplete,[t])):e=g.create(this,this.__tweenComplete,[t]),this._totalTasks++,t.completed=!1,t.tweener=I.to(t.value,i,1e3*t.duration,t.easeType,e),t.tweener.update=g.create(this,this.__tweenUpdate,[t],!1),null!=t.hook&&t.hook.run()},a.__delayCall=function(t){t.tweener=null,this._totalTasks--,this.startTween(t)},a.__delayCall2=function(t){t.tweener=null,this._totalTasks--,t.completed=!0,this.applyValue(t,t.value),null!=t.hook&&t.hook.run(),this.checkAllComplete()},a.__tweenUpdate=function(t){this.applyValue(t,t.value)},a.__tweenComplete=function(t){t.tweener=null,this._totalTasks--,t.completed=!0,null!=t.hook2&&t.hook2.run(),this.checkAllComplete()},a.__tweenRepeatComplete=function(t){if(t.tweenTimes++,-1==t.repeat||t.tweenTimes<t.repeat+1){var i={},e=!1;e=t.yoyo?this._reversed?t.tweenTimes%2==0:t.tweenTimes%2==1:this._reversed,this.prepareValue(t,i,e),t.tweener=I.to(t.value,i,1e3*t.duration,t.easeType,g.create(this,this.__tweenRepeatComplete,[t])),t.tweener.update=g.create(this,this.__tweenUpdate,[t],!1)}else this.__tweenComplete(t)},a.__playTransComplete=function(t){this._totalTasks--,t.completed=!0,this.checkAllComplete()},a.checkAllComplete=function(){if(this._playing&&0==this._totalTasks)if(this._totalTimes<0)e.timer.callLater(this,this.internalPlay);else if(this._totalTimes--,this._totalTimes>0)e.timer.callLater(this,this.internalPlay);else{this._playing=!1,this._owner.internalVisible--;for(var t=this._items.length,i=0;t>i;i++){var s=this._items[i];null!=s.target&&0!=(this._options&this.OPTION_IGNORE_DISPLAY_CONTROLLER)&&s.target!=this._owner&&s.target.internalVisible--,s.filterCreated&&(s.filterCreated=!1,s.target.filters=null)}if(null!=this._onComplete){var n=this._onComplete;this._onComplete=null,n.run()}}},a.applyValue=function(t,i){switch(t.target._gearLocked=!0,t.type){case 0:if(t.target==this._owner){var s=0,n=0;s=i.b1?i.f1+this._ownerBaseX:t.target.x,n=i.b2?i.f2+this._ownerBaseY:t.target.y,t.target.setXY(s,n)}else i.b1||(i.f1=t.target.x),i.b2||(i.f2=t.target.y),t.target.setXY(i.f1,i.f2);break;case 1:i.b1||(i.f1=t.target.width),i.b2||(i.f2=t.target.height),t.target.setSize(i.f1,i.f2);break;case 3:t.target.setPivot(i.f1,i.f2);break;case 4:t.target.alpha=i.f1;break;case 5:t.target.rotation=i.i;break;case 2:t.target.setScale(i.f1,i.f2);break;case 13:t.target.setSkew(i.f1,i.f2);break;case 6:t.target.color=i.s;break;case 7:i.b1||(i.i=t.target.frame),t.target.frame=i.i,t.target.playing=i.b;break;case 8:t.target.visible=i.b;break;case 10:var r=t.target.getTransition(i.s);null!=r&&(0==i.i?r.stop(!1,!0):r.playing?r._totalTimes=-1==i.i?Number.MAX_VALUE:i.i:(t.completed=!1,this._totalTasks++,this._reversed?r.playReverse(g.create(this,this.__playTransComplete,[t]),t.value.i):r.play(g.create(this,this.__playTransComplete,[t]),t.value.i)));break;case 9:var h=it.getItemByURL(i.s);if(h){var a=h.owner.getItemAsset(h);a&&kt.inst.playOneShotSound(a,i.f1)}break;case 11:t.startValue.f1=0,t.startValue.f2=0,t.startValue.f3=t.value.f2,t.startValue.i=e.timer.currTimer,e.timer.frameLoop(1,t,t.__shake,[this]),this._totalTasks++,t.completed=!1;break;case 12:var o=t.target.filters;o||(o=[]);var u=new nt;u.adjustBrightness(i.f1),u.adjustContrast(i.f2),u.adjustSaturation(i.f3),u.adjustHue(i.f4),o[0]=new l(u),t.target.filters=o}t.target._gearLocked=!1},a.__shakeItem=function(t){var i=Math.ceil(t.value.f1*t.startValue.f3/t.value.f2),s=(2*Math.random()-1)*i,n=(2*Math.random()-1)*i;s=s>0?Math.ceil(s):Math.floor(s),n=n>0?Math.ceil(n):Math.floor(n),t.target._gearLocked=!0,t.target.setXY(t.target.x-t.startValue.f1+s,t.target.y-t.startValue.f2+n),t.target._gearLocked=!1,t.startValue.f1=s,t.startValue.f2=n;var r=e.timer.currTimer;t.startValue.f3-=(r-t.startValue.i)/1e3,t.startValue.i=r,t.startValue.f3<=0&&(t.target._gearLocked=!0,t.target.setXY(t.target.x-t.startValue.f1,t.target.y-t.startValue.f2),t.target._gearLocked=!1,t.completed=!0,this._totalTasks--,e.timer.clear(t,t.__shake),this.checkAllComplete())},a.setup=function(t){this.name=t.getAttribute("name");var i=t.getAttribute("options");i&&(this._options=parseInt(i)),i=t.getAttribute("autoPlay"),i&&(this.autoPlay="true"==i),this.autoPlay&&(i=t.getAttribute("autoPlayRepeat"),i&&(this.autoPlayRepeat=parseInt(i)),i=t.getAttribute("autoPlayDelay"),i&&(this.autoPlayDelay=parseFloat(i)));for(var e=t.childNodes,n=e.length,r=0;n>r;r++){var h=e[r];if("item"==h.nodeName){var a=new s;switch(this._items.push(a),a.time=parseInt(h.getAttribute("time"))/this.FRAME_RATE,a.targetId=h.getAttribute("target"),i=h.getAttribute("type")){case"XY":a.type=0;break;case"Size":a.type=1;break;case"Scale":a.type=2;break;case"Pivot":a.type=3;break;case"Alpha":a.type=4;break;case"Rotation":a.type=5;break;case"Color":a.type=6;break;case"Animation":a.type=7;break;case"Visible":a.type=8;break;case"Sound":a.type=9;break;case"Transition":a.type=10;break;case"Shake":a.type=11;break;case"ColorFilter":a.type=12;break;case"Skew":a.type=13;break;default:a.type=14}if(a.tween="true"==h.getAttribute("tween"),a.label=h.getAttribute("label"),a.tween){a.duration=parseInt(h.getAttribute("duration"))/this.FRAME_RATE,a.time+a.duration>this._maxTime&&(this._maxTime=a.time+a.duration),i=h.getAttribute("ease"),i&&(a.easeType=et.parseEaseType(i)),i=h.getAttribute("repeat"),i&&(a.repeat=parseInt(i)),a.yoyo="true"==h.getAttribute("yoyo"),a.label2=h.getAttribute("label2");var o=h.getAttribute("endValue");o?(this.decodeValue(a.type,h.getAttribute("startValue"),a.startValue),this.decodeValue(a.type,o,a.endValue)):(a.tween=!1,this.decodeValue(a.type,h.getAttribute("startValue"),a.value))}else a.time>this._maxTime&&(this._maxTime=a.time),this.decodeValue(a.type,h.getAttribute("value"),a.value)}}},a.decodeValue=function(t,i,e){var s;switch(t){case 0:case 1:case 3:case 13:s=i.split(","),"-"==s[0]?e.b1=!1:(e.f1=parseFloat(s[0]),e.b1=!0),"-"==s[1]?e.b2=!1:(e.f2=parseFloat(s[1]),e.b2=!0);break;case 4:e.f1=parseFloat(i);break;case 5:e.i=parseInt(i);break;case 2:s=i.split(","),e.f1=parseFloat(s[0]),e.f2=parseFloat(s[1]);break;case 6:e.s=i;break;case 7:s=i.split(","),"-"==s[0]?e.b1=!1:(e.i=parseInt(s[0]),e.b1=!0),e.b="p"==s[1];break;case 8:e.b="true"==i;break;case 9:if(s=i.split(","),e.s=s[0],s.length>1){var n=parseInt(s[1]);0==n||100==n?e.f1=1:e.f1=n/100}else e.f1=1;break;case 10:s=i.split(","),e.s=s[0],s.length>1?e.i=parseInt(s[1]):e.i=1;break;case 11:s=i.split(","),e.f1=parseFloat(s[0]),e.f2=parseFloat(s[1]);break;case 12:s=i.split(","),e.f1=parseFloat(s[0]),e.f2=parseFloat(s[1]),e.f3=parseFloat(s[2]),e.f4=parseFloat(s[3])}},r(0,a,"autoPlay",function(){return this._autoPlay},function(t){this._autoPlay!=t&&(this._autoPlay=t,this._autoPlay?this._owner.onStage&&this.play(null,this.autoPlayRepeat,this.autoPlayDelay):this._owner.onStage||this.stop(!1,!0))}),r(0,a,"playing",function(){return this._playing}),t.__init$=function(){i=function(){function t(){}return n(t,""),t.XY=0,t.Size=1,t.Scale=2,t.Pivot=3,t.Alpha=4,t.Rotation=5,t.Color=6,t.Animation=7,t.Visible=8,t.Sound=9,t.Transition=10,t.Shake=11,t.ColorFilter=12,t.Skew=13,t.Unknown=14,t}(),s=function(){function t(){this.time=0,this.targetId=null,this.type=0,this.duration=0,this.value=null,this.startValue=null,this.endValue=null,this.easeType=null,this.repeat=0,this.yoyo=!1,this.tween=!1,this.label=null,this.label2=null,this.hook=null,this.hook2=null,this.tweenTimes=0,this.tweener=null,this.completed=!1,this.target=null,this.filterCreated=!1,this.easeType=u.quadOut,this.value=new h,this.startValue=new h,this.endValue=new h}n(t,"");var i=t.prototype;return i.__shake=function(t){t.__shakeItem(this)},t}(),h=function(){function t(){this.f1=0,this.f2=0,this.f3=0,this.f4=NaN,this.i=0,this.b=!1,this.s=null,this.b1=!0,this.b2=!0}return n(t,""),t}()},t}(),J=function(){function t(){}return n(t,"fairygui.UIConfig",null,"UIConfig1"),t.defaultFont="",t.windowModalWaiting=null,t.globalModalWaiting=null,t.modalLayerColor="rgba(33,33,33,0.2)",t.buttonSound=null,t.buttonSoundVolumeScale=1,t.horizontalScrollBar=null,t.verticalScrollBar=null,t.defaultScrollSpeed=25,t.defaultScrollBarDisplay=1,t.defaultScrollTouchEffect=!0,t.defaultScrollBounceEffect=!0,t.popupMenu=null,t.popupMenu_seperator=null,t.loaderErrorSign=null,t.tooltipsWin=null,t.defaultComboBoxVisibleItemCount=10,t.touchScrollSensitivity=20,t.touchDragSensitivity=10,t.clickDragSensitivity=2,t.bringWindowToFrontOnClick=!0,t.frameTimeForAsyncUIConstruction=2,t}(),tt=function(){function t(){}return n(t,"fairygui.UIObjectFactory"),t.setPackageItemExtension=function(t,i){fairygui.UIObjectFactory.packageItemExtensions[t.substring(5)]=i},t.setLoaderExtension=function(t){fairygui.UIObjectFactory.loaderExtension=t},t.newObject=function(t){switch(t.type){case 0:return new ft;case 2:return new bt;case 4:var i=fairygui.UIObjectFactory.packageItemExtensions[t.owner.id+t.id];if(i)return new i;var e=t.owner.getItemAsset(t),s=e.getAttribute("extention");if(null==s)return new at;switch(s){case"Button":return new xt;case"Label":return new Ct;case"ProgressBar":return new Pt;case"Slider":return new Tt;case"ScrollBar":return new At;case"ComboBox":return new It;default:return new at}}return null},t.newObject2=function(t){switch(t){case"image":return new ft;case"movieclip":return new bt;case"component":return new at;case"text":return new wt;case"richtext":return new Ot;case"inputtext":return new jt;case"group":return new gt;case"list":return new St;case"graph":return new ct;case"loader":return null!=fairygui.UIObjectFactory.loaderExtension?new fairygui.UIObjectFactory.loaderExtension:new vt}return null},t.packageItemExtensions={},t.loaderExtension=null,t}(),it=function(){function t(){this._id=null,this._name=null,this._basePath=null,this._items=null,this._itemsById=null,this._itemsByName=null,this._resKey=null,this._resData=null,this._customId=null,this._sprites=null,this._items=[],this._sprites={}}var i;n(t,"fairygui.UIPackage");var e=t.prototype;return e.create=function(t){this._resKey=t,this.loadPackage()},e.loadPackage=function(){var t,e;this.decompressPackage(S.inst.getRes(this._resKey+".fui")),t=this.getDesc("sprites.bytes"),e=t.split("\n");for(var s=e.length,n=1;s>n;n++)if(t=e[n]){var r=t.split(" "),h=new i,a=r[0],o=parseInt(r[1]);if(o>=0)h.atlas="atlas"+o;else{var l=a.indexOf("_");-1==l?h.atlas="atlas_"+a:h.atlas="atlas_"+a.substr(0,l)}h.rect.x=parseInt(r[2]),h.rect.y=parseInt(r[3]),h.rect.width=parseInt(r[4]),h.rect.height=parseInt(r[5]),h.rotated="1"==r[6],this._sprites[a]=h}t=this.getDesc("package.xml");var u=C.parseXMLFromString(t),_=u.firstChild;this._id=_.getAttribute("id"),this._name=_.getAttribute("name");var c=et.findChildNode(_,"resources").childNodes;this._itemsById={},this._itemsByName={};for(var d,g,f=c.length,p=0;f>p;p++)if(g=c[p],1==g.nodeType){switch(d=new E,d.type=D.parse(g.nodeName),d.id=g.getAttribute("id"),d.name=g.getAttribute("name"),d.file=g.getAttribute("file"),t=g.getAttribute("size"),t&&(e=t.split(","),d.width=parseInt(e[0]),d.height=parseInt(e[1])),d.type){case 0:t=g.getAttribute("scale"),"9grid"==t?(d.scale9Grid=new laya.maths.Rectangle,t=g.getAttribute("scale9grid"),t&&(e=t.split(","),d.scale9Grid.x=parseInt(e[0]),d.scale9Grid.y=parseInt(e[1]),d.scale9Grid.width=parseInt(e[2]),d.scale9Grid.height=parseInt(e[3]),t=g.getAttribute("gridTile"),t&&(d.tileGridIndice=parseInt(t)))):"tile"==t&&(d.scaleByTile=!0),t=g.getAttribute("smoothing"),d.smoothing="false"!=t}d.owner=this,this._items.push(d),this._itemsById[d.id]=d,null!=d.name&&(this._itemsByName[d.name]=d)}for(s=this._items.length,n=0;s>n;n++)d=this._items[n],6==d.type&&(this.loadFont(d),fairygui.UIPackage._bitmapFonts[d.bitmapFont.id]=d.bitmapFont)},e.decompressPackage=function(t){this._resData={};var i,e=new Zlib.RawInflate(t);i=e.decompress();for(var s,n=new o(i).readUTFBytes(),r=0,h=NaN;;){var a=n.indexOf("|",r);if(-1==a)break;s=n.substring(r,a),r=a+1,a=n.indexOf("|",r),h=parseInt(n.substring(r,a)),r=a+1,this._resData[s]=n.substr(r,h),r+=h}},e.dispose=function(){for(var t=this._items.length,i=0;t>i;i++){var e=this._items[i];e.texture;null!=e.bitmapFont&&delete fairygui.UIPackage._bitmapFonts[e.bitmapFont.id]}},e.createObject=function(t,i){var e=this._itemsByName[t];return e?this.internalCreateObject(e,i):null},e.internalCreateObject=function(t,i){var e;return e=4==t.type&&null!=i?new i:tt.newObject(t),null==e?null:(fairygui.UIPackage._constructing++,e.packageItem=t,e.constructFromResource(),fairygui.UIPackage._constructing--,e)},e.getItemById=function(t){return this._itemsById[t]},e.getItemByName=function(t){return this._itemsByName[t]},e.getItemAssetByName=function(t){var i=this._itemsByName[t];if(null==i)throw"Resource not found -"+t;return this.getItemAsset(i)},e.getItemAsset=function(t){switch(t.type){case 0:if(!t.decoded){t.decoded=!0;var i=this._sprites[t.id];null!=i&&(t.texture=this.createSpriteTexture(i))}return t.texture;case 7:if(!t.decoded){t.decoded=!0;var e=null!=t.file&&t.file.length>0?t.file:t.id+".png";t.texture=S.inst.getRes(this._resKey+"@"+e)}return t.texture;case 3:return t.decoded||(t.decoded=!0,t.sound=S.inst.getRes(this._resKey+"@"+t.id)),t.sound;case 6:return t.decoded||(t.decoded=!0,this.loadFont(t)),t.bitmapFont;case 2:return t.decoded||(t.decoded=!0,this.loadMovieClip(t)),t.frames;case 4:if(!t.decoded){t.decoded=!0;var s=this.getDesc(t.id+".xml"),n=C.parseXMLFromString(s);if(null!=fairygui.UIPackage._stringsSource){var r=fairygui.UIPackage._stringsSource[this.id+t.id];null!=r&&this.translateComponent(n,r)}t.componentData=n.firstChild,this.loadComponentChildren(t)}return t.componentData;default:return S.inst.getRes(this._resKey+"@"+t.id)}},e.getDesc=function(t){return this._resData[t]},e.loadComponentChildren=function(t){var i=et.findChildNode(t.componentData,"displayList");if(null!=i){var e=i.childNodes,s=e.length;t.displayList=h(s);for(var n,r=0;s>r;r++){var a=e[r],o=a.nodeName,l=a.getAttribute("src");if(l){var u,_=a.getAttribute("pkg");u=_&&_!=t.owner.id?fairygui.UIPackage.getById(_):t.owner;var c=null!=u?u.getItemById(l):null;n=null!=c?new F(c,null):new F(null,o)}else n="text"==o&&"true"==a.getAttribute("input")?new F(null,"inputtext"):new F(null,o);n.desc=a,t.displayList[r]=n}}else t.displayList=h(0,null)},e.translateComponent=function(t,i){var e=et.findChildNode(t.firstChild,"displayList");if(null!=e){var s,n,r,h,a,o,l,u,_=e.childNodes,c=_.length,d=NaN,g=NaN,f=NaN,p=NaN;for(g=0;c>g;g++)if(n=_[g],a=n.nodeName,o=n.getAttribute("id"),u=n.getAttribute("tooltips"),u&&(s=i[o+"-tips"],void 0!=s&&n.setAttribute("tooltips",s)),"text"==a||"richtext"==a)s=i[o],void 0!=s&&n.setAttribute("text",s),s=i[o+"-prompt"],void 0!=s&&n.setAttribute("prompt",s);else if("list"==a)for(l=n.childNodes,d=l.length,p=0,f=0;d>f;f++)h=l[f],"item"==h.nodeName&&(s=i[o+"-"+p],void 0!=s&&h.setAttribute("title",s),p++);else if("component"==a)if(r=et.findChildNode(n,"Button"))s=i[o],void 0!=s&&r.setAttribute("title",s),s=i[o+"-0"],void 0!=s&&r.setAttribute("selectedTitle",s);else if(r=et.findChildNode(n,"Label"))s=i[o],void 0!=s&&r.setAttribute("title",s);else if(r=et.findChildNode(n,"ComboBox"))for(s=i[o],void 0!=s&&r.setAttribute("title",s),l=r.childNodes,d=l.length,p=0,f=0;d>f;f++)h=l[f],"item"==h.nodeName&&(s=i[o+"-"+p],void 0!=s&&h.setAttribute("title",s),p++)}},e.createSpriteTexture=function(t){var i=this._itemsById[t.atlas];if(null!=i){var e=this.getItemAsset(i);return null==e?null:this.createSubTexture(e,t.rect)}return null},e.createSubTexture=function(t,i){var e=x.createFromTexture(t,i.x,i.y,i.width,i.height);return e},e.loadMovieClip=function(t){var i,e,s=C.parseXMLFromString(this.getDesc(t.id+".xml")).firstChild;i=s.getAttribute("interval"),i&&(t.interval=parseInt(i)),i=s.getAttribute("swing"),i&&(t.swing="true"==i),i=s.getAttribute("repeatDelay"),i&&(t.repeatDelay=parseInt(i));parseInt(s.getAttribute("frameCount"));t.frames=[];for(var n=et.findChildNode(s,"frames").childNodes,r=0,h=n.length,a=0;h>a;a++){var o=n[a];if("frame"==o.nodeName){var l=new A;if(i=o.getAttribute("rect"),e=i.split(","),l.rect=new y(parseInt(e[0]),parseInt(e[1]),parseInt(e[2]),parseInt(e[3])),i=o.getAttribute("addDelay"),i&&(l.addDelay=parseInt(i)),t.frames[r]=l,0!=l.rect.width){i=o.getAttribute("sprite"),i=i?t.id+"_"+i:t.id+"_"+r;var u=this._sprites[i];null!=u&&(l.texture=this.createSpriteTexture(u)),r++}}}},e.loadFont=function(t){var i=new j;i.id="ui://"+this.id+t.id;var e,s,n=this.getDesc(t.id+".fnt"),r=n.split("\n"),h=r.length,a=0,o={},l=!1,u=0,_=0,c=!1,d=0,g=0,f=0;for(a=0;h>a;a++)if(n=r[a],0!=n.length){n=et.trim(n);for(var p=n.split(" "),m=1;m<p.length;m++){var v=p[m].split("=");o[v[0]]=v[1]}if(n=p[0],"char"==n){var b=new k;b.x=isNaN(o.x)?0:parseInt(o.x),b.y=isNaN(o.y)?0:parseInt(o.y),b.offsetX=isNaN(o.xoffset)?0:parseInt(o.xoffset),b.offsetY=isNaN(o.yoffset)?0:parseInt(o.yoffset),b.width=isNaN(o.width)?0:parseInt(o.width),
b.height=isNaN(o.height)?0:parseInt(o.height),b.advance=isNaN(o.xadvance)?0:parseInt(o.xadvance),void 0!=o.chnl&&(b.channel=parseInt(o.chnl),15==b.channel?b.channel=4:1==b.channel?b.channel=3:2==b.channel?b.channel=2:b.channel=1),l?null!=s&&(b.texture=this.createSubTexture(s,new y(b.x+d,b.y+g,b.width,b.height))):o.img&&(e=this._itemsById[o.img],null!=e&&(e.load(),b.width=e.width,b.height=e.height,b.texture=e.texture)),l?b.lineHeight=f:(0==b.advance&&(0==_?b.advance=b.offsetX+b.width:b.advance=_),b.lineHeight=b.offsetY<0?b.height:b.offsetY+b.height,u>0&&b.lineHeight<u&&(b.lineHeight=u)),i.glyphs[String.fromCharCode(o.id)]=b}else if("info"==n){if(l=null!=o.face,isNaN(o.size)||(u=parseInt(o.size)),c="true"==o.resizable,l){var w=this._sprites[t.id];if(null!=w){d=w.rect.x,g=w.rect.y;var x=this._itemsById[w.atlas];null!=x&&(s=this.getItemAsset(x))}}}else"common"==n&&(isNaN(o.lineHeight)||(f=parseInt(o.lineHeight)),0==u?u=f:0==f&&(f=u),isNaN(o.xadvance)||(_=parseInt(o.xadvance)))}0==u&&b&&(u=b.height),i.ttf=l,i.size=u,i.resizable=c,t.bitmapFont=i},r(0,e,"id",function(){return this._id}),r(0,e,"name",function(){return this._name}),r(0,e,"customId",function(){return this._customId},function(t){null!=this._customId&&delete fairygui.UIPackage._packageInstById[this._customId],this._customId=t,null!=this._customId&&(fairygui.UIPackage._packageInstById[this._customId]=this)}),t.getById=function(t){return fairygui.UIPackage._packageInstById[t]},t.getByName=function(t){return fairygui.UIPackage._packageInstByName[t]},t.addPackage=function(i){var e=new t;return e.create(i),fairygui.UIPackage._packageInstById[e.id]=e,fairygui.UIPackage._packageInstByName[e.name]=e,e.customId=i,e},t.removePackage=function(t){var i=fairygui.UIPackage._packageInstById[t];i.dispose(),delete fairygui.UIPackage._packageInstById[i.id],null!=i._customId&&delete fairygui.UIPackage._packageInstById[i._customId],delete fairygui.UIPackage._packageInstByName[i.name]},t.createObject=function(t,i,e){var s=fairygui.UIPackage.getByName(t);return s?s.createObject(i,e):null},t.createObjectFromURL=function(t,i){var e=fairygui.UIPackage.getItemByURL(t);return e?e.owner.internalCreateObject(e,i):null},t.getItemURL=function(t,i){var e=fairygui.UIPackage.getByName(t);if(!e)return null;var s=e._itemsByName[i];return s?"ui://"+e.id+s.id:null},t.getItemByURL=function(t){if(et.startsWith(t,"ui://")){var i=t.substr(5,8),e=t.substr(13),s=fairygui.UIPackage.getById(i);if(s)return s.getItemById(e)}return null},t.getBitmapFontByURL=function(t){return fairygui.UIPackage._bitmapFonts[t]},t.setStringsSource=function(t){fairygui.UIPackage._stringsSource={};for(var i=C.parseXMLFromString(t),e=et.findChildNode(i,"resources"),s=e.childNodes,n=s.length,r=0;n>r;r++){var h=s[r];if("string"==h.nodeName){var a=h.getAttribute("name"),o=h.textContent,l=a.indexOf("-");if(-1==l)continue;var u=a.substr(0,l),_=a.substr(l+1),c=fairygui.UIPackage._stringsSource[u];c||(c={},fairygui.UIPackage._stringsSource[u]=c),c[_]=o}}},t._constructing=0,t._packageInstById={},t._packageInstByName={},t._bitmapFonts={},t._stringsSource=null,t.sep0=",",t.sep1="\n",t.sep2=" ",t.sep3="=",t.__init$=function(){i=function(){function t(){this.atlas=null,this.rect=null,this.rotated=!1,this.rect=new y}return n(t,""),t}()},t}(),et=function(){function t(){}return n(t,"fairygui.utils.ToolSet"),t.getFileName=function(t){var i=t.lastIndexOf("/");return-1!=i&&(t=t.substr(i+1)),i=t.lastIndexOf("\\"),-1!=i&&(t=t.substr(i+1)),i=t.lastIndexOf("."),-1!=i?t.substring(0,i):t},t.startsWith=function(t,i,e){return void 0===e&&(e=!1),t?t.length<i.length?!1:(t=t.substring(0,i.length),e?t.toLowerCase()==i.toLowerCase():t==i):!1},t.endsWith=function(t,i,e){return void 0===e&&(e=!1),t?t.length<i.length?!1:(t=t.substring(t.length-i.length),e?t.toLowerCase()==i.toLowerCase():t==i):!1},t.trim=function(t){return fairygui.utils.ToolSet.trimLeft(fairygui.utils.ToolSet.trimRight(t))},t.trimLeft=function(t){for(var i="",e=0;e<t.length&&(i=t.charAt(e)," "==i||"\n"==i||"\r"==i);e++);return t.substr(e)},t.trimRight=function(t){for(var i="",e=t.length-1;e>=0&&(i=t.charAt(e)," "==i||"\n"==i||"\r"==i);e--);return t.substring(0,e+1)},t.convertToHtmlColor=function(t,i){void 0===i&&(i=!1);var e;e=i?(t>>24&255).toString(16):"";var s=(t>>16&255).toString(16),n=(t>>8&255).toString(16),r=(255&t).toString(16);return 1==e.length&&(e="0"+e),1==s.length&&(s="0"+s),1==n.length&&(n="0"+n),1==r.length&&(r="0"+r),"#"+e+s+n+r},t.convertFromHtmlColor=function(t,i){return void 0===i&&(i=!1),t.length<1?0:("#"==t.charAt(0)&&(t=t.substr(1)),8==t.length?(parseInt(t.substr(0,2),16)<<24)+parseInt(t.substr(2),16):i?4278190080+parseInt(t,16):parseInt(t,16))},t.displayObjectToGObject=function(t){for(;null!=t&&!(t instanceof laya.display.Stage);){if(t.$owner)return t.$owner;t=t.parent}return null},t.findChildNode=function(t,i){var e=t.childNodes,s=e.length;if(s>0)for(var n=0;s>n;n++){var r=e[n];if(r.nodeName==i)return r}return null},t.encodeHTML=function(t){return t?t.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;").replace("'","&apos;"):""},t.parseUBB=function(t){return fairygui.utils.ToolSet.defaultUBBParser.parse(t)},t.removeUBB=function(t){return fairygui.utils.ToolSet.defaultUBBParser.parse(t,!0)},t.parseEaseType=function(i){var e=t.EaseMap[i];return e||(e=u.quartOut),e},t.clamp=function(t,i,e){return i>t?t=i:t>e&&(t=e),t},t.clamp01=function(t){return t>1?t=1:0>t&&(t=0),t},s(t,["defaultUBBParser",function(){return this.defaultUBBParser=new st},"EaseMap",function(){return this.EaseMap={Linear:u.linearNone,"Elastic.In":u.elasticIn,"Elastic.Out":u.elasticOut,"Elastic.InOut":u.elasticInOut,"Quad.In":u.quadIn,"Quad.Out":u.quadOut,"Quad.InOut":u.quadInOut,"Cube.In":u.cubicIn,"Cube.Out":u.cubicOut,"Cube.InOut":u.cubicInOut,"Quart.In":u.quartIn,"Quart.Out":u.quartOut,"Quart.InOut":u.quartInOut,"Quint.In":u.quintIn,"Quint.Out":u.quintOut,"Quint.InOut":u.quintInOut,"Sine.In":u.sineIn,"Sine.Out":u.sineOut,"Sine.InOut":u.sineInOut,"Bounce.In":u.bounceIn,"Bounce.Out":u.bounceOut,"Bounce.InOut":u.bounceInOut,"Circ.In":u.circIn,"Circ.Out":u.circOut,"Circ.InOut":u.circInOut,"Expo.In":u.quartIn,"Expo.Out":u.quartOut,"Expo.InOut":u.quartInOut,"Back.In":u.backIn,"Back.Out":u.backOut,"Back.InOut":u.backInOut}}]),t}(),st=function(){function t(){this._text=null,this._readPos=0,this._handlers=null,this.smallFontSize=12,this.normalFontSize=14,this.largeFontSize=16,this.defaultImgWidth=0,this.defaultImgHeight=0,this._handlers={},this._handlers.url=this.onTag_URL,this._handlers.img=this.onTag_IMG,this._handlers.b=this.onTag_Simple,this._handlers.i=this.onTag_Simple,this._handlers.u=this.onTag_Simple,this._handlers.sup=this.onTag_Simple,this._handlers.sub=this.onTag_Simple,this._handlers.color=this.onTag_COLOR,this._handlers.font=this.onTag_FONT,this._handlers.size=this.onTag_SIZE}n(t,"fairygui.utils.UBBParser");var i=t.prototype;return i.onTag_URL=function(t,i,e){if(i)return"</a>";if(null!=e)return'<a href="'+e+'" target="_blank">';var s=this.getTagText();return'<a href="'+s+'" target="_blank">'},i.onTag_IMG=function(t,i,e){if(i)return null;var s=this.getTagText(!0);return s?this.defaultImgWidth?'<img src="'+s+'" width="'+this.defaultImgWidth+'" height="'+this.defaultImgHeight+'"/>':'<img src="'+s+'"/>':null},i.onTag_Simple=function(t,i,e){return i?"</"+t+">":"<"+t+">"},i.onTag_COLOR=function(t,i,e){return i?"</font>":'<font color="'+e+'">'},i.onTag_FONT=function(t,i,e){return i?"</font>":'<font face="'+e+'">'},i.onTag_SIZE=function(t,i,e){return i?"</font>":("normal"==e?e=""+this.normalFontSize:"small"==e?e=""+this.smallFontSize:"large"==e?e=""+this.largeFontSize:e.length&&"+"==e.charAt(0)?e=""+(this.smallFontSize+parseInt(e.substr(1))):e.length&&"-"==e.charAt(0)&&(e=""+(this.smallFontSize-parseInt(e.substr(1)))),'<font size="'+e+'">')},i.getTagText=function(t){void 0===t&&(t=!1);var i=this._text.indexOf("[",this._readPos);if(-1==i)return null;var e=this._text.substring(this._readPos,i);return t&&(this._readPos=i),e},i.parse=function(t,i){void 0===i&&(i=!1),this._text=t;for(var e,s,n,r,h=0,a=NaN,o=0,l=!1;-1!=(a=this._text.indexOf("[",h))&&(h=a,a=this._text.indexOf("]",h),-1!=a);)l="/"==this._text.charAt(h+1),e=this._text.substring(l?h+2:h+1,a),a++,this._readPos=a,s=null,n=null,o=e.indexOf("="),-1!=o&&(s=e.substring(o+1),e=e.substring(0,o)),e=e.toLowerCase(),r=this._handlers[e],null!=r?(i?n="":(n=r.call(this,e,l,s),null==n&&(n="")),this._text=this._text.substring(0,h)+n+this._text.substring(this._readPos)):h=a;return this._text},s(t,["inst",function(){return this.inst=new t}]),t}(),nt=function(t){function i(){i.__super.call(this),this.reset()}n(i,"fairygui.utils.ColorMatrix",Array);var e=i.prototype;return e.reset=function(){for(var t=0;t<i.LENGTH;t++)this[t]=i.IDENTITY_MATRIX[t]},e.invert=function(){this.multiplyMatrix([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0])},e.adjustColor=function(t,i,e,s){this.adjustHue(s),this.adjustContrast(i),this.adjustBrightness(t),this.adjustSaturation(e)},e.adjustBrightness=function(t){t=255*this.cleanValue(t,1),this.multiplyMatrix([1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0])},e.adjustContrast=function(t){t=this.cleanValue(t,1);var i=t+1,e=128*(1-i);this.multiplyMatrix([i,0,0,0,e,0,i,0,0,e,0,0,i,0,e,0,0,0,1,0])},e.adjustSaturation=function(t){t=this.cleanValue(t,1),t+=1;var i=1-t,e=.299*i,s=.587*i,n=.114*i;this.multiplyMatrix([e+t,s,n,0,0,e,s+t,n,0,0,e,s,n+t,0,0,0,0,0,1,0])},e.adjustHue=function(t){t=this.cleanValue(t,1),t*=Math.PI;var i=Math.cos(t),e=Math.sin(t);this.multiplyMatrix([.299+i*(1-.299)+e*-.299,.587+i*-.587+e*-.587,.114+i*-.114+.886*e,0,0,.299+i*-.299+.143*e,.587+i*(1-.587)+.14*e,.114+i*-.114+e*-.283,0,0,.299+i*-.299+e*-(1-.299),.587+i*-.587+.587*e,.114+.886*i+.114*e,0,0,0,0,0,1,0])},e.concat=function(t){t.length==i.LENGTH&&this.multiplyMatrix(t)},e.clone=function(){var t=new i;return t.copyMatrix(this),t},e.copyMatrix=function(t){for(var e=i.LENGTH,s=0;e>s;s++)this[s]=t[s]},e.multiplyMatrix=function(t){for(var i=[],e=0,s=0;4>s;++s){for(var n=0;5>n;++n)i[e+n]=t[e]*this[n]+t[e+1]*this[n+5]+t[e+2]*this[n+10]+t[e+3]*this[n+15]+(4==n?t[e+4]:0);e+=5}this.copyMatrix(i)},e.cleanValue=function(t,i){return Math.min(i,Math.max(-i,t))},i.create=function(t,e,s,n){var r=new i;return r.adjustColor(t,e,s,n),r},i.LUMA_R=.299,i.LUMA_G=.587,i.LUMA_B=.114,s(i,["IDENTITY_MATRIX",function(){return this.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]},"LENGTH",function(){return this.LENGTH=i.IDENTITY_MATRIX.length}]),i}(Array),rt=function(t){function i(){this._name=null,this._selectedIndex=0,this._previousIndex=0,this._pageIds=null,this._pageNames=null,this._pageTransitions=null,this._playingTransition=null,this._parent=null,this._autoRadioGroupDepth=!1,i.__super.call(this),this._pageIds=[],this._pageNames=[],this._selectedIndex=-1,this._previousIndex=-1}var e;n(i,"fairygui.Controller",t);var s=i.prototype;return s.setSelectedIndex=function(t){if(void 0===t&&(t=0),this._selectedIndex!=t){if(t>this._pageIds.length-1)throw"index out of bounds: "+t;this._previousIndex=this._selectedIndex,this._selectedIndex=t,this._parent.applyController(this),this._playingTransition&&(this._playingTransition.stop(),this._playingTransition=null)}},s.setSelectedPage=function(t){var i=this._pageNames.indexOf(t);-1==i&&(i=0),this.setSelectedIndex(i)},s.getPageName=function(t){return void 0===t&&(t=0),this._pageNames[t]},s.addPage=function(t){void 0===t&&(t=""),this.addPageAt(t,this._pageIds.length)},s.addPageAt=function(t,i){void 0===i&&(i=0);var e=""+fairygui.Controller._nextPageId++;i==this._pageIds.length?(this._pageIds.push(e),this._pageNames.push(t)):(this._pageIds.splice(i,0,e),this._pageNames.splice(i,0,t))},s.removePage=function(t){var i=this._pageNames.indexOf(t);-1!=i&&(this._pageIds.splice(i,1),this._pageNames.splice(i,1),this._selectedIndex>=this._pageIds.length?this.selectedIndex=this._selectedIndex-1:this._parent.applyController(this))},s.removePageAt=function(t){void 0===t&&(t=0),this._pageIds.splice(t,1),this._pageNames.splice(t,1),this._selectedIndex>=this._pageIds.length?this.selectedIndex=this._selectedIndex-1:this._parent.applyController(this)},s.clearPages=function(){this._pageIds.length=0,this._pageNames.length=0,-1!=this._selectedIndex?this.selectedIndex=-1:this._parent.applyController(this)},s.hasPage=function(t){return-1!=this._pageNames.indexOf(t)},s.getPageIndexById=function(t){return this._pageIds.indexOf(t)},s.getPageIdByName=function(t){var i=this._pageNames.indexOf(t);return-1!=i?this._pageIds[i]:null},s.getPageNameById=function(t){var i=this._pageIds.indexOf(t);return-1!=i?this._pageNames[i]:null},s.getPageId=function(t){return void 0===t&&(t=0),this._pageIds[t]},s.setup=function(t){this._name=t.getAttribute("name"),this._autoRadioGroupDepth="true"==t.getAttribute("autoRadioGroupDepth");var i=0,s=0,n=t.getAttribute("pages");if(n){var r=n.split(","),h=r.length;for(i=0;h>i;i+=2)this._pageIds.push(r[i]),this._pageNames.push(r[i+1])}if(n=t.getAttribute("transitions"))for(this._pageTransitions=[],r=n.split(","),h=r.length,i=0;h>i;i++)if(n=r[i]){var a=new e;s=n.indexOf("="),a.transitionName=n.substr(s+1),n=n.substring(0,s),s=n.indexOf("-"),a.toIndex=parseInt(n.substring(s+1)),n=n.substring(0,s),"*"==n?a.fromIndex=-1:a.fromIndex=parseInt(n),this._pageTransitions.push(a)}this._parent&&this._pageIds.length>0?this._selectedIndex=0:this._selectedIndex=-1},r(0,s,"oppositePageId",null,function(t){var i=this._pageIds.indexOf(t);i>0?this.selectedIndex=0:this._pageIds.length>1&&(this.selectedIndex=1)}),r(0,s,"name",function(){return this._name},function(t){this._name=t}),r(0,s,"pageCount",function(){return this._pageIds.length}),r(0,s,"parent",function(){return this._parent}),r(0,s,"selectedIndex",function(){return this._selectedIndex},function(t){if(this._selectedIndex!=t){if(t>this._pageIds.length-1)throw"index out of bounds: "+t;if(this._previousIndex=this._selectedIndex,this._selectedIndex=t,this._parent.applyController(this),this.event("fui_state_changed"),this._playingTransition&&(this._playingTransition.stop(),this._playingTransition=null),this._pageTransitions){for(var i=this._pageTransitions.length,e=0;i>e;e++){var s=this._pageTransitions[e];if(s.toIndex==this._selectedIndex&&(-1==s.fromIndex||s.fromIndex==this._previousIndex)){this._playingTransition=this.parent.getTransition(s.transitionName);break}}this._playingTransition&&this._playingTransition.play(g.create(this,function(){this._playingTransition=null}))}}}),r(0,s,"selectedPage",function(){return-1==this._selectedIndex?null:this._pageNames[this._selectedIndex]},function(t){var i=this._pageNames.indexOf(t);-1==i&&(i=0),this.selectedIndex=i}),r(0,s,"previsousIndex",function(){return this._previousIndex}),r(0,s,"previousPage",function(){return-1==this._previousIndex?null:this._pageNames[this._previousIndex]}),r(0,s,"selectedPageId",function(){return-1==this._selectedIndex?null:this._pageIds[this._selectedIndex]},function(t){var i=this._pageIds.indexOf(t);this.selectedIndex=i}),r(0,s,"previousPageId",function(){return-1==this._previousIndex?null:this._pageIds[this._previousIndex]}),i._nextPageId=0,i.__init$=function(){e=function(){function t(){this.transitionName=null,this.fromIndex=0,this.toIndex=0}return n(t,""),t}()},i}(c),ht=function(t){function i(){this._gearColor=null,i.__super.call(this),this._gearColor=new lt(this)}n(i,"fairygui.GTextField",t);var s=i.prototype;return e.imps(s,{"fairygui.IColorGear":!0}),s.handleControllerChanged=function(i){t.prototype.handleControllerChanged.call(this,i),this._gearColor.controller==i&&this._gearColor.apply()},s.setup_beforeAdd=function(i){t.prototype.setup_beforeAdd.call(this,i);var e;e=i.getAttribute("font"),e&&(this.font=e),e=i.getAttribute("fontSize"),e&&(this.fontSize=parseInt(e)),e=i.getAttribute("color"),e&&(this.color=e),e=i.getAttribute("align"),e&&(this.align=e),e=i.getAttribute("vAlign"),e&&(this.valign=e),e=i.getAttribute("leading"),e?this.leading=parseInt(e):this.leading=3,e=i.getAttribute("letterSpacing"),e&&(this.letterSpacing=parseInt(e)),this.ubbEnabled="true"==i.getAttribute("ubb"),this.italic="true"==i.getAttribute("italic"),this.bold="true"==i.getAttribute("bold"),this.underline="true"==i.getAttribute("underline"),this.singleLine="true"==i.getAttribute("singleLine"),e=i.getAttribute("strokeColor"),e&&(this.strokeColor=e,e=i.getAttribute("strokeSize"),e?this.stroke=parseInt(e)+1:this.stroke=2)},s.setup_afterAdd=function(i){t.prototype.setup_afterAdd.call(this,i);var e=i.getAttribute("text");null!=e&&e.length>0&&(this.text=e)},r(0,s,"color",function(){return null},function(t){}),r(0,s,"font",function(){return null},function(t){}),r(0,s,"leading",function(){return 0},function(t){}),r(0,s,"fontSize",function(){return 0},function(t){}),r(0,s,"bold",function(){return!1},function(t){}),r(0,s,"letterSpacing",function(){return 0},function(t){}),r(0,s,"align",function(){return null},function(t){}),r(0,s,"valign",function(){return null},function(t){}),r(0,s,"italic",function(){return!1},function(t){}),r(0,s,"underline",function(){return!1},function(t){}),r(0,s,"singleLine",function(){return!1},function(t){}),r(0,s,"stroke",function(){return 0},function(t){}),r(0,s,"strokeColor",function(){return null},function(t){}),r(0,s,"ubbEnabled",function(){return!1},function(t){}),r(0,s,"textWidth",function(){return 0}),r(0,s,"gearColor",function(){return this._gearColor}),i}(M),at=function(t){function i(){this._sortingChildCount=0,this._opaque=!1,this._margin=null,this._trackBounds=!1,this._boundsChanged=!1,this._buildingDisplayList=!1,this._children=null,this._controllers=null,this._transitions=null,this._container=null,this._scrollPane=null,this._alignOffset=null,i.__super.call(this),this._children=[],this._controllers=[],this._transitions=[],this._margin=new R,this._alignOffset=new m}n(i,"fairygui.GComponent",t);var s=i.prototype;return s.createDisplayObject=function(){t.prototype.createDisplayObject.call(this),this._displayObject.mouseEnabled=!0,this._displayObject.mouseThrough=!0,this._container=this._displayObject},s.dispose=function(){var i=0,e=this._transitions.length;for(i=0;e>i;++i){var s=this._transitions[i];s.dispose()}var n=this._children.length;for(i=n-1;i>=0;--i){var r=this._children[i];r.parent=null,r.dispose()}this._boundsChanged=!1,t.prototype.dispose.call(this)},s.addChild=function(t){return this.addChildAt(t,this._children.length),t},s.addChildAt=function(t,i){if(void 0===i&&(i=0),!t)throw"child is null";var e=this._children.length;if(i>=0&&e>=i){if(t.parent==this)this.setChildIndex(t,i);else{t.removeFromParent(),t.parent=this;var s=this._children.length;0!=t.sortingOrder?(this._sortingChildCount++,i=this.getInsertPosForSortingChild(t)):this._sortingChildCount>0&&i>s-this._sortingChildCount&&(i=s-this._sortingChildCount),i==s?this._children.push(t):this._children.splice(i,0,t),this.childStateChanged(t),this.setBoundsChangedFlag()}return t}throw"Invalid child index"},s.getInsertPosForSortingChild=function(t){var i=this._children.length,e=0;for(e=0;i>e;e++){var s=this._children[e];if(s!=t&&t.sortingOrder<s.sortingOrder)break}return e},s.removeChild=function(t,i){void 0===i&&(i=!1);var e=this._children.indexOf(t);return-1!=e&&this.removeChildAt(e,i),t},s.removeChildAt=function(t,i){if(void 0===i&&(i=!1),t>=0&&t<this.numChildren){var e=this._children[t];return e.parent=null,0!=e.sortingOrder&&this._sortingChildCount--,this._children.splice(t,1),e.inContainer&&this._container.removeChild(e.displayObject),i&&e.dispose(),this.setBoundsChangedFlag(),e}throw"Invalid child index"},s.removeChildren=function(t,i,e){void 0===t&&(t=0),void 0===i&&(i=-1),void 0===e&&(e=!1),(0>i||i>=this.numChildren)&&(i=this.numChildren-1);for(var s=t;i>=s;++s)this.removeChildAt(t,e)},s.getChildAt=function(t){if(void 0===t&&(t=0),t>=0&&t<this.numChildren)return this._children[t];throw"Invalid child index"},s.getChild=function(t){for(var i=this._children.length,e=0;i>e;++e)if(this._children[e].name==t)return this._children[e];return null},s.getVisibleChild=function(t){for(var i=this._children.length,e=0;i>e;++e){var s=this._children[e];if(s.finalVisible&&s.name==t)return s}return null},s.getChildInGroup=function(t,i){for(var e=this._children.length,s=0;e>s;++s){var n=this._children[s];if(n.group==i&&n.name==t)return n}return null},s.getChildById=function(t){for(var i=this._children.length,e=0;i>e;++e)if(this._children[e]._id==t)return this._children[e];return null},s.getChildIndex=function(t){return this._children.indexOf(t)},s.setChildIndex=function(t,i){void 0===i&&(i=0);var e=this._children.indexOf(t);if(-1==e)throw"Not a child of this container";if(0==t.sortingOrder){var s=this._children.length;this._sortingChildCount>0&&i>s-this._sortingChildCount-1&&(i=s-this._sortingChildCount-1),this._setChildIndex(t,e,i)}},s.setChildIndexBefore=function(t,i){var e=this._children.indexOf(t);if(-1==e)throw"Not a child of this container";if(0!=t.sortingOrder)return e;var s=this._children.length;return this._sortingChildCount>0&&i>s-this._sortingChildCount-1&&(i=s-this._sortingChildCount-1),i>e?this._setChildIndex(t,e,i-1):this._setChildIndex(t,e,i)},s._setChildIndex=function(t,i,e){var s=this._children.length;if(e>s&&(e=s),i==e)return i;if(this._children.splice(i,1),this._children.splice(e,0,t),t.inContainer){for(var n=0,r=0;e>r;r++){var h=this._children[r];h.inContainer&&n++}n==this._container.numChildren&&n--,this._container.setChildIndex(t.displayObject,n),this.setBoundsChangedFlag()}return e},s.swapChildren=function(t,i){var e=this._children.indexOf(t),s=this._children.indexOf(i);if(-1==e||-1==s)throw"Not a child of this container";this.swapChildrenAt(e,s)},s.swapChildrenAt=function(t,i){void 0===i&&(i=0);var e=this._children[t],s=this._children[i];this.setChildIndex(e,i),this.setChildIndex(s,t)},s.isAncestorOf=function(t){if(null==t)return!1;for(var i=t.parent;i;){if(i==this)return!0;i=i.parent}return!1},s.addController=function(t){this._controllers.push(t),t._parent=this,this.applyController(t)},s.getControllerAt=function(t){return this._controllers[t]},s.getController=function(t){for(var i=this._controllers.length,e=0;i>e;++e){var s=this._controllers[e];if(s.name==t)return s}return null},s.removeController=function(t){var i=this._controllers.indexOf(t);if(-1==i)throw new Error("controller not exists");t._parent=null,this._controllers.splice(i,1);for(var e=this._children.length,s=0;e>s;s++){var n=this._children[s];n.handleControllerChanged(t)}},s.childStateChanged=function(t){if(!this._buildingDisplayList)if(t instanceof fairygui.GGroup)for(var i=this._children.length,e=0;i>e;e++){var s=this._children[e];s.group==t&&this.childStateChanged(s)}else if(t.displayObject)if(t.finalVisible&&t.displayObject!=this._displayObject.mask){if(!t.displayObject.parent){for(var n=0,r=this._children.length,h=0;r>h&&(s=this._children[h],s!=t);h++)s.displayObject&&s.displayObject.parent&&n++;this._container.addChildAt(t.displayObject,n)}}else t.displayObject.parent&&this._container.removeChild(t.displayObject)},s.applyController=function(t){for(var i,e=this._children.length,s=0;e>s;s++)i=this._children[s],i.handleControllerChanged(t)},s.applyAllControllers=function(){for(var t=this._controllers.length,i=0;t>i;++i)this.applyController(this._controllers[i])},s.adjustRadioGroupDepth=function(t,i){var e,s=this._children.length,n=NaN,r=-1,h=-1;for(n=0;s>n;n++)e=this._children[n],e==t?r=n:e instanceof fairygui.GButton&&e.relatedController==i&&n>h&&(h=n);h>r&&this.swapChildrenAt(r,h)},s.getTransitionAt=function(t){return this._transitions[t]},s.getTransition=function(t){for(var i=this._transitions.length,e=0;i>e;++e){var s=this._transitions[e];if(s.name==t)return s}return null},s.isChildInView=function(t){return null!=this._displayObject.scrollRect?t.x+t.width>=0&&t.x<=this.width&&t.y+t.height>=0&&t.y<=this.height:null!=this._scrollPane?this._scrollPane.isChildInView(t):!0},s.getFirstChildInView=function(){for(var t=this._children.length,i=0;t>i;++i){var e=this._children[i];if(this.isChildInView(e))return i}return-1},s.updateOpaque=function(){this._displayObject.hitArea||(this._displayObject.hitArea=new y),this._displayObject.hitArea.setTo(0,0,this.width,this.height)},s.updateMask=function(){var t=this._displayObject.scrollRect;null==t&&(t=new y),t.x=this._margin.left,t.y=this._margin.top,t.width=this.width-this._margin.right,t.height=this.height-this._margin.bottom,this._displayObject.scrollRect=t},s.setupScroll=function(t,i,e,s,n,r){this._displayObject==this._container&&(this._container=new b,this._displayObject.addChild(this._container)),this._scrollPane=new K(this,i,t,e,s,n,r)},s.setupOverflow=function(t){1==t?(this._displayObject==this._container&&(this._container=new b,this._displayObject.addChild(this._container)),this.updateMask(),this._container.pos(this._margin.left,this._margin.top)):0==this._margin.left&&0==this._margin.top||(this._displayObject==this._container&&(this._container=new b,this._displayObject.addChild(this._container)),this._container.pos(this._margin.left,this._margin.top))},s.handleSizeChanged=function(){t.prototype.handleSizeChanged.call(this),this._scrollPane?this._scrollPane.onOwnerSizeChanged():null!=this._displayObject.scrollRect&&this.updateMask(),this._opaque&&this.updateOpaque()},s.handleGrayedChanged=function(){var t=this.getController("grayed");if(null!=t)return void(t.selectedIndex=this.grayed?1:0);for(var i=this.grayed,e=this._children.length,s=0;e>s;++s)this._children[s].grayed=i},s.setBoundsChangedFlag=function(){(this._scrollPane||this._trackBounds)&&(this._boundsChanged||(this._boundsChanged=!0,e.timer.callLater(this,this.__render)))},s.__render=function(){this._boundsChanged&&this.updateBounds()},s.ensureBoundsCorrect=function(){this._boundsChanged&&this.updateBounds()},s.updateBounds=function(){var t=0,i=0,e=0,s=0,n=this._children.length;if(n>0){t=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY;var r=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY,a=0,o=0;for(o=0;n>o;o++)l=this._children[o],l.ensureSizeCorrect();for(o=0;n>o;o++){var l=this._children[o];a=l.x,t>a&&(t=a),a=l.y,i>a&&(i=a),a=l.x+l.actualWidth,a>r&&(r=a),a=l.y+l.actualHeight,a>h&&(h=a)}e=r-t,s=h-i}this.setBounds(t,i,e,s)},s.setBounds=function(t,i,e,s){this._boundsChanged=!1,this._scrollPane&&this._scrollPane.setContentSize(Math.round(t+e),Math.round(i+s))},s.getSnappingPosition=function(t,i,e){e||(e=new m);var s=this._children.length;if(0==s)return e.x=0,e.y=0,e;this.ensureBoundsCorrect();var n=null,r=null,h=0;if(0!=i){for(;s>h;h++)if(n=this._children[h],i<n.y){if(0==h){i=0;break}r=this._children[h-1],i=i<r.y+r.actualHeight/2?r.y:n.y;break}h==s&&(i=n.y)}if(0!=t){for(h>0&&h--;s>h;h++)if(n=this._children[h],t<n.x){if(0==h){t=0;break}r=this._children[h-1],t=t<r.x+r.actualWidth/2?r.x:n.x;break}h==s&&(t=n.x)}return e.x=t,e.y=i,e},s.childSortingOrderChanged=function(t,i,e){if(void 0===e&&(e=0),0==e)this._sortingChildCount--,this.setChildIndex(t,this._children.length);else{0==i&&this._sortingChildCount++;var s=this._children.indexOf(t),n=this.getInsertPosForSortingChild(t);n>s?this._setChildIndex(t,s,n-1):this._setChildIndex(t,s,n)}},s.constructFromResource=function(){this.constructFromResource2(null,0)},s.constructFromResource2=function(t,i){var e=this.packageItem.owner.getItemAsset(this.packageItem);this._underConstruct=!0;var s,n;s=e.getAttribute("size"),n=s.split(","),this._sourceWidth=parseInt(n[0]),this._sourceHeight=parseInt(n[1]),this._initWidth=this._sourceWidth,this._initHeight=this._sourceHeight,this.setSize(this._sourceWidth,this._sourceHeight),s=e.getAttribute("pivot"),s&&(n=s.split(","),s=e.getAttribute("anchor"),this.internalSetPivot(parseFloat(n[0]),parseFloat(n[1]),"true"==s)),s=e.getAttribute("opaque"),this.opaque="false"!=s;var r=0;if(s=e.getAttribute("overflow"),r=s?V.parse(s):0,s=e.getAttribute("margin"),s&&this._margin.parse(s),2==r){var h=0;s=e.getAttribute("scroll"),h=s?Q.parse(s):1;var a=0;s=e.getAttribute("scrollBar"),a=s?$.parse(s):0;var o=NaN;s=e.getAttribute("scrollBarFlags"),o=s?parseInt(s):0;var l=new R;s=e.getAttribute("scrollBarMargin"),s&&l.parse(s);var u,_;s=e.getAttribute("scrollBarRes"),s&&(n=s.split(","),u=n[0],_=n[1]),this.setupScroll(l,h,a,o,u,_)}else this.setupOverflow(r);this._buildingDisplayList=!0;var c=e.childNodes,d=0;c&&(d=c.length);var g,f=0;for(f=0;d>f;f++){var p=c[f];"controller"==p.nodeName&&(g=new rt,this._controllers.push(g),g._parent=this,g.setup(p))}var m,y=this.packageItem.displayList,v=y.length;for(f=0;v>f;f++){var b=y[f];null!=t?m=t[i+f]:b.packageItem?(m=tt.newObject(b.packageItem),m.packageItem=b.packageItem,m.constructFromResource()):m=tt.newObject2(b.type),m._underConstruct=!0,m.setup_beforeAdd(b.desc),m.parent=this,this._children.push(m)}for(this.relations.setup(e),f=0;v>f;f++)this._children[f].relations.setup(y[f].desc);for(f=0;v>f;f++)m=this._children[f],m.setup_afterAdd(y[f].desc),m._underConstruct=!1;s=e.getAttribute("mask"),s&&(this.mask=this.getChildById(s).displayObject);var w;for(f=0;d>f;f++)p=c[f],"transition"==p.nodeName&&(w=new Z(this),this._transitions.push(w),w.setup(p));this._transitions.length>0&&(this.displayObject.on("display",this,this.___added),this.displayObject.on("undisplay",this,this.___removed)),this.applyAllControllers(),this._buildingDisplayList=!1,this._underConstruct=!1,d=this._children.length;var x=this._displayObject.mask;for(f=0;d>f;f++)m=this._children[f],null!=m.displayObject&&m.displayObject!=x&&m.finalVisible&&this._container.addChild(m.displayObject);this.setBoundsChangedFlag(),this.constructFromXML(e)},s.constructFromXML=function(t){},s.___added=function(){for(var t=this._transitions.length,i=0;t>i;++i){var e=this._transitions[i];e.autoPlay&&e.play(null,e.autoPlayRepeat,e.autoPlayDelay)}},s.___removed=function(){for(var t=this._transitions.length,i=0;t>i;++i){var e=this._transitions[i];e.stop(!1,!1)}},r(0,s,"viewWidth",function(){return null!=this._scrollPane?this._scrollPane.viewWidth:this.width-this._margin.left-this._margin.right},function(t){null!=this._scrollPane?this._scrollPane.viewWidth=t:this.width=t+this._margin.left+this._margin.right}),r(0,s,"numChildren",function(){return this._children.length}),r(0,s,"displayListContainer",function(){return this._container}),r(0,s,"opaque",function(){return this._opaque},function(t){this._opaque!=t&&(this._opaque=t,this._opaque?(this.updateOpaque(),this._displayObject.mouseThrough=!1):(this._displayObject.hitArea=null,this._displayObject.mouseThrough=!0))}),r(0,s,"controllers",function(){return this._controllers}),r(0,s,"scrollPane",function(){return this._scrollPane}),r(0,s,"viewHeight",function(){return null!=this._scrollPane?this._scrollPane.viewHeight:this.height-this._margin.top-this._margin.bottom},function(t){null!=this._scrollPane?this._scrollPane.viewHeight=t:this.height=t+this._margin.top+this._margin.bottom}),r(0,s,"margin",function(){return this._margin},function(t){this._margin.copy(t),null!=this._displayObject.scrollRect&&this._container.pos(this._margin.left+this._alignOffset.x,this._margin.top+this._alignOffset.y),this.handleSizeChanged()}),r(0,s,"mask",function(){return this._displayObject.mask},function(t){this._displayObject.mask=t}),i}(M),ot=function(t){function i(t){this._storage=null,this._default=null,i.__super.call(this,t)}var e;n(i,"fairygui.GearAnimation",t);var s=i.prototype;return s.init=function(){this._default=new e(this._owner.playing,this._owner.frame),this._storage={}},s.addStatus=function(t,i){if("-"!=i){var s;null==t?s=this._default:(s=new e,this._storage[t]=s);var n=i.split(",");s.frame=parseInt(n[0]),s.playing="p"==n[1]}},s.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];t||(t=this._default),this._owner.frame=t.frame,this._owner.playing=t.playing,this._owner._gearLocked=!1},s.updateState=function(){if(null!=this._controller&&!this._owner._gearLocked&&!this._owner._underConstruct){var t=this._owner,i=this._storage[this._controller.selectedPageId];i||(i=new e,this._storage[this._controller.selectedPageId]=i),i.frame=t.frame,i.playing=t.playing;
}},i.__init$=function(){e=function(){function t(t,i){this.playing=!1,this.frame=NaN,void 0===t&&(t=!0),void 0===i&&(i=0),this.playing=t,this.frame=i}return n(t,""),t}()},i}(H),lt=function(t){function i(t){this._storage=null,this._default=null,i.__super.call(this,t)}n(i,"fairygui.GearColor",t);var e=i.prototype;return e.init=function(){this._default=this._owner.color,this._storage={}},e.addStatus=function(t,i){"-"!=i&&(null==t?this._default=i:this._storage[t]=i)},e.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];void 0!=t?this._owner.color=t:this._owner.color=this._default,this._owner._gearLocked=!1},e.updateState=function(){null==this._controller||this._owner._gearLocked||this._owner._underConstruct||(this._storage[this._controller.selectedPageId]=this._owner.color)},i}(H),ut=function(t){function i(t){this.pages=null,i.__super.call(this,t)}n(i,"fairygui.GearDisplay",t);var e=i.prototype;return e.init=function(){this.pages=null},e.apply=function(){this._controller&&null!=this.pages&&0!=this.pages.length&&-1==this.pages.indexOf(this._controller.selectedPageId)?this._owner.internalVisible=0:this._owner.internalVisible++},i}(H),_t=function(t){function i(t){this._storage=null,this._default=null,i.__super.call(this,t)}n(i,"fairygui.GearIcon",t);var e=i.prototype;return e.init=function(){this._default=this._owner.icon,this._storage={}},e.addStatus=function(t,i){null==t?this._default=i:this._storage[t]=i},e.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];void 0!=t?this._owner.icon=String(t):this._owner.icon=this._default,this._owner._gearLocked=!1},e.updateState=function(){null==this._controller||this._owner._gearLocked||this._owner._underConstruct||(this._storage[this._controller.selectedPageId]=this._owner.icon)},i}(H),ct=function(t){function i(){this._type=NaN,this._lineSize=NaN,this._lineColor=null,this._fillColor=null,i.__super.call(this),this._type=0,this._lineSize=1,this._lineColor="#000000",this._fillColor="#FFFFFF"}n(i,"fairygui.GGraph",t);var e=i.prototype;return e.drawRect=function(t,i,e){this._type=1,this._lineSize=t,this._lineColor=i,this._fillColor=e,this.drawCommon()},e.drawEllipse=function(t,i,e){this._type=2,this._lineSize=t,this._lineColor=i,this._fillColor=e,this.drawCommon()},e.drawCommon=function(){this._displayObject.mouseEnabled=this.touchable;var t=this._displayObject.graphics;t.clear();var i=this.width,e=this.height;if(0!=i&&0!=e){var s=this._fillColor,n=this._lineColor;if(v.isWebGL&&et.startsWith(s,"rgba")){var r=s.substring(5,s.lastIndexOf(")")).split(","),h=parseFloat(r[3]);0==h?s=null:(s=C.toHexColor((parseInt(r[0])<<16)+(parseInt(r[1])<<8)+parseInt(r[2])),this.alpha=h)}1==this._type?t.drawRect(0,0,i,e,s,this._lineSize>0?n:null,this._lineSize):t.drawCircle(i/2,e/2,i/2,s,this._lineSize>0?n:null,this._lineSize),this._displayObject.repaint()}},e.replaceMe=function(t){if(!this._parent)throw"parent not set";t.name=this.name,t.alpha=this.alpha,t.rotation=this.rotation,t.visible=this.visible,t.touchable=this.touchable,t.grayed=this.grayed,t.setXY(this.x,this.y),t.setSize(this.width,this.height);var i=this._parent.getChildIndex(this);this._parent.addChildAt(t,i),t.relations.copyFrom(this.relations),this._parent.removeChild(this,!0)},e.addBeforeMe=function(t){if(null==this._parent)throw"parent not set";var i=this._parent.getChildIndex(this);this._parent.addChildAt(t,i)},e.addAfterMe=function(t){if(null==this._parent)throw"parent not set";var i=this._parent.getChildIndex(this);i++,this._parent.addChildAt(t,i)},e.setNativeObject=function(t){this._type=0,this._displayObject.mouseEnabled=this.touchable,this._displayObject.graphics.clear(),this._displayObject.addChild(t)},e.createDisplayObject=function(){t.prototype.createDisplayObject.call(this),this._displayObject.mouseEnabled=!1},e.handleSizeChanged=function(){t.prototype.handleSizeChanged.call(this),0!=this._type&&this.drawCommon()},e.setup_beforeAdd=function(i){t.prototype.setup_beforeAdd.call(this,i);var e=i.getAttribute("type");if(e&&"empty"!=e){var s;if(s=i.getAttribute("lineSize"),s&&(this._lineSize=parseInt(s)),s=i.getAttribute("lineColor")){var n=et.convertFromHtmlColor(s,!0),r=(n>>24&255)/255;1!=r?this._lineColor="rgba("+(n>>16&255)+","+(n>>8&255)+","+(255&n)+","+r+")":this._lineColor=C.toHexColor(16777215&n)}s=i.getAttribute("fillColor"),s&&(n=et.convertFromHtmlColor(s,!0),r=(n>>24&255)/255,1!=r?this._fillColor="rgba("+(n>>16&255)+","+(n>>8&255)+","+(255&n)+","+r+")":this._fillColor=C.toHexColor(16777215&n)),"rect"==e?this._type=1:this._type=2,this.drawCommon()}},i}(M),dt=function(t){function i(t){this.tweener=null,this._storage=null,this._default=null,this._tweenValue=null,this._tweenTarget=null,i.__super.call(this,t)}var e;n(i,"fairygui.GearLook",t);var s=i.prototype;return s.init=function(){this._default=new e(this._owner.alpha,this._owner.rotation,this._owner.grayed),this._storage={}},s.addStatus=function(t,i){if("-"!=i){var s,n=i.split(",");null==t?s=this._default:(s=new e,this._storage[t]=s),s.alpha=parseFloat(n[0]),s.rotation=parseInt(n[1]),s.grayed="1"==n[2]}},s.apply=function(){var t=this._storage[this._controller.selectedPageId];if(t||(t=this._default),!this._tween||it._constructing||H.disableAllTweenEffect)this._owner._gearLocked=!0,this._owner.grayed=t.grayed,this._owner.alpha=t.alpha,this._owner.rotation=t.rotation,this._owner._gearLocked=!1;else{if(this._owner._gearLocked=!0,this._owner.grayed=t.grayed,this._owner._gearLocked=!1,null!=this.tweener){if(this._tweenTarget.alpha==t.alpha&&this._tweenTarget.rotation==t.rotation)return;this.tweener.complete(),this.tweener=null}var i=t.alpha!=this._owner.alpha,e=t.rotation!=this._owner.rotation;(i||e)&&(this._owner.internalVisible++,this._tweenTarget=t,null==this._tweenValue&&(this._tweenValue=new m),this._tweenValue.x=this._owner.alpha,this._tweenValue.y=this._owner.rotation,this.tweener=I.to(this._tweenValue,{x:t.alpha,y:t.rotation},1e3*this._tweenTime,this._easeType,g.create(this,this.__tweenComplete),1e3*this._delay),this.tweener.update=g.create(this,this.__tweenUpdate,[i,e],!1))}},s.__tweenUpdate=function(t,i){this._owner._gearLocked=!0,t&&(this._owner.alpha=this._tweenValue.x),i&&(this._owner.rotation=this._tweenValue.y),this._owner._gearLocked=!1},s.__tweenComplete=function(){this._owner.internalVisible--,this.tweener=null},s.updateState=function(){if(null!=this._controller&&!this._owner._gearLocked&&!this._owner._underConstruct){var t=this._storage[this._controller.selectedPageId];t||(t=new e,this._storage[this._controller.selectedPageId]=t),t.alpha=this._owner.alpha,t.rotation=this._owner.rotation,t.grayed=this._owner.grayed}},i.__init$=function(){e=function(){function t(t,i,e){this.alpha=NaN,this.rotation=NaN,this.grayed=!1,void 0===t&&(t=0),void 0===i&&(i=0),void 0===e&&(e=!1),this.alpha=t,this.rotation=i,this.grayed=e}return n(t,""),t}()},i}(H),gt=function(t){function i(){this._updating=!1,this._empty=!1,i.__super.call(this)}n(i,"fairygui.GGroup",t);var e=i.prototype;return e.updateBounds=function(){if(!this._updating&&this.parent){var t,i=this._parent.numChildren,e=0,s=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY,a=0;for(this._empty=!0,e=0;i>e;e++)t=this._parent.getChildAt(e),t.group==this&&(a=t.x,s>a&&(s=a),a=t.y,n>a&&(n=a),a=t.x+t.width,a>r&&(r=a),a=t.y+t.height,a>h&&(h=a),this._empty=!1);this._updating=!0,this._empty?this.setSize(0,0):(this.setXY(s,n),this.setSize(r-s,h-n)),this._updating=!1}},e.moveChildren=function(t,i){if(!this._updating&&this.parent){this._updating=!0;var e,s=this._parent.numChildren,n=0;for(n=0;s>n;n++)e=this._parent.getChildAt(n),e.group==this&&e.setXY(e.x+t,e.y+i);this._updating=!1}},e.updateAlpha=function(){if(t.prototype.updateAlpha.call(this),!this._underConstruct){var i,e=this._parent.numChildren,s=NaN;for(s=0;e>s;s++)i=this._parent.getChildAt(s),i.group==this&&(i.alpha=this.alpha)}},i}(M),ft=function(t){function i(){this.image=null,this._color=null,this._flip=0,i.__super.call(this),this._color="#FFFFFF"}n(i,"fairygui.GImage",t);var s=i.prototype;return e.imps(s,{"fairygui.IColorGear":!0}),s.applyColor=function(){},s.createDisplayObject=function(){this._displayObject=this.image=new Ft,this.image.mouseEnabled=!1,this._displayObject.$owner=this},s.constructFromResource=function(){this.packageItem.load(),this._sourceWidth=this.packageItem.width,this._sourceHeight=this.packageItem.height,this._initWidth=this._sourceWidth,this._initHeight=this._sourceHeight,this.image.scale9Grid=this.packageItem.scale9Grid,this.image.scaleByTile=this.packageItem.scaleByTile,this.image.tileGridIndice=this.packageItem.tileGridIndice,this.image.texture=this.packageItem.texture,this.setSize(this._sourceWidth,this._sourceHeight)},s.handleXYChanged=function(){t.prototype.handleXYChanged.call(this),-1==this.scaleX&&(this.image.x+=this.width),-1==this.scaleY&&(this.image.y+=this.height)},s.handleSizeChanged=function(){null!=this.image.texture&&this.image.scaleTexture(this.width/this._sourceWidth,this.height/this._sourceHeight)},s.setup_beforeAdd=function(i){t.prototype.setup_beforeAdd.call(this,i);var e;e=i.getAttribute("color"),e&&(this.color=e),e=i.getAttribute("flip"),e&&(this.flip=B.parse(e))},r(0,s,"color",function(){return this._color},function(t){this._color!=t&&(this._color=t,this.updateGear(4),this.applyColor())}),r(0,s,"flip",function(){return this._flip},function(t){if(this._flip!=t){this._flip=t;var i=1,e=1;1!=this._flip&&3!=this._flip||(i=-1),2!=this._flip&&3!=this._flip||(e=-1),this.setScale(i,e),this.handleXYChanged()}}),i}(M),pt=function(t){function i(t){this.tweener=null,this._storage=null,this._default=null,this._tweenValue=null,this._tweenTarget=null,i.__super.call(this,t)}var e;n(i,"fairygui.GearSize",t);var s=i.prototype;return s.init=function(){this._default=new e(this._owner.width,this._owner.height,this._owner.scaleX,this._owner.scaleY),this._storage={}},s.addStatus=function(t,i){if("-"!=i){var s,n=i.split(",");null==t?s=this._default:(s=new e,this._storage[t]=s),s.width=parseInt(n[0]),s.height=parseInt(n[1]),n.length>2&&(s.scaleX=parseFloat(n[2]),s.scaleY=parseFloat(n[3]))}},s.apply=function(){var t=this._storage[this._controller.selectedPageId];if(t||(t=this._default),!this._tween||it._constructing||H.disableAllTweenEffect)this._owner._gearLocked=!0,this._owner.setSize(t.width,t.height,this._owner.gearXY.controller==this._controller),this._owner.setScale(t.scaleX,t.scaleY),this._owner._gearLocked=!1;else{if(null!=this.tweener){if(this._tweenTarget.width==t.width&&this._tweenTarget.height==t.height&&this._tweenTarget.scaleX==t.scaleX&&this._tweenTarget.scaleY==t.scaleY)return;this.tweener.complete(),this.tweener=null}var i=t.width!=this._owner.width||t.height!=this._owner.height,s=t.scaleX!=this._owner.scaleX||t.scaleY!=this._owner.scaleY;(i||s)&&(this._owner.internalVisible++,this._tweenTarget=t,null==this._tweenValue&&(this._tweenValue=new e),this._tweenValue.width=this._owner.width,this._tweenValue.height=this._owner.height,this._tweenValue.scaleX=this._owner.scaleX,this._tweenValue.scaleY=this._owner.scaleY,this.tweener=I.to(this._tweenValue,{width:t.width,height:t.height,scaleX:t.scaleX,scaleY:t.scaleY},1e3*this._tweenTime,this._easeType,g.create(this,this.__tweenComplete),1e3*this._delay),this.tweener.update=g.create(this,this.__tweenUpdate,[i,s],!1))}},s.__tweenUpdate=function(t,i){this._owner._gearLocked=!0,t&&this._owner.setSize(this._tweenValue.width,this._tweenValue.height,this._owner.gearXY.controller==this._controller),i&&this._owner.setScale(this._tweenValue.scaleX,this._tweenValue.scaleY),this._owner._gearLocked=!1},s.__tweenComplete=function(){this._owner.internalVisible--,this.tweener=null},s.updateState=function(){if(null!=this._controller&&!this._owner._gearLocked&&!this._owner._underConstruct){var t=this._storage[this._controller.selectedPageId];t||(t=new e,this._storage[this._controller.selectedPageId]=t),t.width=this._owner.width,t.height=this._owner.height,t.scaleX=this._owner.scaleX,t.scaleY=this._owner.scaleY}},s.updateFromRelations=function(t,i){if(null!=this._controller&&null!=this._storage){for(var e in this._storage){var s=this._storage[e];s.width+=t,s.height+=i}this._default.width+=t,this._default.height+=i,this.updateState()}},i.__init$=function(){e=function(){function t(t,i,e,s){this.width=NaN,this.height=NaN,this.scaleX=NaN,this.scaleY=NaN,void 0===t&&(t=0),void 0===i&&(i=0),void 0===e&&(e=0),void 0===s&&(s=0),this.width=t,this.height=i,this.scaleX=e,this.scaleY=s}return n(t,""),t}()},i}(H),mt=function(t){function i(t){this._storage=null,this._default=null,i.__super.call(this,t)}n(i,"fairygui.GearText",t);var e=i.prototype;return e.init=function(){this._default=this._owner.text,this._storage={}},e.addStatus=function(t,i){null==t?this._default=i:this._storage[t]=i},e.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];void 0!=t?this._owner.text=String(t):this._owner.text=this._default,this._owner._gearLocked=!1},e.updateState=function(){null==this._controller||this._owner._gearLocked||this._owner._underConstruct||(this._storage[this._controller.selectedPageId]=this._owner.text)},i}(H),yt=function(t){function i(t){this.tweener=null,this._storage=null,this._default=null,this._tweenValue=null,this._tweenTarget=null,i.__super.call(this,t)}n(i,"fairygui.GearXY",t);var e=i.prototype;return e.init=function(){this._default=new m(this._owner.x,this._owner.y),this._storage={}},e.addStatus=function(t,i){if("-"!=i){var e,s=i.split(",");null==t?e=this._default:(e=new m,this._storage[t]=e),e.x=parseInt(s[0]),e.y=parseInt(s[1])}},e.apply=function(){var t=this._storage[this._controller.selectedPageId];if(t||(t=this._default),!this._tween||it._constructing||H.disableAllTweenEffect)this._owner._gearLocked=!0,this._owner.setXY(t.x,t.y),this._owner._gearLocked=!1;else{if(this.tweener){if(this._tweenTarget.x==t.x&&this._tweenTarget.y==t.y)return;this.tweener.complete(),this.tweener=null}this._owner.x==t.x&&this._owner.y==t.y||(this._owner.internalVisible++,this._tweenTarget=t,null==this._tweenValue&&(this._tweenValue=new m),this._tweenValue.x=this._owner.x,this._tweenValue.y=this._owner.y,this.tweener=I.to(this._tweenValue,{x:t.x,y:t.y},1e3*this._tweenTime,this._easeType,g.create(this,this.__tweenComplete),1e3*this._delay),this.tweener.update=g.create(this,this.__tweenUpdate,null,!1))}},e.__tweenUpdate=function(){this._owner._gearLocked=!0,this._owner.setXY(this._tweenValue.x,this._tweenValue.y),this._owner._gearLocked=!1},e.__tweenComplete=function(){this._owner.internalVisible--,this.tweener=null},e.updateState=function(){if(null!=this._controller&&!this._owner._gearLocked&&!this._owner._underConstruct){var t=this._storage[this._controller.selectedPageId];t||(t=new m,this._storage[this._controller.selectedPageId]=t),t.x=this._owner.x,t.y=this._owner.y}},e.updateFromRelations=function(t,i){if(null!=this._controller&&null!=this._storage){for(var e in this._storage){var s=this._storage[e];s.x+=t,s.y+=i}this._default.x+=t,this._default.y+=i,this.updateState()}},i}(H),vt=function(t){function i(){this._url=null,this._align=null,this._valign=null,this._autoSize=!1,this._fill=0,this._showErrorSign=!1,this._playing=!1,this._frame=0,this._color=null,this._contentItem=null,this._contentSourceWidth=0,this._contentSourceHeight=0,this._contentWidth=0,this._contentHeight=0,this._content=null,this._errorSign=null,this._updatingLayout=!1,i.__super.call(this),this._playing=!0,this._url="",this._align="left",this._valign="top",this._showErrorSign=!0,this._color="#FFFFFF"}n(i,"fairygui.GLoader",t);var h=i.prototype;return e.imps(h,{"fairygui.IAnimationGear":!0,"fairygui.IColorGear":!0}),h.createDisplayObject=function(){t.prototype.createDisplayObject.call(this),this._displayObject.mouseEnabled=!0},h.dispose=function(){if(null==this._contentItem&&this._content instanceof fairygui.display.Image){var i=this._content.texture;null!=i&&this.freeExternal(i)}t.prototype.dispose.call(this)},h.applyColor=function(){},h.loadContent=function(){this.clearContent(),this._url&&(et.startsWith(this._url,"ui://")?this.loadFromPackage(this._url):this.loadExternal())},h.loadFromPackage=function(t){this._contentItem=it.getItemByURL(t),null!=this._contentItem?(this._contentItem.load(),0==this._contentItem.type?null==this._contentItem.texture?this.setErrorState():(this._content instanceof fairygui.display.Image?this._displayObject.addChild(this._content):(this._content=new Ft,this._displayObject.addChild(this._content)),this._content.texture=this._contentItem.texture,this._content.scale9Grid=this._contentItem.scale9Grid,this._content.scaleByTile=this._contentItem.scaleByTile,this._content.tileGridIndice=this._contentItem.tileGridIndice,this._contentSourceWidth=this._contentItem.width,this._contentSourceHeight=this._contentItem.height,this.updateLayout()):2==this._contentItem.type?(this._content instanceof fairygui.display.MovieClip?this._displayObject.addChild(this._content):(this._content=new Lt,this._displayObject.addChild(this._content)),this._contentSourceWidth=this._contentItem.width,this._contentSourceHeight=this._contentItem.height,this._content.interval=this._contentItem.interval,this._content.swing=this._contentItem.swing,this._content.repeatDelay=this._contentItem.repeatDelay,this._content.frames=this._contentItem.frames,this._content.boundsRect=new y(0,0,this._contentSourceWidth,this._contentSourceHeight),this.updateLayout()):this.setErrorState()):this.setErrorState()},h.loadExternal=function(){S.inst.load(this._url,g.create(this,this.__getResCompleted))},h.freeExternal=function(t){},h.onExternalLoadSuccess=function(t){this._content instanceof fairygui.display.Image?this._displayObject.addChild(this._content):(this._content=new Ft,this._displayObject.addChild(this._content)),this._content.texture=t,this._content.scale9Grid=null,this._content.scaleByTile=!1,this._contentSourceWidth=t.width,this._contentSourceHeight=t.height,this.updateLayout()},h.onExternalLoadFailed=function(){this.setErrorState()},h.__getResCompleted=function(t){null!=t?this.onExternalLoadSuccess(t):this.onExternalLoadFailed()},h.setErrorState=function(){this._showErrorSign&&(null==this._errorSign&&null!=J.loaderErrorSign&&(this._errorSign=fairygui.GLoader._errorSignPool.getObject(J.loaderErrorSign)),null!=this._errorSign&&(this._errorSign.width=this.width,this._errorSign.height=this.height,this._displayObject.addChild(this._errorSign.displayObject)))},h.clearErrorState=function(){null!=this._errorSign&&(this._displayObject.removeChild(this._errorSign.displayObject),fairygui.GLoader._errorSignPool.returnObject(this._errorSign),this._errorSign=null)},h.updateLayout=function(){if(null==this._content)return void(this._autoSize&&(this._updatingLayout=!0,this.setSize(50,30),this._updatingLayout=!1));if(this._content.x=0,this._content.y=0,this._content.scaleX=1,this._content.scaleY=1,this._contentWidth=this._contentSourceWidth,this._contentHeight=this._contentSourceHeight,this._autoSize)this._updatingLayout=!0,0==this._contentWidth&&(this._contentWidth=50),0==this._contentHeight&&(this._contentHeight=30),this.setSize(this._contentWidth,this._contentHeight),this._updatingLayout=!1;else{var t=1,i=1;0!=this._fill&&(t=this.width/this._contentSourceWidth,i=this.height/this._contentSourceHeight,1==t&&1==i||(2==this._fill?t=i:3==this._fill?i=t:1==this._fill&&(t>i?t=i:i=t),this._contentWidth=this._contentSourceWidth*t,this._contentHeight=this._contentSourceHeight*i)),this._content instanceof fairygui.display.Image?this._content.scaleTexture(t,i):this._content.scale(t,i),"center"==this._align?this._content.x=Math.floor((this.width-this._contentWidth)/2):"right"==this._align&&(this._content.x=this.width-this._contentWidth),"middle"==this._valign?this._content.y=Math.floor((this.height-this._contentHeight)/2):"bottom"==this._valign&&(this._content.y=this.height-this._contentHeight)}},h.clearContent=function(){if(this.clearErrorState(),null!=this._content&&null!=this._content.parent&&this._displayObject.removeChild(this._content),null==this._contentItem&&this._content instanceof fairygui.display.Image){var t=this._content.texture;null!=t&&this.freeExternal(t)}this._contentItem=null},h.handleSizeChanged=function(){t.prototype.handleSizeChanged.call(this),this._updatingLayout||this.updateLayout()},h.setup_beforeAdd=function(i){t.prototype.setup_beforeAdd.call(this,i);var e;e=i.getAttribute("url"),e&&(this._url=e),e=i.getAttribute("align"),e&&(this._align=e),e=i.getAttribute("vAlign"),e&&(this._valign=e),e=i.getAttribute("fill"),e&&(this._fill=z.parse(e)),this._autoSize="true"==i.getAttribute("autoSize"),e=i.getAttribute("errorSign"),e&&(this._showErrorSign="true"==e),this._playing="false"!=i.getAttribute("playing"),e=i.getAttribute("color"),e&&(this.color=e),this._url&&this.loadContent()},r(0,h,"frame",function(){return this._frame},function(t){this._frame!=t&&(this._frame=t,this._content instanceof fairygui.display.MovieClip&&(this._content.currentFrame=t),this.updateGear(5))}),r(0,h,"url",function(){return this._url},function(t){this._url!=t&&(this._url=t,this.loadContent(),this.updateGear(7))}),r(0,h,"align",function(){return this._align},function(t){this._align!=t&&(this._align=t,this.updateLayout())}),r(0,h,"color",function(){return this._color},function(t){this._color!=t&&(this._color=t,this.updateGear(4),this.applyColor())}),r(0,h,"fill",function(){return this._fill},function(t){this._fill!=t&&(this._fill=t,this.updateLayout())}),r(0,h,"verticalAlign",function(){return this._valign},function(t){this._valign!=t&&(this._valign=t,this.updateLayout())}),r(0,h,"icon",function(){return this._url},function(t){this.url=t}),r(0,h,"showErrorSign",function(){return this._showErrorSign},function(t){this._showErrorSign=t}),r(0,h,"autoSize",function(){return this._autoSize},function(t){this._autoSize!=t&&(this._autoSize=t,this.updateLayout())}),r(0,h,"playing",function(){return this._playing},function(t){this._playing!=t&&(this._playing=t,this._content instanceof fairygui.display.MovieClip&&(this._content.playing=t),this.updateGear(5))}),r(0,h,"content",function(){return this._content}),s(i,["_errorSignPool",function(){return this._errorSignPool=new N}]),i}(M),bt=function(t){function i(){this.movieClip=null,i.__super.call(this),this._sizeImplType=1}n(i,"fairygui.GMovieClip",t);var s=i.prototype;return e.imps(s,{"fairygui.IAnimationGear":!0,"fairygui.IColorGear":!0}),s.createDisplayObject=function(){this._displayObject=this.movieClip=new Lt,this.movieClip.mouseEnabled=!1,this._displayObject.$owner=this},s.setPlaySettings=function(t,i,e,s,n){void 0===t&&(t=0),void 0===i&&(i=-1),void 0===e&&(e=0),void 0===s&&(s=-1),this.movieClip.setPlaySettings(t,i,e,s,n)},s.constructFromResource=function(){this._sourceWidth=this.packageItem.width,this._sourceHeight=this.packageItem.height,this._initWidth=this._sourceWidth,this._initHeight=this._sourceHeight,this.setSize(this._sourceWidth,this._sourceHeight),this.packageItem.load(),this.movieClip.interval=this.packageItem.interval,this.movieClip.swing=this.packageItem.swing,this.movieClip.repeatDelay=this.packageItem.repeatDelay,this.movieClip.frames=this.packageItem.frames,this.movieClip.boundsRect=new y(0,0,this.sourceWidth,this.sourceHeight)},s.setup_beforeAdd=function(i){t.prototype.setup_beforeAdd.call(this,i);var e;e=i.getAttribute("frame"),e&&(this.movieClip.currentFrame=parseInt(e)),e=i.getAttribute("playing"),this.movieClip.playing="false"!=e,e=i.getAttribute("color"),e&&(this.color=e)},r(0,s,"color",function(){return"#FFFFFF"},function(t){}),r(0,s,"playing",function(){return this.movieClip.playing},function(t){this.movieClip.playing!=t&&(this.movieClip.playing=t,this.updateGear(5))}),r(0,s,"frame",function(){return this.movieClip.currentFrame},function(t){this.movieClip.currentFrame!=t&&(this.movieClip.currentFrame=t,this.updateGear(5))}),i}(M),wt=function(t){function i(){this.textField=null,this._font=null,this._color=null,this._text=null,this._ubbEnabled=!1,this._singleLine=!1,this._letterSpacing=0,this._autoSize=0,this._widthAutoSize=!1,this._heightAutoSize=!1,this._updatingSize=!1,this._textWidth=0,this._textHeight=0,this._bitmapFont=null,this._lines=null,i.__super.call(this),this._text="",this._color="#000000",this.setAutoSize(1),this.textField.align="left",this.textField.font=J.defaultFont}var s,h;n(i,"fairygui.GBasicTextField",t);var a=i.prototype;return a.createDisplayObject=function(){this._displayObject=this.textField=new h(this),this._displayObject.$owner=this,this._displayObject.mouseEnabled=!1},a.setAutoSize=function(t){this._autoSize=t,this._widthAutoSize=1==t,this._heightAutoSize=1==t||2==t,this.textField.wordWrap=!this._widthAutoSize,this._underConstruct||(this._heightAutoSize?this._widthAutoSize||(this.textField.width=this.width):this.textField.size(this.width,this.height))},a.ensureSizeCorrect=function(){!this._underConstruct&&this.textField._isChanged&&this.textField.typeset()},a.typeset=function(){null!=this._bitmapFont?this.renderWithBitmapFont():(this._widthAutoSize||this._heightAutoSize)&&this.updateSize()},a.updateSize=function(){this._textWidth=Math.ceil(this.textField.textWidth),this._textHeight=Math.ceil(this.textField.textHeight);var t=NaN,i=0;this._widthAutoSize?(t=this._textWidth,this.textField.width!=t&&(this.textField.width=t)):t=this.width,this._heightAutoSize?(i=this._textHeight,this._widthAutoSize||this.textField.height!=this._textHeight&&(this.textField.height=this._textHeight)):(i=this.height,this._textHeight>i&&(this._textHeight=i),this.textField.height!=this._textHeight&&(this.textField.height=this._textHeight)),this._updatingSize=!0,this.setSize(t,i),this._updatingSize=!1},a.renderWithBitmapFont=function(){var t=this._displayObject.graphics;t.clear(),this._lines?s.returnList(this._lines):this._lines=[];var i,e=this.letterSpacing,n=this.leading-1,r=this.width-4,h=0,a=0,o=0,l=0,u=0,_=0,c=0,d=0,g=0,f="",p=2,m=!this._widthAutoSize&&!this._singleLine,y=this._bitmapFont.resizable?this.fontSize/this._bitmapFont.size:1;this._textWidth=0,this._textHeight=0;for(var v=this._text.length,b=0;v>b;++b){var w=this._text.charAt(b),x=w.charCodeAt(b);if("\n"!=w){if(x>256||32>=x?(_>0&&(d=h),_=0):(0==_&&(c=h),_++)," "==w)l=Math.ceil(this.fontSize/2),u=Math.ceil(this.fontSize);else{var I=this._bitmapFont.glyphs[w];I?(l=Math.ceil(I.advance*y),u=Math.ceil(I.lineHeight*y)):" "==w?(l=Math.ceil(this._bitmapFont.size*y/2),u=Math.ceil(this._bitmapFont.size*y)):(l=0,u=0)}if(u>o&&(o=u),u>a&&(a=u),0!=h&&(h+=e),h+=l,!m||r>=h)f+=w;else{if(i=s.borrow(),i.height=a,i.textHeight=o,0==f.length)i.text=w;else if(_>0&&d>0){f+=w;var C=f.length-_;i.text=et.trimRight(f.substr(0,C)),i.width=d,f=f.substr(C+1),h-=c}else i.text=f,i.width=h-(l+e),f=w,h=l,a=u,o=u;i.y=p,p+=i.height+n,i.width>this._textWidth&&(this._textWidth=i.width),_=0,c=0,d=0,this._lines.push(i)}}else f+=w,i=s.borrow(),i.width=h,0==o&&(0==g&&(g=Math.ceil(this.fontSize*y)),0==a&&(a=g),o=a),i.height=a,g=a,i.textHeight=o,i.text=f,i.y=p,p+=i.height+n,i.width>this._textWidth&&(this._textWidth=i.width),this._lines.push(i),f="",h=0,a=0,o=0,_=0,c=0,d=0}(f.length>0||this._lines.length>0&&et.endsWith(this._lines[this._lines.length-1].text,"\n"))&&(i=s.borrow(),i.width=h,0==a&&(a=g),0==o&&(o=a),i.height=a,i.textHeight=o,i.text=f,i.y=p,i.width>this._textWidth&&(this._textWidth=i.width),this._lines.push(i)),this._textWidth>0&&(this._textWidth+=4);var S=this._lines.length;0==S?this._textHeight=0:(i=this._lines[this._lines.length-1],this._textHeight=i.y+i.height+2);var O=NaN,P=0;if(O=this._widthAutoSize?0==this._textWidth?0:this._textWidth:this.width,P=this._heightAutoSize?0==this._textHeight?0:this._textHeight:this.height,this._updatingSize=!0,this.setSize(O,P),this._updatingSize=!1,this.doAlign(),0!=O&&0!=P){var j=2,k=0,A=0;r=this.width-4;for(var T=this._lines.length,F=0;T>F;F++){i=this._lines[F],j=2,k="center"==this.align?(r-i.width)/2:"right"==this.align?r-i.width:0,v=i.text.length;for(var L=0;v>L;L++)w=i.text.charAt(L),I=this._bitmapFont.glyphs[w],null!=I?(A=(i.height+i.textHeight)/2-Math.ceil(I.lineHeight*y),t.drawTexture(I.texture,j+k+Math.ceil(I.offsetX*y),i.y+A+Math.ceil(I.offsetY*y),I.texture.width*y,I.texture.height*y),j+=e+Math.ceil(I.advance*y)):j+=" "==w?e+Math.ceil(this._bitmapFont.size*y/2):e}}},a.handleSizeChanged=function(){this._updatingSize||(this._underConstruct?this.textField.size(this.width,this.height):null!=this._bitmapFont?this._widthAutoSize?this.doAlign():this.textField.setChanged():this._widthAutoSize||(this._heightAutoSize?this.textField.width=this.width:this.textField.size(this.width,this.height)))},a.handleGrayedChanged=function(){fairygui.GObject.prototype.handleGrayedChanged.call(this),this.grayed?this.textField.color="#AAAAAA":this.textField.color=this._color},a.doAlign=function(){if("top"==this.valign||0==this._textHeight)this._yOffset=2;else{var t=this.height-this._textHeight;0>t&&(t=0),"middle"==this.valign?this._yOffset=Math.floor(t/2):this._yOffset=Math.floor(t)}this.handleXYChanged()},a.setup_beforeAdd=function(i){t.prototype.setup_beforeAdd.call(this,i);var e;e=i.getAttribute("autoSize"),e&&this.setAutoSize(O.parse(e))},r(0,a,"bold",function(){return this.textField.bold},function(t){this.textField.bold=t}),r(0,a,"letterSpacing",function(){return this._letterSpacing},function(t){this._letterSpacing=t}),r(0,a,"align",function(){return this.textField.align},function(t){this.textField.align=t}),r(0,a,"text",function(){return this._text},function(t){this._text=t,null==this._text&&(this._text=""),null==this._bitmapFont?(this._widthAutoSize&&(this.textField.width=1e4),this._ubbEnabled?this.textField.text=et.removeUBB(et.encodeHTML(this._text)):this.textField.text=this._text):(this.textField.text="",this.textField.setChanged()),this.parent&&this.parent._underConstruct&&this.textField.typeset()}),r(0,a,"color",function(){return this._color},function(t){this._color!=t&&(this._color=t,this._gearColor.controller&&this._gearColor.updateState(),this.grayed?this.textField.color="#AAAAAA":this.textField.color=this._color)}),r(0,a,"font",function(){return this.textField.font},function(t){this._font=t,et.startsWith(this._font,"ui://")?(this._bitmapFont=it.getBitmapFontByURL(this._font),this.textField.setChanged()):(this._bitmapFont=null,this._font?this.textField.font=this._font:this.textField.font=J.defaultFont)}),r(0,a,"leading",function(){return this.textField.leading},function(t){this.textField.leading=t}),r(0,a,"fontSize",function(){return this.textField.fontSize},function(t){this.textField.fontSize=t}),r(0,a,"valign",function(){return this.textField.valign},function(t){this.textField.valign=t}),r(0,a,"italic",function(){return this.textField.italic},function(t){this.textField.italic=t}),r(0,a,"underline",function(){return this.textField.underline},function(t){this.textField.underline=t}),r(0,a,"singleLine",function(){return this._singleLine},function(t){this._singleLine=t}),r(0,a,"stroke",function(){return this.textField.stroke},function(t){this.textField.stroke=t}),r(0,a,"strokeColor",function(){return this.textField.strokeColor},function(t){this.textField.strokeColor=t}),r(0,a,"ubbEnabled",function(){return this._ubbEnabled},function(t){this._ubbEnabled=t}),r(0,a,"autoSize",function(){return this._autoSize},function(t){this._autoSize!=t&&this.setAutoSize(t)}),r(0,a,"textWidth",function(){return this.textField._isChanged&&this.textField.typeset(),this._textWidth}),i.GUTTER_X=2,i.GUTTER_Y=2,i.__init$=function(){s=function(){function t(){this.width=0,this.height=0,this.textHeight=0,this.text=null,this.y=0}return n(t,""),t.borrow=function(){if(t.pool.length){var i=t.pool.pop();return i.width=0,i.height=0,i.textHeight=0,i.text=null,i.y=0,i}return new t},t.returns=function(i){t.pool.push(i)},t.returnList=function(i){for(var e=i.length,s=0;e>s;s++){var n=i[s];t.pool.push(n)}i.length=0},t.pool=[],t}(),h=function(t){function i(t){this._owner=null,i.__super.call(this),this._owner=t}n(i,"",t);
var s=i.prototype;return s.typeset=function(){t.prototype.typeset.call(this),this._owner.typeset(),this._isChanged&&(e.timer.clear(this,this.typeset),this._isChanged=!1)},s.setChanged=function(){this.isChanged=!0},r(0,s,"isChanged",null,function(i){this._isChanged!==i&&0!=this._owner.autoSize&&this.event("fui_size_delay_change"),t.prototype._$set_isChanged.call(this,i)}),i}(w)},i}(ht),xt=function(t){function i(){this._titleObject=null,this._iconObject=null,this._relatedController=null,this._mode=0,this._selected=!1,this._title=null,this._selectedTitle=null,this._icon=null,this._selectedIcon=null,this._sound=null,this._soundVolumeScale=0,this._pageOption=null,this._buttonController=null,this._changeStateOnClick=!1,this._linkedPopup=null,this._downEffect=0,this._downEffectValue=0,this._down=!1,this._over=!1,i.__super.call(this),this._mode=0,this._title="",this._icon="",this._sound=J.buttonSound,this._soundVolumeScale=J.buttonSoundVolumeScale,this._pageOption=new X,this._changeStateOnClick=!0,this._downEffectValue=.8}n(i,"fairygui.GButton",t);var s=i.prototype;return s.fireClick=function(t){void 0===t&&(t=!0),t&&0==this._mode&&(this.setState("over"),e.timer.once(100,this,this.setState,["down"]),e.timer.once(200,this,this.setState,["up"])),this.__click(L.createEvent("click",this.displayObject))},s.setState=function(t){if(this._buttonController&&(this._buttonController.selectedPage=t),1==this._downEffect){var i=this.numChildren;if("down"==t||"selectedOver"==t||"selectedDisabled"==t)for(var e=255*this._downEffectValue,s=C.toHexColor((e<<16)+(e<<8)+e),n=0;i>n;n++){var r=this.getChildAt(n);(r instanceof fairygui.GImage||r instanceof fairygui.GLoader||r instanceof fairygui.GMovieClip)&&(r.color=s)}else for(n=0;i>n;n++)r=this.getChildAt(n),(r instanceof fairygui.GImage||r instanceof fairygui.GLoader||r instanceof fairygui.GMovieClip)&&(r.color="#FFFFFF")}else 2==this._downEffect&&("down"==t||"selectedOver"==t||"selectedDisabled"==t?this.setScale(this._downEffectValue,this._downEffectValue):this.setScale(1,1))},s.handleControllerChanged=function(t){fairygui.GObject.prototype.handleControllerChanged.call(this,t),this._relatedController==t&&(this.selected=this._pageOption.id==t.selectedPageId)},s.handleGrayedChanged=function(){this._buttonController&&this._buttonController.hasPage("disabled")?this.grayed?this._selected&&this._buttonController.hasPage("selectedDisabled")?this.setState("selectedDisabled"):this.setState("disabled"):this._selected?this.setState("down"):this.setState("up"):t.prototype.handleGrayedChanged.call(this)},s.constructFromXML=function(i){t.prototype.constructFromXML.call(this,i),i=et.findChildNode(i,"Button");var e;e=i.getAttribute("mode"),e&&(this._mode=P.parse(e)),e=i.getAttribute("sound"),e&&(this._sound=e),e=i.getAttribute("volume"),e&&(this._soundVolumeScale=parseInt(e)/100),e=i.getAttribute("downEffect"),e&&(this._downEffect="dark"==e?1:"scale"==e?2:0,e=i.getAttribute("downEffectValue"),this._downEffectValue=parseFloat(e)),this._buttonController=this.getController("button"),this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon"),null!=this._titleObject&&(this._title=this._titleObject.text),null!=this._iconObject&&(this._icon=this._iconObject.icon),0==this._mode&&this.setState("up"),this.on("mouseover",this,this.__rollover),this.on("mouseout",this,this.__rollout),this.on("mousedown",this,this.__mousedown),this.on("click",this,this.__click)},s.setup_afterAdd=function(t){if(fairygui.GObject.prototype.setup_afterAdd.call(this,t),2==this._downEffect&&this.setPivot(.5,.5),t=et.findChildNode(t,"Button")){var i;i=t.getAttribute("title"),i&&(this.title=i),i=t.getAttribute("icon"),i&&(this.icon=i),i=t.getAttribute("selectedTitle"),i&&(this.selectedTitle=i),i=t.getAttribute("selectedIcon"),i&&(this.selectedIcon=i),i=t.getAttribute("titleColor"),i&&(this.titleColor=i),i=t.getAttribute("controller"),i?this._relatedController=this._parent.getController(i):this._relatedController=null,this._pageOption.id=t.getAttribute("page"),this.selected="true"==t.getAttribute("checked")}},s.__rollover=function(){this._buttonController&&this._buttonController.hasPage("over")&&(this._over=!0,this._down||this.grayed&&this._buttonController.hasPage("disabled")||this.setState(this._selected?"selectedOver":"over"))},s.__rollout=function(){this._buttonController&&this._buttonController.hasPage("over")&&(this._over=!1,this._down||this.grayed&&this._buttonController.hasPage("disabled")||this.setState(this._selected?"down":"up"))},s.__mousedown=function(t){this._down=!0,kt.inst.checkPopups(t.target),e.stage.on("mouseup",this,this.__mouseup),0==this._mode&&(this.grayed&&this._buttonController&&this._buttonController.hasPage("disabled")?this.setState("selectedDisabled"):this.setState("down")),null!=this._linkedPopup&&(this._linkedPopup instanceof fairygui.Window?this._linkedPopup.toggleStatus():this.root.togglePopup(this._linkedPopup,this))},s.__mouseup=function(){this._down&&(e.stage.off("mouseup",this,this.__mouseup),this._down=!1,0==this._mode&&(this.grayed&&this._buttonController&&this._buttonController.hasPage("disabled")?this.setState("disabled"):this._over?this.setState("over"):this.setState("up")))},s.__click=function(t){if(this._sound){var i=it.getItemByURL(this._sound);if(i){var e=i.owner.getItemAsset(i);e&&kt.inst.playOneShotSound(e,this._soundVolumeScale)}}this._changeStateOnClick&&(1==this._mode?(this.selected=!this._selected,L.dispatch("fui_state_changed",this.displayObject,t)):2==this._mode&&(this._selected||(this.selected=!0,L.dispatch("fui_state_changed",this.displayObject,t))))},r(0,s,"relatedController",function(){return this._relatedController},function(t){t!=this._relatedController&&(this._relatedController=t,this._pageOption.controller=t,this._pageOption.clear())}),r(0,s,"icon",function(){return this._icon},function(t){this._icon=t,t=this._selected&&this._selectedIcon?this._selectedIcon:this._icon,null!=this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)}),r(0,s,"selectedIcon",function(){return this._selectedIcon},function(t){this._selectedIcon=t,t=this._selected&&this._selectedIcon?this._selectedIcon:this._icon,null!=this._iconObject&&(this._iconObject.icon=t)}),r(0,s,"title",function(){return this._title},function(t){this._title=t,this._titleObject&&(this._titleObject.text=this._selected&&this._selectedTitle?this._selectedTitle:this._title),this.updateGear(6)}),r(0,s,"text",function(){return this.title},function(t){this.title=t}),r(0,s,"selectedTitle",function(){return this._selectedTitle},function(t){this._selectedTitle=t,this._titleObject&&(this._titleObject.text=this._selected&&this._selectedTitle?this._selectedTitle:this._title)}),r(0,s,"selected",function(){return this._selected},function(t){if(0!=this._mode&&this._selected!=t){if(this._selected=t,this.grayed&&this._buttonController&&this._buttonController.hasPage("disabled")?this._selected?this.setState("selectedDisabled"):this.setState("disabled"):this._selected?this.setState(this._over?"selectedOver":"down"):this.setState(this._over?"over":"up"),this._selectedTitle&&this._titleObject&&(this._titleObject.text=this._selected?this._selectedTitle:this._title),this._selectedIcon){var i=this._selected?this._selectedIcon:this._icon;null!=this._iconObject&&(this._iconObject.icon=i)}this._relatedController&&this._parent&&!this._parent._buildingDisplayList&&(this._selected?(this._relatedController.selectedPageId=this._pageOption.id,this._relatedController._autoRadioGroupDepth&&this._parent.adjustRadioGroupDepth(this,this._relatedController)):1==this._mode&&this._relatedController.selectedPageId==this._pageOption.id&&(this._relatedController.oppositePageId=this._pageOption.id))}}),r(0,s,"soundVolumeScale",function(){return this._soundVolumeScale},function(t){this._soundVolumeScale=t}),r(0,s,"sound",function(){return this._sound},function(t){this._sound=t}),r(0,s,"titleColor",function(){return this._titleObject instanceof fairygui.GTextField?this._titleObject.color:this._titleObject instanceof fairygui.GLabel?this._titleObject.titleColor:this._titleObject instanceof fairygui.GButton?this._titleObject.titleColor:"#000000"},function(t){this._titleObject instanceof fairygui.GTextField?this._titleObject.color=t:this._titleObject instanceof fairygui.GLabel?this._titleObject.titleColor=t:this._titleObject instanceof fairygui.GButton&&(this._titleObject.titleColor=t)}),r(0,s,"mode",function(){return this._mode},function(t){this._mode!=t&&(0==t&&(this.selected=!1),this._mode=t)}),r(0,s,"pageOption",function(){return this._pageOption}),r(0,s,"changeStateOnClick",function(){return this._changeStateOnClick},function(t){this._changeStateOnClick=t}),r(0,s,"linkedPopup",function(){return this._linkedPopup},function(t){this._linkedPopup=t}),i.UP="up",i.DOWN="down",i.OVER="over",i.SELECTED_OVER="selectedOver",i.DISABLED="disabled",i.SELECTED_DISABLED="selectedDisabled",i}(at),It=function(t){function i(){this.dropdown=null,this._titleObject=null,this._iconObject=null,this._list=null,this._items=null,this._icons=null,this._values=null,this._popupDownward=null,this._visibleItemCount=0,this._itemsUpdated=!1,this._selectedIndex=0,this._buttonController=null,this._down=!1,this._over=!1,i.__super.call(this),this._visibleItemCount=J.defaultComboBoxVisibleItemCount,this._itemsUpdated=!0,this._selectedIndex=-1,this._items=[],this._values=[]}n(i,"fairygui.GComboBox",t);var s=i.prototype;return s.setState=function(t){this._buttonController&&(this._buttonController.selectedPage=t)},s.dispose=function(){this.dropdown&&(this.dropdown.dispose(),this.dropdown=null),t.prototype.dispose.call(this)},s.constructFromXML=function(i){t.prototype.constructFromXML.call(this,i),i=et.findChildNode(i,"ComboBox");var e;if(this._buttonController=this.getController("button"),this._titleObject=this.getChild("title"),e=i.getAttribute("dropdown")){if(this.dropdown=it.createObjectFromURL(e),!this.dropdown)return void p.print("");if(this.dropdown.name="this._dropdownObject",this._list=this.dropdown.getChild("list").asList,null==this._list)return void p.print(this.resourceURL+": list");this._list.on("fui_click_item",this,this.__clickItem),this._list.addRelation(this.dropdown,14),this._list.removeRelation(this.dropdown,15),this.dropdown.addRelation(this._list,15),this.dropdown.removeRelation(this._list,14),this.dropdown.displayObject.on("undisplay",this,this.__popupWinClosed)}this.on("mouseover",this,this.__rollover),this.on("mouseout",this,this.__rollout),this.on("mousedown",this,this.__mousedown)},s.setup_afterAdd=function(t){if(fairygui.GObject.prototype.setup_afterAdd.call(this,t),t=et.findChildNode(t,"ComboBox")){var i;i=t.getAttribute("titleColor"),i&&(this.titleColor=i),i=t.getAttribute("visibleItemCount"),i&&(this._visibleItemCount=parseInt(i));for(var e=t.childNodes,s=e.length,n=0;s>n;n++){var r=e[n];"item"==r.nodeName&&(this._items.push(r.getAttribute("title")),this._values.push(r.getAttribute("value")),i=r.getAttribute("icon"),i&&(this._icons||(this._icons=new Array(s)),this._icons[n]=i))}i=t.getAttribute("title"),i?(this.text=i,this._selectedIndex=this._items.indexOf(i)):this._items.length>0?(this._selectedIndex=0,this.text=this._items[0]):this._selectedIndex=-1,i=t.getAttribute("icon"),i&&(this.icon=i),i=t.getAttribute("direction"),i&&("up"==i?this._popupDownward=!1:"auto"==i&&(this._popupDownward=null))}},s.showDropdown=function(){if(this._itemsUpdated){this._itemsUpdated=!1,this._list.removeChildrenToPool();for(var t=this._items.length,i=0;t>i;i++){var e=this._list.addItemFromPool();e.name=i<this._values.length?this._values[i]:"",e.text=this._items[i],e.icon=null!=this._icons&&i<this._icons.length?this._icons[i]:null}this._list.resizeToFit(this._visibleItemCount)}this._list.selectedIndex=-1,this.dropdown.width=this.width,this.root.togglePopup(this.dropdown,this,this._popupDownward),this.dropdown.parent&&this.setState("down")},s.__popupWinClosed=function(){this._over?this.setState("over"):this.setState("up")},s.__clickItem=function(t,i){e.timer.callLater(this,this.__clickItem2,[this._list.getChildIndex(t),i])},s.__clickItem2=function(t,i){this.dropdown.parent instanceof fairygui.GRoot&&this.dropdown.parent.hidePopup(),this._selectedIndex=-1,this.selectedIndex=t,L.dispatch("fui_state_changed",this.displayObject,i)},s.__rollover=function(){this._over=!0,this._down||this.dropdown&&this.dropdown.parent||this.setState("over")},s.__rollout=function(){this._over=!1,this._down||this.dropdown&&this.dropdown.parent||this.setState("up")},s.__mousedown=function(t){t.target instanceof laya.display.Input||(this._down=!0,kt.inst.checkPopups(t.target),e.stage.on("mouseup",this,this.__mouseup),this.dropdown&&this.showDropdown())},s.__mouseup=function(){this._down&&(this._down=!1,e.stage.off("mouseup",this,this.__mouseup),this.dropdown&&!this.dropdown.parent&&(this._over?this.setState("over"):this.setState("up")))},r(0,s,"text",function(){return this._titleObject?this._titleObject.text:null},function(t){this._titleObject&&(this._titleObject.text=t),this.updateGear(6)}),r(0,s,"titleColor",function(){return this._titleObject instanceof fairygui.GTextField?this._titleObject.color:this._titleObject instanceof fairygui.GLabel?this._titleObject.titleColor:this._titleObject instanceof fairygui.GButton?this._titleObject.titleColor:"#000000"},function(t){this._titleObject instanceof fairygui.GTextField?this._titleObject.color=t:this._titleObject instanceof fairygui.GLabel?this._titleObject.titleColor=t:this._titleObject instanceof fairygui.GButton&&(this._titleObject.titleColor=t)}),r(0,s,"selectedIndex",function(){return this._selectedIndex},function(t){this._selectedIndex!=t&&(this._selectedIndex=t,this._selectedIndex>=0&&this._selectedIndex<this._items.length?(this.text=this._items[this._selectedIndex],null!=this._icons&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])):(this.text="",null!=this._icons&&(this.icon=null)))}),r(0,s,"icon",function(){return this._iconObject?this._iconObject.icon:null},function(t){this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)}),r(0,s,"icons",function(){return this._icons},function(t){this._icons=t,null!=this._icons&&-1!=this._selectedIndex&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])}),r(0,s,"visibleItemCount",function(){return this._visibleItemCount},function(t){this._visibleItemCount=t}),r(0,s,"popupDownward",function(){return this._popupDownward},function(t){this._popupDownward=t}),r(0,s,"values",function(){return this._values},function(t){t?this._values=t.concat():this._values.length=0}),r(0,s,"items",function(){return this._items},function(t){t?this._items=t.concat():this._items.length=0,this._items.length>0?(this._selectedIndex>=this._items.length?this._selectedIndex=this._items.length-1:-1==this._selectedIndex&&(this._selectedIndex=0),this.text=this._items[this._selectedIndex],null!=this._icons&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])):(this.text="",null!=this._icons&&(this.icon=null),this._selectedIndex=-1),this._itemsUpdated=!0}),r(0,s,"value",function(){return this._values[this._selectedIndex]},function(t){this.selectedIndex=this._values.indexOf(t)}),i}(at),Ct=function(t){function i(){this._titleObject=null,this._iconObject=null,i.__super.call(this)}n(i,"fairygui.GLabel",t);var e=i.prototype;return e.constructFromXML=function(i){t.prototype.constructFromXML.call(this,i),this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon")},e.setup_afterAdd=function(t){if(fairygui.GObject.prototype.setup_afterAdd.call(this,t),t=et.findChildNode(t,"Label")){var i;i=t.getAttribute("title"),i&&(this.text=i),i=t.getAttribute("icon"),i&&(this.icon=i),i=t.getAttribute("titleColor"),i&&(this.titleColor=i),this._titleObject instanceof fairygui.GTextInput&&(i=t.getAttribute("prompt"),i&&(this._titleObject.promptText=i),i=t.getAttribute("maxLength"),i&&(this._titleObject.maxLength=parseInt(i)),i=t.getAttribute("restrict"),i&&(this._titleObject.restrict=i),i=t.getAttribute("password"),i&&(this._titleObject.password="true"==i),i=t.getAttribute("keyboardType"),"4"==i?this._titleObject.keyboardType="number":"3"==i&&(this._titleObject.keyboardType="url"))}},r(0,e,"icon",function(){return null!=this._iconObject?this._iconObject.icon:null},function(t){null!=this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)}),r(0,e,"editable",function(){return this._titleObject&&this._titleObject instanceof fairygui.GTextInput?this._titleObject.asTextInput.editable:!1},function(t){this._titleObject&&(this._titleObject.asTextInput.editable=t)}),r(0,e,"title",function(){return this._titleObject?this._titleObject.text:null},function(t){this._titleObject&&(this._titleObject.text=t),this.updateGear(6)}),r(0,e,"text",function(){return this.title},function(t){this.title=t}),r(0,e,"titleColor",function(){return this._titleObject instanceof fairygui.GTextField?this._titleObject.color:this._titleObject instanceof fairygui.GLabel?this._titleObject.titleColor:this._titleObject instanceof fairygui.GButton?this._titleObject.titleColor:"#000000"},function(t){this._titleObject instanceof fairygui.GTextField?this._titleObject.color=t:this._titleObject instanceof fairygui.GLabel?this._titleObject.titleColor=t:this._titleObject instanceof fairygui.GButton&&(this._titleObject.titleColor=t)}),i}(at),St=function(t){function i(){this.itemRenderer=null,this.itemProvider=null,this.scrollItemToViewOnClick=!1,this.foldInvisibleItems=!1,this._layout=0,this._lineItemCount=0,this._lineGap=0,this._columnGap=0,this._defaultItem=null,this._autoResizeItem=!1,this._selectionMode=0,this._align=null,this._verticalAlign=null,this._lastSelectedIndex=0,this._pool=null,this._virtual=!1,this._loop=!1,this._numItems=0,this._realNumItems=0,this._firstIndex=0,this._curLineItemCount=0,this._curLineItemCount2=0,this._itemSize=null,this._virtualListChanged=0,this._virtualItems=null,this._eventLocked=!1,i.__super.call(this),this._trackBounds=!0,this._pool=new N,this._layout=0,this._autoResizeItem=!0,this._lastSelectedIndex=-1,this._selectionMode=0,this.opaque=!0,this.scrollItemToViewOnClick=!0,this._align="left",this._verticalAlign="top",this._container=new b,this._displayObject.addChild(this._container)}var s;n(i,"fairygui.GList",t);var h=i.prototype;return h.dispose=function(){this._pool.clear(),t.prototype.dispose.call(this)},h.getFromPool=function(t){t||(t=this._defaultItem);var i=this._pool.getObject(t);return null!=i&&(i.visible=!0),i},h.returnToPool=function(t){t.displayObject.cacheAsBitmap=!1,this._pool.returnObject(t)},h.addChildAt=function(i,e){if(void 0===e&&(e=0),this._autoResizeItem&&(0==this._layout?i.width=this.viewWidth:1==this._layout&&(i.height=this.viewHeight)),t.prototype.addChildAt.call(this,i,e),i instanceof fairygui.GButton){var s=i;s.selected=!1,s.changeStateOnClick=!1}return i.on("click",this,this.__clickItem),i},h.addItem=function(t){return t||(t=this._defaultItem),this.addChild(it.createObjectFromURL(t))},h.addItemFromPool=function(t){return this.addChild(this.getFromPool(t))},h.removeChildAt=function(i,e){void 0===e&&(e=!1);var s=t.prototype.removeChildAt.call(this,i,e);return s.off("click",this,this.__clickItem),s},h.removeChildToPoolAt=function(i){void 0===i&&(i=0);var e=t.prototype.removeChildAt.call(this,i);this.returnToPool(e)},h.removeChildToPool=function(t){this.removeChild(t),this.returnToPool(t)},h.removeChildrenToPool=function(t,i){void 0===t&&(t=0),void 0===i&&(i=-1),(0>i||i>=this._children.length)&&(i=this._children.length-1);for(var e=t;i>=e;++e)this.removeChildToPoolAt(t)},h.getSelection=function(){for(var t=[],i=this._children.length,e=0;i>e;e++){var s=this._children[e].asButton;null!=s&&s.selected&&t.push(this.childIndexToItemIndex(e))}return t},h.addSelection=function(t,i){if(void 0===i&&(i=!1),3!=this._selectionMode&&(this.checkVirtualList(),0==this._selectionMode&&this.clearSelection(),i&&this.scrollToView(t),t=this.itemIndexToChildIndex(t),!(0>t||t>=this._children.length))){var e=this.getChildAt(t).asButton;null==e||e.selected||(e.selected=!0)}},h.removeSelection=function(t){if(void 0===t&&(t=0),3!=this._selectionMode&&(t=this.itemIndexToChildIndex(t),!(t>=this._children.length))){var i=this.getChildAt(t).asButton;null!=i&&i.selected&&(i.selected=!1)}},h.clearSelection=function(){for(var t=this._children.length,i=0;t>i;i++){var e=this._children[i].asButton;null!=e&&(e.selected=!1)}},h.selectAll=function(){this.checkVirtualList();for(var t=this._children.length,i=0;t>i;i++){var e=this._children[i].asButton;null!=e&&(e.selected=!0)}},h.selectNone=function(){this.checkVirtualList();for(var t=this._children.length,i=0;t>i;i++){var e=this._children[i].asButton;null!=e&&(e.selected=!1)}},h.selectReverse=function(){for(var t=this._children.length,i=0;t>i;i++){var e=this._children[i].asButton;null!=e&&(e.selected=!e.selected)}},h.handleArrowKey=function(t){void 0===t&&(t=0);var i=this.selectedIndex;if(-1!=i)switch(t){case 1:if(0==this._layout||3==this._layout)i--,i>=0&&(this.clearSelection(),this.addSelection(i,!0));else if(2==this._layout||4==this._layout){for(var e=this._children[i],s=0,n=i-1;n>=0;n--){var r=this._children[n];if(r.y!=e.y){e=r;break}s++}for(;n>=0;n--)if(r=this._children[n],r.y!=e.y){this.clearSelection(),this.addSelection(n+s+1,!0);break}}break;case 3:if(1==this._layout||2==this._layout||4==this._layout)i++,i<this._children.length&&(this.clearSelection(),this.addSelection(i,!0));else if(3==this._layout){e=this._children[i],s=0;var h=this._children.length;for(n=i+1;h>n;n++){if(r=this._children[n],r.x!=e.x){e=r;break}s++}for(;h>n;n++)if(r=this._children[n],r.x!=e.x){this.clearSelection(),this.addSelection(n-s-1,!0);break}}break;case 5:if(0==this._layout||3==this._layout)i++,i<this._children.length&&(this.clearSelection(),this.addSelection(i,!0));else if(2==this._layout||4==this._layout){for(e=this._children[i],s=0,h=this._children.length,n=i+1;h>n;n++){if(r=this._children[n],r.y!=e.y){e=r;break}s++}for(;h>n;n++)if(r=this._children[n],r.y!=e.y){this.clearSelection(),this.addSelection(n-s-1,!0);break}}break;case 7:if(1==this._layout||2==this._layout||4==this._layout)i--,i>=0&&(this.clearSelection(),this.addSelection(i,!0));else if(3==this._layout){for(e=this._children[i],s=0,n=i-1;n>=0;n--){if(r=this._children[n],r.x!=e.x){e=r;break}s++}for(;n>=0;n--)if(r=this._children[n],r.x!=e.x){this.clearSelection(),this.addSelection(n+s+1,!0);break}}}},h.__clickItem=function(t){if(null==this._scrollPane||!this._scrollPane._isMouseMoved){var i=M.cast(t.currentTarget);this.setSelectionOnEvent(i,t),this.scrollPane&&this.scrollItemToViewOnClick&&this.scrollPane.scrollToView(i,!0),this.displayObject.event("fui_click_item",[i,L.createEvent("fui_click_item",this.displayObject,t)])}},h.setSelectionOnEvent=function(t,i){if(t instanceof fairygui.GButton&&3!=this._selectionMode){var e=!1,s=t,n=this.getChildIndex(t);if(0==this._selectionMode)s.selected||(this.clearSelectionExcept(s),s.selected=!0);else if(i.shiftKey){if(!s.selected)if(-1!=this._lastSelectedIndex){var r=Math.min(this._lastSelectedIndex,n),h=Math.max(this._lastSelectedIndex,n);h=Math.min(h,this._children.length-1);for(var a=r;h>=a;a++){var o=this.getChildAt(a).asButton;null==o||o.selected||(o.selected=!0)}e=!0}else s.selected=!0}else i.ctrlKey||2==this._selectionMode?s.selected=!s.selected:s.selected?this.clearSelectionExcept(s):(this.clearSelectionExcept(s),s.selected=!0);e||(this._lastSelectedIndex=n)}},h.clearSelectionExcept=function(t){for(var i=this._children.length,e=0;i>e;e++){var s=this._children[e].asButton;null!=s&&s!=t&&s.selected&&(s.selected=!1)}},h.resizeToFit=function(t,i){void 0===t&&(t=1e6),void 0===i&&(i=0),this.ensureBoundsCorrect();var e=this.numItems;if(t>e&&(t=e),this._virtual){var s=Math.ceil(t/this._curLineItemCount);0==this._layout||2==this._layout?this.viewHeight=s*this._itemSize.y+Math.max(0,s-1)*this._lineGap:this.viewWidth=s*this._itemSize.x+Math.max(0,s-1)*this._columnGap}else if(0==t)0==this._layout||2==this._layout?this.viewHeight=i:this.viewWidth=i;else{for(var n=t-1,r=null;n>=0&&(r=this.getChildAt(n),this.foldInvisibleItems&&!r.visible);)n--;if(0>n)0==this._layout||2==this._layout?this.viewHeight=i:this.viewWidth=i;else{var h=0;0==this._layout||2==this._layout?(h=r.y+r.height,i>h&&(h=i),this.viewHeight=h):(h=r.x+r.width,i>h&&(h=i),this.viewWidth=h)}}},h.getMaxItemWidth=function(){for(var t=this._children.length,i=0,e=0;t>e;e++){var s=this.getChildAt(e);s.width>i&&(i=s.width)}return i},h.handleSizeChanged=function(){t.prototype.handleSizeChanged.call(this),this._autoResizeItem&&this.adjustItemsSize(),2!=this._layout&&3!=this._layout||(this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},h.adjustItemsSize=function(){if(0==this._layout)for(var t=this._children.length,i=this.viewWidth,e=0;t>e;e++){var s=this.getChildAt(e);s.width=i}else if(1==this._layout){t=this._children.length;var n=this.viewHeight;for(e=0;t>e;e++)s=this.getChildAt(e),s.height=n}},h.getSnappingPosition=function(i,e,s){if(this._virtual){s||(s=new m);var n=NaN,r=0;return 0==this._layout||2==this._layout?(n=e,fairygui.GList.pos_param=e,r=this.getIndexOnPos1(!1),e=fairygui.GList.pos_param,r<this._virtualItems.length&&n-e>this._virtualItems[r].height/2&&r<this._realNumItems&&(e+=this._virtualItems[r].height+this._lineGap)):1==this._layout||3==this._layout?(n=i,fairygui.GList.pos_param=i,r=this.getIndexOnPos2(!1),i=fairygui.GList.pos_param,r<this._virtualItems.length&&n-i>this._virtualItems[r].width/2&&r<this._realNumItems&&(i+=this._virtualItems[r].width+this._columnGap)):(n=i,fairygui.GList.pos_param=i,r=this.getIndexOnPos3(!1),i=fairygui.GList.pos_param,r<this._virtualItems.length&&n-i>this._virtualItems[r].width/2&&r<this._realNumItems&&(i+=this._virtualItems[r].width+this._columnGap)),s.x=i,s.y=e,s}return t.prototype.getSnappingPosition.call(this,i,e,s)},h.scrollToView=function(t,i,e){if(void 0===i&&(i=!1),void 0===e&&(e=!1),this._virtual){if(this.checkVirtualList(),t>=this._virtualItems.length)throw new Error("Invalid child index: "+t+">"+this._virtualItems.length);var s,n=this._virtualItems[t],r=0,h=0;if(0==this._layout||2==this._layout){for(h=0;t>h;h+=this._curLineItemCount)r+=this._virtualItems[h].height+this._lineGap;s=new y(0,r,this._itemSize.x,n.height)}else if(1==this._layout||3==this._layout){for(h=0;t>h;h+=this._curLineItemCount)r+=this._virtualItems[h].width+this._columnGap;s=new y(r,0,n.width,this._itemSize.y)}else{var a=t/(this._curLineItemCount*this._curLineItemCount2);s=new y(a*this.viewWidth+t%this._curLineItemCount*(n.width+this._columnGap),t/this._curLineItemCount%this._curLineItemCount2*(n.height+this._lineGap),n.width,n.height)}e=!0,null!=this._scrollPane&&this.scrollPane.scrollToView(s,i,e)}else{var o=this.getChildAt(t);null!=this._scrollPane?this.scrollPane.scrollToView(o,i,e):null!=this.parent&&null!=this.parent.scrollPane&&this.parent.scrollPane.scrollToView(o,i,e)}},h.getFirstChildInView=function(){return this.childIndexToItemIndex(t.prototype.getFirstChildInView.call(this))},h.childIndexToItemIndex=function(t){if(!this._virtual)return t;if(4==this._layout){for(var i=this._firstIndex;i<this._realNumItems;i++)if(null!=this._virtualItems[i].obj&&(t--,0>t))return i;return t}return t+=this._firstIndex,this._loop&&this._numItems>0&&(t%=this._numItems),t},h.itemIndexToChildIndex=function(t){if(!this._virtual)return t;if(4==this._layout)return this.getChildIndex(this._virtualItems[t].obj);if(this._loop&&this._numItems>0){var i=this._firstIndex%this._numItems;t=t>=i?this._firstIndex+(t-i):this._firstIndex+this._numItems+(i-t)}else t-=this._firstIndex;return t},h.setVirtual=function(){this._setVirtual(!1)},h.setVirtualAndLoop=function(){this._setVirtual(!0)},h._setVirtual=function(t){if(!this._virtual){if(null==this.scrollPane)throw new Error("Virtual list must be scrollable!");if(t){if(2==this._layout||3==this._layout)throw new Error("Loop list is not supported for FlowHorizontal or FlowVertical layout!");this.scrollPane.bouncebackEffect=!1}if(this._virtual=!0,this._loop=t,this._virtualItems=[],this.removeChildrenToPool(),null==this._itemSize){this._itemSize=new m;var i=this.getFromPool(null);if(null==i)throw new Error("Virtual List must have a default list item resource.");this._itemSize.x=i.width,this._itemSize.y=i.height,this.returnToPool(i)}0==this._layout||2==this._layout?this.scrollPane.scrollSpeed=this._itemSize.y:this.scrollPane.scrollSpeed=this._itemSize.x,this.on("fui_scroll",this,this.__scrolled),this.setVirtualListChangedFlag(!0)}},h.refreshVirtualList=function(){this.setVirtualListChangedFlag(!1)},h.checkVirtualList=function(){0!=this._virtualListChanged&&(this._refreshVirtualList(),e.timer.clear(this,this._refreshVirtualList))},h.setVirtualListChangedFlag=function(t){void 0===t&&(t=!1),t?this._virtualListChanged=2:0==this._virtualListChanged&&(this._virtualListChanged=1),e.timer.callLater(this,this._refreshVirtualList)},h._refreshVirtualList=function(){var t=2==this._virtualListChanged;this._virtualListChanged=0,this._eventLocked=!0,t&&(0==this._layout||1==this._layout?this._curLineItemCount=1:0!=this._lineItemCount?this._curLineItemCount=this._lineItemCount:2==this._layout?(this._curLineItemCount=Math.floor((this._scrollPane.viewWidth+this._columnGap)/(this._itemSize.x+this._columnGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)):3==this._layout?(this._curLineItemCount=Math.floor((this._scrollPane.viewHeight+this._lineGap)/(this._itemSize.y+this._lineGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)):(this._curLineItemCount=Math.floor((this._scrollPane.viewWidth+this._columnGap)/(this._itemSize.x+this._columnGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)),4==this._layout&&(this._curLineItemCount2=Math.floor((this._scrollPane.viewHeight+this._lineGap)/(this._itemSize.y+this._lineGap)),this._curLineItemCount2<=0&&(this._curLineItemCount2=1)));var i=0,e=0;if(this._realNumItems>0){var s=0,n=Math.ceil(this._realNumItems/this._curLineItemCount)*this._curLineItemCount;if(0==this._layout||2==this._layout){for(s=0;n>s;s+=this._curLineItemCount)i+=this._virtualItems[s].height+this._lineGap;i>0&&(i-=this._lineGap),e=this._scrollPane.contentWidth}else if(1==this._layout||3==this._layout){for(s=0;n>s;s+=this._curLineItemCount)e+=this._virtualItems[s].width+this._columnGap;e>0&&(e-=this._columnGap),i=this._scrollPane.contentHeight}else{var r=Math.ceil(n/(this._curLineItemCount*this._curLineItemCount2));e=r*this.viewWidth,i=this.viewHeight}}this.handleAlign(e,i),this._scrollPane.setContentSize(e,i),this._eventLocked=!1,this.handleScroll(!0)},h.__scrolled=function(t){this.handleScroll(!1)},h.getIndexOnPos1=function(t){if(this._realNumItems<this._curLineItemCount)return i.pos_param=0,0;var e=0,s=NaN,n=NaN;if(this.numChildren>0&&!t){if(s=this.getChildAt(0).y,s>i.pos_param){for(e=this._firstIndex-this._curLineItemCount;e>=0;e-=this._curLineItemCount)if(s-=this._virtualItems[e].height+this._lineGap,s<=i.pos_param)return i.pos_param=s,e;return i.pos_param=0,0}for(e=this._firstIndex;e<this._realNumItems;e+=this._curLineItemCount){if(n=s+this._virtualItems[e].height+this._lineGap,n>i.pos_param)return i.pos_param=s,e;s=n}return i.pos_param=s,this._realNumItems-this._curLineItemCount}for(s=0,e=0;e<this._realNumItems;e+=this._curLineItemCount){if(n=s+this._virtualItems[e].height+this._lineGap,n>i.pos_param)return i.pos_param=s,e;s=n}return i.pos_param=s,this._realNumItems-this._curLineItemCount},h.getIndexOnPos2=function(t){if(this._realNumItems<this._curLineItemCount)return i.pos_param=0,0;var e=0,s=NaN,n=NaN;if(this.numChildren>0&&!t){if(s=this.getChildAt(0).x,s>i.pos_param){for(e=this._firstIndex-this._curLineItemCount;e>=0;e-=this._curLineItemCount)if(s-=this._virtualItems[e].width+this._columnGap,s<=i.pos_param)return i.pos_param=s,e;return i.pos_param=0,0}for(e=this._firstIndex;e<this._realNumItems;e+=this._curLineItemCount){if(n=s+this._virtualItems[e].width+this._columnGap,
n>i.pos_param)return i.pos_param=s,e;s=n}return i.pos_param=s,this._realNumItems-this._curLineItemCount}for(s=0,e=0;e<this._realNumItems;e+=this._curLineItemCount){if(n=s+this._virtualItems[e].width+this._columnGap,n>i.pos_param)return i.pos_param=s,e;s=n}return i.pos_param=s,this._realNumItems-this._curLineItemCount},h.getIndexOnPos3=function(t){if(this._realNumItems<this._curLineItemCount)return i.pos_param=0,0;var e=this.viewWidth,s=Math.floor(i.pos_param/e),n=s*(this._curLineItemCount*this._curLineItemCount2),r=s*e,h=0,a=NaN;for(h=0;h<this._curLineItemCount;h++){if(a=r+this._virtualItems[n+h].width+this._columnGap,a>i.pos_param)return i.pos_param=r,n+h;r=a}return i.pos_param=r,n+this._curLineItemCount-1},h.handleScroll=function(t){if(!this._eventLocked){var i=NaN,e=0;0==this._layout||2==this._layout?(this._loop&&(i=this.scrollPane.scrollingPosY,e=this._numItems*(this._itemSize.y+this._lineGap),0==i?this.scrollPane.posY=e:i==this.scrollPane.contentHeight-this.scrollPane.viewHeight&&(this.scrollPane.posY=this.scrollPane.contentHeight-e-this.viewHeight)),this.handleScroll1(t)):1==this._layout||3==this._layout?(this._loop&&(i=this.scrollPane.scrollingPosX,e=this._numItems*(this._itemSize.x+this._columnGap),0==i?this.scrollPane.posX=e:i==this.scrollPane.contentWidth-this.scrollPane.viewWidth&&(this.scrollPane.posX=this.scrollPane.contentWidth-e-this.viewWidth)),this.handleScroll2(t)):(this._loop&&(i=this.scrollPane.scrollingPosX,e=int(this._numItems/(this._curLineItemCount*this._curLineItemCount2))*this.viewWidth,0==i?this.scrollPane.posX=e:i==this.scrollPane.contentWidth-this.scrollPane.viewWidth&&(this.scrollPane.posX=this.scrollPane.contentWidth-e-this.viewWidth)),this.handleScroll3(t)),this._boundsChanged=!1}},h.handleScroll1=function(t){if(i.enterCounter++,!(i.enterCounter>3)){var e=this.scrollPane.scrollingPosY,s=e+this.scrollPane.viewHeight,n=s==this.scrollPane.contentHeight;fairygui.GList.pos_param=e;var r=this.getIndexOnPos1(t);if(e=fairygui.GList.pos_param,r==this._firstIndex&&!t)return void i.enterCounter--;var h=this._firstIndex;this._firstIndex=r;var a,o,l=r,u=h>r,_=this.numChildren,c=h+_-1,d=u?c:h,g=0,f=e,p=!1,m=0,y=0,v=this.defaultItem,b=0,w=0;for(i.itemInfoVer++;l<this._realNumItems&&(n||s>f);){if(a=this._virtualItems[l],(null==a.obj||t)&&(null!=this.itemProvider&&(v=this.itemProvider.runWith(l%this._numItems),null==v&&(v=this.defaultItem)),null!=a.obj&&a.obj.resourceURL!=v&&(this.removeChild(a.obj),a.obj=null)),null==a.obj){if(u){for(w=d;w>=h;w--)if(o=this._virtualItems[w],null!=o.obj&&o.updateFlag!=i.itemInfoVer&&o.obj.resourceURL==v){a.obj=o.obj,o.obj=null,w==d&&d--;break}}else for(w=d;c>=w;w++)if(o=this._virtualItems[w],null!=o.obj&&o.updateFlag!=i.itemInfoVer&&o.obj.resourceURL==v){a.obj=o.obj,o.obj=null,w==d&&d++;break}null!=a.obj?this.setChildIndex(a.obj,u?l-r:this.numChildren):(a.obj=this._pool.getObject(v),u?this.addChildAt(a.obj,l-r):this.addChild(a.obj)),a.obj instanceof fairygui.GButton&&(a.obj.selected=!1),p=!0}else p=t;p&&(this.itemRenderer.runWith([l%this._numItems,a.obj]),l%this._curLineItemCount==0&&(m+=Math.ceil(a.obj.height)-a.height,l==r&&h>r&&(y=Math.ceil(a.obj.height)-a.height)),a.width=Math.ceil(a.obj.width),a.height=Math.ceil(a.obj.height)),a.updateFlag=i.itemInfoVer,a.obj.setXY(g,f),l==r&&(s+=a.height),g+=a.width+this._columnGap,l%this._curLineItemCount==this._curLineItemCount-1&&(g=0,f+=a.height+this._lineGap),l++}for(b=0;_>b;b++)a=this._virtualItems[h+b],a.updateFlag!=i.itemInfoVer&&null!=a.obj&&(this.removeChild(a.obj),a.obj=null);0==m&&0==y||this._scrollPane.changeContentSizeOnScrolling(0,m,0,y),l>0&&this.numChildren>0&&this._container.y<0&&this.getChildAt(0).y>-this._container.y&&this.handleScroll1(!1),i.enterCounter--}},h.handleScroll2=function(t){if(i.enterCounter++,!(i.enterCounter>3)){var e=this.scrollPane.scrollingPosX,s=e+this.scrollPane.viewWidth,n=e==this.scrollPane.contentWidth;fairygui.GList.pos_param=e;var r=this.getIndexOnPos2(t);if(e=fairygui.GList.pos_param,r==this._firstIndex&&!t)return void i.enterCounter--;var h=this._firstIndex;this._firstIndex=r;var a,o,l=r,u=h>r,_=this.numChildren,c=h+_-1,d=u?c:h,g=e,f=0,p=!1,m=0,y=0,v=this.defaultItem,b=0,w=0;for(i.itemInfoVer++;l<this._realNumItems&&(n||s>g);){if(a=this._virtualItems[l],(null==a.obj||t)&&(null!=this.itemProvider&&(v=this.itemProvider.runWith(l%this._numItems),null==v&&(v=this.defaultItem)),null!=a.obj&&a.obj.resourceURL!=v&&(this.removeChild(a.obj),a.obj=null)),null==a.obj){if(u){for(w=d;w>=h;w--)if(o=this._virtualItems[w],null!=o.obj&&o.updateFlag!=i.itemInfoVer&&o.obj.resourceURL==v){a.obj=o.obj,o.obj=null,w==d&&d--;break}}else for(w=d;c>=w;w++)if(o=this._virtualItems[w],null!=o.obj&&o.updateFlag!=i.itemInfoVer&&o.obj.resourceURL==v){a.obj=o.obj,o.obj=null,w==d&&d++;break}null!=a.obj?this.setChildIndex(a.obj,u?l-r:this.numChildren):(a.obj=this._pool.getObject(v),u?this.addChildAt(a.obj,l-r):this.addChild(a.obj)),a.obj instanceof fairygui.GButton&&(a.obj.selected=!1),p=!0}else p=t;p&&(this.itemRenderer.runWith([l%this._numItems,a.obj]),l%this._curLineItemCount==0&&(m+=Math.ceil(a.obj.width)-a.width,l==r&&h>r&&(y=Math.ceil(a.obj.width)-a.width)),a.width=Math.ceil(a.obj.width),a.height=Math.ceil(a.obj.height)),a.updateFlag=i.itemInfoVer,a.obj.setXY(g,f),l==r&&(s+=a.width),f+=a.height+this._lineGap,l%this._curLineItemCount==this._curLineItemCount-1&&(f=0,g+=a.width+this._columnGap),l++}for(b=0;_>b;b++)a=this._virtualItems[h+b],a.updateFlag!=i.itemInfoVer&&null!=a.obj&&(this.removeChild(a.obj),a.obj=null);0==m&&0==y||this._scrollPane.changeContentSizeOnScrolling(m,0,y,0),l>0&&this.numChildren>0&&this._container.x<0&&this.getChildAt(0).x>-this._container.x&&this.handleScroll2(!1),i.enterCounter--}},h.handleScroll3=function(t){var e=this.scrollPane.scrollingPosX;fairygui.GList.pos_param=e;var s=this.getIndexOnPos3(t);if(e=fairygui.GList.pos_param,s!=this._firstIndex||t){var n=this._firstIndex;this._firstIndex=s;var r,h,a=n,o=this._virtualItems.length,l=this._curLineItemCount*this._curLineItemCount2,u=s%this._curLineItemCount,_=this.viewWidth,c=int(s/l),d=c*l,g=d+2*l,f=!1,p=0,m=0;for(i.itemInfoVer++,p=d;g>p;p++)if(!(p>=this._realNumItems)){if(m=p%this._curLineItemCount,l>p-d){if(u>m)continue}else if(m>u)continue;r=this._virtualItems[p],r.updateFlag=i.itemInfoVer}var y=null,v=0;for(p=d;g>p;p++)if(!(p>=this._realNumItems)){if(m=p%this._curLineItemCount,l>p-d){if(u>m)continue}else if(m>u)continue;if(r=this._virtualItems[p],null==r.obj){for(;o>a;){if(h=this._virtualItems[a],null!=h.obj&&h.updateFlag!=i.itemInfoVer){r.obj=h.obj,h.obj=null;break}a++}-1==v&&(v=this.getChildIndex(y)+1),null==r.obj?(r.obj=this._pool.getObject(this.defaultItem),this.addChildAt(r.obj,v)):v=this.setChildIndexBefore(r.obj,v),v++,r.obj instanceof fairygui.GButton&&(r.obj.selected=!1),f=!0}else f=t,v=-1,y=r.obj;f&&this.itemRenderer.runWith([p%this._numItems,r.obj]),r.obj.setXY(int(p/l)*_+m*(r.width+this._columnGap),p/this._curLineItemCount%this._curLineItemCount2*(r.height+this._lineGap))}for(p=a;o>p;p++)r=this._virtualItems[p],r.updateFlag!=i.itemInfoVer&&null!=r.obj&&(this.removeChild(r.obj),r.obj=null)}},h.handleAlign=function(t,i){var e=0,s=0;0==this._layout||2==this._layout||4==this._layout?i<this.viewHeight&&("middle"==this._verticalAlign?s=int((this.viewHeight-i)/2):"bottom"==this._verticalAlign&&(s=this.viewHeight-i)):t<this.viewWidth&&("center"==this._align?e=int((this.viewWidth-t)/2):"right"==this._align&&(e=this.viewWidth-t)),e==this._alignOffset.x&&s==this._alignOffset.y||(this._alignOffset.setTo(e,s),null!=this.scrollPane?this.scrollPane.adjustMaskContainer():(this._container.x=this._margin.left+this._alignOffset.x,this._container.y=this._margin.top+this._alignOffset.y))},h.updateBounds=function(){var t,i=0,e=0,s=0,n=0,r=0,h=NaN,a=0,o=0,l=0,u=0,_=this._children.length,c=this.viewWidth,d=this.viewHeight;for(i=0;_>i;i++)t=this.getChildAt(i),t.ensureSizeCorrect();if(0==this._layout){for(i=0;_>i;i++)t=this.getChildAt(i),this.foldInvisibleItems&&!t.visible||(o=Math.ceil(t.width),l=Math.ceil(t.height),0!=s&&(s+=this._lineGap),t.y=s,s+=l,o>n&&(n=o));h=e+n,a=s}else if(1==this._layout){for(i=0;_>i;i++)t=this.getChildAt(i),this.foldInvisibleItems&&!t.visible||(o=Math.ceil(t.width),l=Math.ceil(t.height),0!=e&&(e+=this._columnGap),t.x=e,e+=o,l>r&&(r=l));h=e,a=s+r}else if(2==this._layout){var g=0;for(i=0;_>i;i++)t=this.getChildAt(i),this.foldInvisibleItems&&!t.visible||(o=Math.ceil(t.width),l=Math.ceil(t.height),0!=e&&(e+=this._columnGap),(0!=this._lineItemCount&&g>=this._lineItemCount||0==this._lineItemCount&&e+o>c&&0!=r)&&(e-=this._columnGap,e>n&&(n=e),e=0,s+=r+this._lineGap,r=0,g=0),t.setXY(e,s),e+=o,l>r&&(r=l),g++);a=s+r,h=n}else if(3==this._layout){for(g=0,i=0;_>i;i++)t=this.getChildAt(i),t.visible&&(o=Math.ceil(t.width),l=Math.ceil(t.height),0!=s&&(s+=this._lineGap),(0!=this._lineItemCount&&g>=this._lineItemCount||0==this._lineItemCount&&s+l>d&&0!=n)&&(s-=this._lineGap,s>r&&(r=s),s=0,e+=n+this._columnGap,n=0,g=0),t.setXY(e,s),s+=l,o>n&&(n=o),g++);h=e+n,a=r}else{for(i=0;_>i;i++)t=this.getChildAt(i),this.foldInvisibleItems&&!t.visible||(o=Math.ceil(t.width),l=Math.ceil(t.height),0!=e&&(e+=this._columnGap),(0!=this._lineItemCount&&g>=this._lineItemCount||0==this._lineItemCount&&e+o>c&&0!=r)&&(e-=this._columnGap,e>n&&(n=e),e=0,s+=r+this._lineGap,r=0,g=0,s+l>d&&0!=n&&(u++,s=0)),t.setXY(u*c+e,s),e+=o,l>r&&(r=l),g++);a=s+r,h=(u+1)*c}this.handleAlign(h,a),this.setBounds(0,0,h,a)},h.setup_beforeAdd=function(t){fairygui.GObject.prototype.setup_beforeAdd.call(this,t);var i,e;i=t.getAttribute("layout"),i&&(this._layout=G.parse(i));var s=0;if(i=t.getAttribute("overflow"),s=i?V.parse(i):0,i=t.getAttribute("margin"),i&&this._margin.parse(i),i=t.getAttribute("align"),i&&(this._align=i),i=t.getAttribute("vAlign"),i&&(this._verticalAlign=i),2==s){var n=0;i=t.getAttribute("scroll"),n=i?Q.parse(i):1;var r=0;i=t.getAttribute("scrollBar"),r=i?$.parse(i):0;var h=NaN;i=t.getAttribute("scrollBarFlags"),h=i?parseInt(i):0;var a=new R;i=t.getAttribute("scrollBarMargin"),i&&a.parse(i);var o,l;i=t.getAttribute("scrollBarRes"),i&&(e=i.split(","),o=e[0],l=e[1]),this.setupScroll(a,n,r,h,o,l)}else this.setupOverflow(s);i=t.getAttribute("lineGap"),i&&(this._lineGap=parseInt(i)),i=t.getAttribute("colGap"),i&&(this._columnGap=parseInt(i)),i=t.getAttribute("lineItemCount"),i&&(this._lineItemCount=parseInt(i)),i=t.getAttribute("selectionMode"),i&&(this._selectionMode=W.parse(i)),i=t.getAttribute("defaultItem"),i&&(this._defaultItem=i),i=t.getAttribute("autoItemSize"),this._autoResizeItem="false"!=i;for(var u=t.childNodes,_=u.length,c=0;_>c;c++){var d=u[c];if("item"==d.nodeName){var g=d.getAttribute("url");if(g||(g=this._defaultItem),g){var f=this.getFromPool(g);null!=f&&(this.addChild(f),i=d.getAttribute("title"),i&&(f.text=i),i=d.getAttribute("icon"),i&&(f.icon=i),i=d.getAttribute("name"),i&&(f.name=i))}}}},r(0,h,"lineItemCount",function(){return this._lineItemCount},function(t){this._lineItemCount!=t&&(this._lineItemCount=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),r(0,h,"layout",function(){return this._layout},function(t){this._layout!=t&&(this._layout=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),r(0,h,"autoResizeItem",function(){return this._autoResizeItem},function(t){this._autoResizeItem=t}),r(0,h,"lineGap",function(){return this._lineGap},function(t){this._lineGap!=t&&(this._lineGap=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),r(0,h,"columnGap",function(){return this._columnGap},function(t){this._columnGap!=t&&(this._columnGap=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),r(0,h,"align",function(){return this._align},function(t){this._align!=t&&(this._align=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),r(0,h,"verticalAlign",function(){return this._verticalAlign},function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))}),r(0,h,"virtualItemSize",function(){return this._itemSize},function(t){this._virtual&&(null==this._itemSize&&(this._itemSize=new m),this._itemSize.setTo(t.x,t.y),this.setVirtualListChangedFlag(!0))}),r(0,h,"defaultItem",function(){return this._defaultItem},function(t){this._defaultItem=t}),r(0,h,"selectionMode",function(){return this._selectionMode},function(t){this._selectionMode=t}),r(0,h,"itemPool",function(){return this._pool}),r(0,h,"selectedIndex",function(){for(var t=this._children.length,i=0;t>i;i++){var e=this._children[i].asButton;if(null!=e&&e.selected)return this.childIndexToItemIndex(i)}return-1},function(t){this.clearSelection(),t>=0&&t<this.numItems&&this.addSelection(t)}),r(0,h,"numItems",function(){return this._virtual?this._numItems:this._children.length},function(t){var i=0;if(this._virtual){if(null==this.itemRenderer)throw new Error("Set itemRenderer first!");this._numItems=t,this._loop?this._realNumItems=5*this._numItems:this._realNumItems=this._numItems;var n=this._virtualItems.length;if(this._realNumItems>n)for(i=n;i<this._realNumItems;i++){var r=new s;r.width=this._itemSize.x,r.height=this._itemSize.y,this._virtualItems.push(r)}0!=this._virtualListChanged&&e.timer.clear(this,this._refreshVirtualList),this._refreshVirtualList()}else{var h=this._children.length;if(t>h)for(i=h;t>i;i++)null==this.itemProvider?this.addItemFromPool():this.addItemFromPool(this.itemProvider.runWith(i));else this.removeChildrenToPool(t,h);if(null!=this.itemRenderer)for(i=0;t>i;i++)this.itemRenderer.runWith([i,this.getChildAt(i)])}}),i.itemInfoVer=0,i.enterCounter=0,i.pos_param=NaN,i.__init$=function(){s=function(){function t(){this.width=0,this.height=0,this.obj=null,this.updateFlag=0}return n(t,""),t}()},i}(at),Ot=function(t){function i(){this.div=null,this._text=null,this._ubbEnabled=!1,this._color=null,i.__super.call(this),this._text=""}n(i,"fairygui.GRichTextField",t);var s=i.prototype;return e.imps(s,{"fairygui.IColorGear":!0}),s.createDisplayObject=function(){this._displayObject=this.div=new d,this._displayObject.mouseEnabled=!0,this._displayObject.$owner=this},s.handleSizeChanged=function(){this.div.size(this.width,this.height)},r(0,s,"bold",function(){return this.div.style.bold},function(t){this.div.style.bold=t}),r(0,s,"align",function(){return this.div.style.align},function(t){this.div.style.align=t}),r(0,s,"text",function(){return this._text},function(t){this._text=t,this._ubbEnabled?this.div.innerHTML=et.parseUBB(et.encodeHTML(this._text)):this.div.innerHTML=this._text}),r(0,s,"color",function(){return this._color},function(t){this._color!=t&&(this._color=t,this.div.color=t,this._gearColor.controller&&this._gearColor.updateState())}),r(0,s,"font",function(){return this.div.style.font},function(t){this.div.style.font=t}),r(0,s,"leading",function(){return this.div.style.leading},function(t){this.div.style.leading=t}),r(0,s,"fontSize",function(){return this.div.style.fontSize},function(t){this.div.style.fontSize=t}),r(0,s,"valign",function(){return this.div.style.valign},function(t){this.div.style.valign=t}),r(0,s,"italic",function(){return this.div.style.italic},function(t){this.div.style.italic=t}),r(0,s,"stroke",function(){return this.div.style.stroke},function(t){this.div.style.stroke=t}),r(0,s,"strokeColor",function(){return this.div.style.strokeColor},function(t){this.div.style.strokeColor=t}),r(0,s,"ubbEnabled",function(){return this._ubbEnabled},function(t){this._ubbEnabled=t}),i}(ht),Pt=function(t){function i(){this._max=0,this._value=0,this._titleType=0,this._reverse=!1,this._titleObject=null,this._aniObject=null,this._barObjectH=null,this._barObjectV=null,this._barMaxWidth=0,this._barMaxHeight=0,this._barMaxWidthDelta=0,this._barMaxHeightDelta=0,this._barStartX=0,this._barStartY=0,this._tweener=null,this._tweenValue=0,i.__super.call(this),this._titleType=0,this._value=50,this._max=100}n(i,"fairygui.GProgressBar",t);var e=i.prototype;return e.tweenValue=function(t,i){return this._value!=t?(this._tweener&&this._tweener.clear(),this._tweenValue=this._value,this._value=t,this._tweener=I.to(this,{_tweenValue:t},1e3*i,fairygui.GProgressBar.easeLinear),this._tweener.update=g.create(this,this.onUpdateTween,null,!1),this._tweener):null},e.onUpdateTween=function(){this.update(this._tweenValue)},e.update=function(t){var i=Math.min(t/this._max,1);if(this._titleObject)switch(this._titleType){case 0:this._titleObject.text=Math.round(100*i)+"%";break;case 1:this._titleObject.text=Math.round(t)+"/"+Math.round(this._max);break;case 2:this._titleObject.text=""+Math.round(t);break;case 3:this._titleObject.text=""+Math.round(this._max)}var e=this.width-this._barMaxWidthDelta,s=this.height-this._barMaxHeightDelta;this._reverse?(this._barObjectH&&(this._barObjectH.width=e*i,this._barObjectH.x=this._barStartX+(e-this._barObjectH.width)),this._barObjectV&&(this._barObjectV.height=s*i,this._barObjectV.y=this._barStartY+(s-this._barObjectV.height))):(this._barObjectH&&(this._barObjectH.width=e*i),this._barObjectV&&(this._barObjectV.height=s*i)),this._aniObject instanceof fairygui.GMovieClip&&(this._aniObject.frame=Math.round(100*i))},e.constructFromXML=function(i){t.prototype.constructFromXML.call(this,i),i=et.findChildNode(i,"ProgressBar");var e;e=i.getAttribute("titleType"),e&&(this._titleType=Y.parse(e)),this._reverse="true"==i.getAttribute("reverse"),this._titleObject=this.getChild("title"),this._barObjectH=this.getChild("bar"),this._barObjectV=this.getChild("bar_v"),this._aniObject=this.getChild("ani"),this._barObjectH&&(this._barMaxWidth=this._barObjectH.width,this._barMaxWidthDelta=this.width-this._barMaxWidth,this._barStartX=this._barObjectH.x),this._barObjectV&&(this._barMaxHeight=this._barObjectV.height,this._barMaxHeightDelta=this.height-this._barMaxHeight,this._barStartY=this._barObjectV.y)},e.handleSizeChanged=function(){t.prototype.handleSizeChanged.call(this),this._barObjectH&&(this._barMaxWidth=this.width-this._barMaxWidthDelta),this._barObjectV&&(this._barMaxHeight=this.height-this._barMaxHeightDelta),this._underConstruct||this.update(this._value)},e.setup_afterAdd=function(t){fairygui.GObject.prototype.setup_afterAdd.call(this,t),t=et.findChildNode(t,"ProgressBar"),t&&(this._value=parseInt(t.getAttribute("value")),this._max=parseInt(t.getAttribute("max"))),this.update(this._value)},e.dispose=function(){this._tweener&&this._tweener.clear(),t.prototype.dispose.call(this)},r(0,e,"max",function(){return this._max},function(t){this._max!=t&&(this._max=t,this.update(this._value))}),r(0,e,"titleType",function(){return this._titleType},function(t){this._titleType!=t&&(this._titleType=t,this.update(this._value))}),r(0,e,"value",function(){return this._value},function(t){null!=this._tweener&&(this._tweener.clear(),this._tweener=null),this._value!=t&&(this._value=t,this.update(this._value))}),s(i,["easeLinear",function(){return this.easeLinear=u.linearNone}]),i}(at),jt=function(t){function i(){this.input=null,i.__super.call(this)}n(i,"fairygui.GTextInput",t);var s=i.prototype;return e.imps(s,{"fairygui.IColorGear":!0}),s.createDisplayObject=function(){this._displayObject=this.input=new f,this._displayObject.mouseEnabled=!0,this._displayObject.$owner=this},s.handleSizeChanged=function(){this.input.size(this.width,this.height)},s.setup_beforeAdd=function(i){t.prototype.setup_beforeAdd.call(this,i);var e=i.getAttribute("prompt");e&&(this.promptText=e),e=i.getAttribute("maxLength"),e&&(this.input.maxChars=parseInt(e)),e=i.getAttribute("restrict"),e&&(this.input.restrict=e),"true"==i.getAttribute("password")?this.password=!0:(e=i.getAttribute("keyboardType"),"4"==e?this.keyboardType="number":"3"==e&&(this.keyboardType="url"))},r(0,s,"bold",function(){return this.input.bold},function(t){this.input.bold=t}),r(0,s,"align",function(){return this.input.align},function(t){this.input.align=t}),r(0,s,"text",function(){return this.input.text},function(t){this.input.text=t}),r(0,s,"password",function(){return"password"==this.input.type},function(t){t?this.input.type="password":this.input.type="text"}),r(0,s,"color",function(){return this.input.color},function(t){this.input.color=t}),r(0,s,"font",function(){return this.input.font},function(t){this.input.font=t}),r(0,s,"leading",function(){return this.input.leading},function(t){this.input.leading=t}),r(0,s,"maxLength",function(){return this.input.maxChars},function(t){this.input.maxChars=t}),r(0,s,"fontSize",function(){return this.input.fontSize},function(t){this.input.fontSize=t}),r(0,s,"valign",function(){return this.input.valign},function(t){this.input.valign=t}),r(0,s,"italic",function(){return this.input.italic},function(t){this.input.italic=t}),r(0,s,"singleLine",function(){return!this.input.multiline},function(t){this.input.multiline=!t}),r(0,s,"stroke",function(){return this.input.stroke},function(t){this.input.stroke=t}),r(0,s,"strokeColor",function(){return this.input.strokeColor},function(t){this.input.strokeColor=t}),r(0,s,"keyboardType",function(){return this.input.type},function(t){this.input.type=t}),r(0,s,"editable",function(){return this.input.editable},function(t){this.input.editable=t}),r(0,s,"promptText",function(){return this.input.prompt},function(t){this.input.prompt=t}),r(0,s,"restrict",function(){return this.input.restrict},function(t){this.input.restrict=t}),r(0,s,"textWidth",function(){return this.input.textWidth}),i}(ht),kt=function(t){function i(){this._modalLayer=null,this._popupStack=null,this._justClosedPopups=null,this._modalWaitPane=null,this._focusedObject=null,this._tooltipWin=null,this._defaultTooltipWin=null,this._volumeScale=0,this._checkPopups=!1,i.__super.call(this),null==fairygui.GRoot._inst&&(fairygui.GRoot._inst=this),this.opaque=!1,this._volumeScale=1,this._popupStack=[],this._justClosedPopups=[],this.displayObject.once("display",this,this.__addedToStage)}n(i,"fairygui.GRoot",t);var s=i.prototype;return s.showWindow=function(t){this.addChild(t),t.requestFocus(),t.x>this.width?t.x=this.width-t.width:t.x+t.width<0&&(t.x=0),t.y>this.height?t.y=this.height-t.height:t.y+t.height<0&&(t.y=0),this.adjustModalLayer()},s.hideWindow=function(t){t.hide()},s.hideWindowImmediately=function(t){t.parent==this&&this.removeChild(t),this.adjustModalLayer()},s.bringToFront=function(t){var i=this.numChildren,e=NaN;for(e=null==this._modalLayer.parent||t.modal?i-1:this.getChildIndex(this._modalLayer)-1;e>=0;e--){var s=this.getChildAt(e);if(s==t)return;if(s instanceof fairygui.Window)break}e>=0&&this.setChildIndex(t,e)},s.showModalWait=function(t){null!=J.globalModalWaiting&&(null==this._modalWaitPane&&(this._modalWaitPane=it.createObjectFromURL(J.globalModalWaiting)),this._modalWaitPane.setSize(this.width,this.height),this._modalWaitPane.addRelation(this,24),this.addChild(this._modalWaitPane),this._modalWaitPane.text=t)},s.closeModalWait=function(){null!=this._modalWaitPane&&null!=this._modalWaitPane.parent&&this.removeChild(this._modalWaitPane)},s.closeAllExceptModals=function(){for(var t=this._children.slice(),i=t.length,e=0;i>e;e++){var s=t[e];s instanceof fairygui.Window&&!s.modal&&s.hide()}},s.closeAllWindows=function(){for(var t=this._children.slice(),i=t.length,e=0;i>e;e++){var s=t[e];s instanceof fairygui.Window&&s.hide()}},s.getTopWindow=function(){for(var t=this.numChildren,i=t-1;i>=0;i--){var e=this.getChildAt(i);if(e instanceof fairygui.Window)return e}return null},s.showPopup=function(t,i,s){if(this._popupStack.length>0){var n=this._popupStack.indexOf(t);if(-1!=n)for(var r=this._popupStack.length-1;r>=n;r--)this.removeChild(this._popupStack.pop())}this._popupStack.push(t),this.addChild(t),this.adjustModalLayer();var h,a=NaN,o=0;i?(h=i.localToGlobal(),a=i.width,o=i.height):h=this.globalToLocal(e.stage.mouseX,e.stage.mouseY);var l=NaN,u=NaN;l=h.x,l+t.width>this.width&&(l=l+a-t.width),u=h.y+o,(null==s&&u+t.height>this.height||0==s)&&(u=h.y-t.height-1,0>u&&(u=0,l+=a/2)),t.x=l,t.y=u},s.togglePopup=function(t,i,e){-1==this._justClosedPopups.indexOf(t)&&this.showPopup(t,i,e)},s.hidePopup=function(t){if(null!=t){var i=this._popupStack.indexOf(t);if(-1!=i)for(var e=this._popupStack.length-1;e>=i;e--)this.closePopup(this._popupStack.pop())}else{var s=this._popupStack.length;for(e=s-1;e>=0;e--)this.closePopup(this._popupStack[e]);this._popupStack.length=0}},s.closePopup=function(t){null!=t.parent&&(t instanceof fairygui.Window?t.hide():this.removeChild(t))},s.showTooltips=function(t){if(null==this._defaultTooltipWin){var i=J.tooltipsWin;if(!i)return void p.print("UIConfig.tooltipsWin not defined");this._defaultTooltipWin=it.createObjectFromURL(i)}this._defaultTooltipWin.text=t,this.showTooltipsWin(this._defaultTooltipWin)},s.showTooltipsWin=function(t,i){this.hideTooltips(),this._tooltipWin=t;var s=0,n=0;null==i?(s=e.stage.mouseX+10,n=e.stage.mouseY+20):(s=i.x,n=i.y);var r=this.globalToLocal(s,n);s=r.x,n=r.y,s+this._tooltipWin.width>this.width&&(s=s-this._tooltipWin.width-1,0>s&&(s=10)),n+this._tooltipWin.height>this.height&&(n=n-this._tooltipWin.height-1,s-this._tooltipWin.width-1>0&&(s=s-this._tooltipWin.width-1),0>n&&(n=10)),this._tooltipWin.x=s,this._tooltipWin.y=n,this.addChild(this._tooltipWin)},s.hideTooltips=function(){null!=this._tooltipWin&&(this._tooltipWin.parent&&this.removeChild(this._tooltipWin),this._tooltipWin=null)},s.getObjectUnderPoint=function(t,i){return null},s.setFocus=function(t){this._focusedObject!=t&&(this._focusedObject=t,this.displayObject.event("fui_focus_changed"))},s.playOneShotSound=function(t,i){void 0===i&&(i=1);var e=this._volumeScale*i,s=t.play(0,1);s.volume=e},s.adjustModalLayer=function(){var t=this.numChildren;null!=this._modalWaitPane&&null!=this._modalWaitPane.parent&&this.setChildIndex(this._modalWaitPane,t-1);for(var i=t-1;i>=0;i--){var e=this.getChildAt(i);if(e instanceof fairygui.Window&&e.modal)return void(null==this._modalLayer.parent?this.addChildAt(this._modalLayer,i):this.setChildIndexBefore(this._modalLayer,i))}null!=this._modalLayer.parent&&this.removeChild(this._modalLayer)},s.__addedToStage=function(){e.stage.on("mousedown",this,this.__stageMouseDown),e.stage.on("mouseup",this,this.__stageMouseUp),this._modalLayer=new ct,this._modalLayer.setSize(this.width,this.height),this._modalLayer.drawRect(0,null,J.modalLayerColor),this._modalLayer.addRelation(this,24),this.displayObject.stage.on("resize",this,this.__winResize),this.__winResize()},s.checkPopups=function(t){if(!this._checkPopups&&(this._checkPopups=!0,this._justClosedPopups.length=0,this._popupStack.length>0)){for(var i=t;i!=this.displayObject.stage&&null!=i;){if(i.$owner){var e=this._popupStack.indexOf(i.$owner);if(-1!=e){for(var s=this._popupStack.length-1;s>e;s--){var n=this._popupStack.pop();this.closePopup(n),this._justClosedPopups.push(n)}return}}i=i.parent}var r=this._popupStack.length;for(s=r-1;s>=0;s--)n=this._popupStack[s],this.closePopup(n),this._justClosedPopups.push(n);this._popupStack.length=0}},s.__stageMouseDown=function(t){for(var i=t.target;i!=this.displayObject.stage&&null!=i;){if(i.$owner){var e=i.$owner;if(e.touchable&&e.focusable){this.setFocus(e);break}}i=i.parent}null!=this._tooltipWin&&this.hideTooltips(),this.checkPopups(t.target)},s.__stageMouseUp=function(){this._checkPopups=!1},s.__winResize=function(){this.setSize(e.stage.width,e.stage.height)},r(0,s,"hasModalWindow",function(){return null!=this._modalLayer.parent}),r(0,s,"modalWaiting",function(){return this._modalWaitPane&&this._modalWaitPane.inContainer}),r(0,s,"focus",function(){return this._focusedObject&&!this._focusedObject.onStage&&(this._focusedObject=null),this._focusedObject},function(t){if(t&&(!t.focusable||!t.onStage))throw"invalid focus target";this.setFocus(t)}),r(0,s,"hasAnyPopup",function(){return 0!=this._popupStack.length}),r(0,s,"volumeScale",function(){return this._volumeScale},function(t){this._volumeScale=t}),r(1,i,"inst",function(){return null==fairygui.GRoot._inst&&new i,fairygui.GRoot._inst},fairygui.GComponent._$SET_inst),i._inst=null,i}(at),At=function(t){function i(){this._grip=null,this._arrowButton1=null,this._arrowButton2=null,this._bar=null,this._target=null,this._vertical=!1,this._scrollPerc=0,this._fixedGripSize=!1,this._dragOffset=null,i.__super.call(this),this._dragOffset=new laya.maths.Point,this._scrollPerc=0}n(i,"fairygui.GScrollBar",t);var h=i.prototype;return h.setScrollPane=function(t,i){this._target=t,this._vertical=i},h.constructFromXML=function(i){return t.prototype.constructFromXML.call(this,i),i=et.findChildNode(i,"ScrollBar"),i&&(this._fixedGripSize="true"==i.getAttribute("fixedGripSize")),this._grip=this.getChild("grip"),this._grip?(this._bar=this.getChild("bar"),this._bar?(this._arrowButton1=this.getChild("arrow1"),this._arrowButton2=this.getChild("arrow2"),this._grip.on("mousedown",this,this.__gripMouseDown),this._arrowButton1&&this._arrowButton1.on("mousedown",this,this.__arrowButton1Click),this._arrowButton2&&this._arrowButton2.on("mousedown",this,this.__arrowButton2Click),void this.on("mousedown",this,this.__barMouseDown)):void p.print("bar")):void p.print("grip")},h.__gripMouseDown=function(t){this._bar&&(t.stopPropagation(),e.stage.on("mousemove",this,this.__gripMouseMove),e.stage.on("mouseup",this,this.__gripMouseUp),this.globalToLocal(e.stage.mouseX,e.stage.mouseY,this._dragOffset),this._dragOffset.x-=this._grip.x,this._dragOffset.y-=this._grip.y)},h.__gripMouseMove=function(){var t=this.globalToLocal(e.stage.mouseX,e.stage.mouseY,fairygui.GScrollBar.sScrollbarHelperPoint);if(this._vertical){var i=t.y-this._dragOffset.y;this._target.setPercY((i-this._bar.y)/(this._bar.height-this._grip.height),!1)}else{var s=t.x-this._dragOffset.x;this._target.setPercX((s-this._bar.x)/(this._bar.width-this._grip.width),!1)}},h.__gripMouseUp=function(t){this._bar&&(e.stage.off("mousemove",this,this.__gripMouseMove),e.stage.off("mouseup",this,this.__gripMouseUp))},h.__arrowButton1Click=function(t){t.stopPropagation(),this._vertical?this._target.scrollUp():this._target.scrollLeft()},h.__arrowButton2Click=function(t){t.stopPropagation(),this._vertical?this._target.scrollDown():this._target.scrollRight()},h.__barMouseDown=function(t){var i=this._grip.globalToLocal(e.stage.mouseX,e.stage.mouseY,fairygui.GScrollBar.sScrollbarHelperPoint);this._vertical?i.y<0?this._target.scrollUp(4):this._target.scrollDown(4):i.x<0?this._target.scrollLeft(4):this._target.scrollRight(4)},r(0,h,"displayPerc",null,function(t){this._vertical?(this._fixedGripSize||(this._grip.height=t*this._bar.height),this._grip.y=this._bar.y+(this._bar.height-this._grip.height)*this._scrollPerc):(this._fixedGripSize||(this._grip.width=t*this._bar.width),this._grip.x=this._bar.x+(this._bar.width-this._grip.width)*this._scrollPerc)}),r(0,h,"scrollPerc",null,function(t){this._scrollPerc=t,this._vertical?this._grip.y=this._bar.y+(this._bar.height-this._grip.height)*this._scrollPerc:this._grip.x=this._bar.x+(this._bar.width-this._grip.width)*this._scrollPerc}),r(0,h,"minSize",function(){return this._vertical?(null!=this._arrowButton1?this._arrowButton1.height:0)+(null!=this._arrowButton2?this._arrowButton2.height:0):(null!=this._arrowButton1?this._arrowButton1.width:0)+(null!=this._arrowButton2?this._arrowButton2.width:0)}),s(i,["sScrollbarHelperPoint",function(){return this.sScrollbarHelperPoint=new m}]),i}(at),Tt=function(t){function i(){this._max=0,this._value=0,this._titleType=0,this._titleObject=null,this._aniObject=null,this._barObjectH=null,this._barObjectV=null,this._barMaxWidth=0,this._barMaxHeight=0,this._barMaxWidthDelta=0,this._barMaxHeightDelta=0,this._gripObject=null,this._clickPos=null,this._clickPercent=0,i.__super.call(this),this._titleType=0,this._value=50,this._max=100,this._clickPos=new laya.maths.Point}n(i,"fairygui.GSlider",t);var h=i.prototype;return h.update=function(){var t=Math.min(this._value/this._max,1);this.updateWidthPercent(t)},h.updateWidthPercent=function(t){if(this._titleObject)switch(this._titleType){case 0:this._titleObject.text=Math.round(100*t)+"%";break;case 1:this._titleObject.text=this._value+"/"+this._max;
break;case 2:this._titleObject.text=""+this._value;break;case 3:this._titleObject.text=""+this._max}this._barObjectH&&(this._barObjectH.width=(this.width-this._barMaxWidthDelta)*t),this._barObjectV&&(this._barObjectV.height=(this.height-this._barMaxHeightDelta)*t),this._aniObject instanceof fairygui.GMovieClip&&(this._aniObject.frame=Math.round(100*t))},h.constructFromXML=function(i){t.prototype.constructFromXML.call(this,i),i=et.findChildNode(i,"Slider");var e;e=i.getAttribute("titleType"),e&&(this._titleType=Y.parse(e)),this._titleObject=this.getChild("title"),this._barObjectH=this.getChild("bar"),this._barObjectV=this.getChild("bar_v"),this._aniObject=this.getChild("ani"),this._gripObject=this.getChild("grip"),this._barObjectH&&(this._barMaxWidth=this._barObjectH.width,this._barMaxWidthDelta=this.width-this._barMaxWidth),this._barObjectV&&(this._barMaxHeight=this._barObjectV.height,this._barMaxHeightDelta=this.height-this._barMaxHeight),this._gripObject&&this._gripObject.on("mousedown",this,this.__gripMouseDown)},h.handleSizeChanged=function(){t.prototype.handleSizeChanged.call(this),this._barObjectH&&(this._barMaxWidth=this.width-this._barMaxWidthDelta),this._barObjectV&&(this._barMaxHeight=this.height-this._barMaxHeightDelta),this._underConstruct||this.update()},h.setup_afterAdd=function(t){fairygui.GObject.prototype.setup_afterAdd.call(this,t),t=et.findChildNode(t,"Slider"),t&&(this._value=parseInt(t.getAttribute("value")),this._max=parseInt(t.getAttribute("max"))),this.update()},h.__gripMouseDown=function(t){this._clickPos=this.globalToLocal(e.stage.mouseX,e.stage.mouseY),this._clickPercent=this._value/this._max,e.stage.on("mousemove",this,this.__gripMouseMove),e.stage.on("mouseup",this,this.__gripMouseUp)},h.__gripMouseMove=function(t){var i=this.globalToLocal(e.stage.mouseX,e.stage.mouseY,fairygui.GSlider.sSilderHelperPoint),s=i.x-this._clickPos.x,n=i.y-this._clickPos.y,r=NaN;r=this._barObjectH?this._clickPercent+s/this._barMaxWidth:this._clickPercent+n/this._barMaxHeight,r>1?r=1:0>r&&(r=0);var h=Math.round(this._max*r);h!=this._value&&(this._value=h,L.dispatch("fui_state_changed",this.displayObject,t)),this.updateWidthPercent(r)},h.__gripMouseUp=function(t){var i=this._value/this._max;this.updateWidthPercent(i),e.stage.off("mousemove",this,this.__gripMouseMove),e.stage.off("mouseup",this,this.__gripMouseUp)},r(0,h,"max",function(){return this._max},function(t){this._max!=t&&(this._max=t,this.update())}),r(0,h,"titleType",function(){return this._titleType},function(t){this._titleType=t}),r(0,h,"value",function(){return this._value},function(t){this._value!=t&&(this._value=t,this.update())}),s(i,["sSilderHelperPoint",function(){return this.sSilderHelperPoint=new m}]),i}(at),Ft=(function(t){function i(){this._contentPane=null,this._modalWaitPane=null,this._closeButton=null,this._dragArea=null,this._contentArea=null,this._frame=null,this._modal=!1,this._uiSources=null,this._inited=!1,this._loading=!1,this._requestingCmd=0,this.bringToFontOnClick=!1,i.__super.call(this),this.focusable=!0,this._uiSources=[],this.bringToFontOnClick=J.bringWindowToFrontOnClick,this.displayObject.on("display",this,this.__onShown),this.displayObject.on("undisplay",this,this.__onHidden),this.displayObject.on("mousedown",this,this.__mouseDown)}n(i,"fairygui.Window",t,"Window2");var e=i.prototype;return e.addUISource=function(t){this._uiSources.push(t)},e.show=function(){kt.inst.showWindow(this)},e.showOn=function(t){t.showWindow(this)},e.hide=function(){this.isShowing&&this.doHideAnimation()},e.hideImmediately=function(){var t=this.parent instanceof fairygui.GRoot?this.parent:null;t||(t=kt.inst),t.hideWindowImmediately(this)},e.centerOn=function(t,i){void 0===i&&(i=!1),this.setXY(Math.round((t.width-this.width)/2),Math.round((t.height-this.height)/2)),i&&(this.addRelation(t,3),this.addRelation(t,10))},e.toggleStatus=function(){this.isTop?this.hide():this.show()},e.bringToFront=function(){this.root.bringToFront(this)},e.showModalWait=function(t){void 0===t&&(t=0),0!=t&&(this._requestingCmd=t),J.windowModalWaiting&&(this._modalWaitPane||(this._modalWaitPane=it.createObjectFromURL(J.windowModalWaiting)),this.layoutModalWaitPane(),this.addChild(this._modalWaitPane))},e.layoutModalWaitPane=function(){if(null!=this._contentArea){var t=this._frame.localToGlobal();t=this.globalToLocal(t.x,t.y,t),this._modalWaitPane.setXY(t.x+this._contentArea.x,t.y+this._contentArea.y),this._modalWaitPane.setSize(this._contentArea.width,this._contentArea.height)}else this._modalWaitPane.setSize(this.width,this.height)},e.closeModalWait=function(t){return void 0===t&&(t=0),0!=t&&this._requestingCmd!=t?!1:(this._requestingCmd=0,this._modalWaitPane&&null!=this._modalWaitPane.parent&&this.removeChild(this._modalWaitPane),!0)},e.init=function(){if(!this._inited&&!this._loading)if(this._uiSources.length>0){this._loading=!1;for(var t=this._uiSources.length,i=0;t>i;i++){var e=this._uiSources[i];e.loaded||(e.load(this.__uiLoadComplete,this),this._loading=!0)}this._loading||this._init()}else this._init()},e.onInit=function(){},e.onShown=function(){},e.onHide=function(){},e.doShowAnimation=function(){this.onShown()},e.doHideAnimation=function(){this.hideImmediately()},e.__uiLoadComplete=function(){for(var t=this._uiSources.length,i=0;t>i;i++){var e=this._uiSources[i];if(!e.loaded)return}this._loading=!1,this._init()},e._init=function(){this._inited=!0,this.onInit(),this.isShowing&&this.doShowAnimation()},e.dispose=function(){null!=this.parent&&this.hideImmediately(),t.prototype.dispose.call(this)},e.closeEventHandler=function(){this.hide()},e.__onShown=function(){this._inited?this.doShowAnimation():this.init()},e.__onHidden=function(){this.closeModalWait(),this.onHide()},e.__mouseDown=function(){this.isShowing&&this.bringToFontOnClick&&this.bringToFront()},e.__dragStart=function(t){M.cast(t.currentTarget).stopDrag(),this.startDrag()},r(0,e,"contentPane",function(){return this._contentPane},function(t){this._contentPane!=t&&(null!=this._contentPane&&this.removeChild(this._contentPane),this._contentPane=t,null!=this._contentPane&&(this.addChild(this._contentPane),this.setSize(this._contentPane.width,this._contentPane.height),this._contentPane.addRelation(this,24),this._frame=this._contentPane.getChild("frame"),null!=this._frame&&(this.closeButton=this._frame.getChild("closeButton"),this.dragArea=this._frame.getChild("dragArea"),this.contentArea=this._frame.getChild("contentArea"))))}),r(0,e,"isShowing",function(){return null!=this.parent}),r(0,e,"isTop",function(){return null!=this.parent&&this.parent.getChildIndex(this)==this.parent.numChildren-1}),r(0,e,"modal",function(){return this._modal},function(t){this._modal=t}),r(0,e,"dragArea",function(){return this._dragArea},function(t){this._dragArea!=t&&(null!=this._dragArea&&(this._dragArea.draggable=!1,this._dragArea.off("fui_drag_start",this,this.__dragStart)),this._dragArea=t,null!=this._dragArea&&(this._dragArea instanceof fairygui.GGraph&&this._dragArea.asGraph.drawRect(0,null,null),this._dragArea.draggable=!0,this._dragArea.on("fui_drag_start",this,this.__dragStart)))}),r(0,e,"frame",function(){return this._frame}),r(0,e,"closeButton",function(){return this._closeButton},function(t){null!=this._closeButton&&this._closeButton.offClick(this,this.closeEventHandler),this._closeButton=t,null!=this._closeButton&&this._closeButton.onClick(this,this.closeEventHandler)}),r(0,e,"contentArea",function(){return this._contentArea},function(t){this._contentArea=t}),r(0,e,"modalWaiting",function(){return this._modalWaitPane&&null!=this._modalWaitPane.parent}),i}(at),function(t){function i(){this._texture=null,this._scaleByTile=!1,this._scale9Grid=null,this._tileGridIndice=0,this._textureScaleX=0,this._textureScaleY=0,this._needRebuild=!1,i.__super.call(this),this.mouseEnabled=!1,this._textureScaleX=1,this._textureScaleY=1}n(i,"fairygui.display.Image",t,"Image1");var s=i.prototype;return s.scaleTexture=function(t,i){this._textureScaleX==t&&this._textureScaleY==i||(this._textureScaleX=t,this._textureScaleY=i,this._texture&&this.size(this._texture.width*t,this._texture.height*i),this.markChanged())},s.markChanged=function(){this._needRebuild||(this._needRebuild=!0,e.timer.callLater(this,this.rebuild))},s.rebuild=function(){this._needRebuild=!1;var t=this.graphics;if(t.clear(),null==this._texture)return void this.repaint();var i=this.width,e=this.height,s=this._texture.width,n=this._texture.height;if(0==i||0==e)return void this.repaint();if(this._scaleByTile)t.fillTexture(this._texture,0,0,i,e);else if(null!=this._scale9Grid){var r=this._scale9Grid.x,h=Math.max(s-this._scale9Grid.right,0),a=this._scale9Grid.y,o=Math.max(n-this._scale9Grid.bottom,0),l=NaN;e>=n-this._scale9Grid.height?(a=this._scale9Grid.y,o=n-this._scale9Grid.bottom):(l=this._scale9Grid.y/(n-this._scale9Grid.bottom),l=e*l/(1+l),a=Math.round(l),o=e-l),i>=s-this._scale9Grid.width?(r=this._scale9Grid.x,h=s-this._scale9Grid.right):(l=this._scale9Grid.x/(s-this._scale9Grid.right),l=i*l/(1+l),r=Math.round(l),h=i-l);var u=Math.max(i-r-h,0),_=Math.max(e-a-o,0);r&&a&&t.drawTexture(fairygui.display.Image.getTexture(this._texture,0,0,r,a),0,0,r,a),h&&a&&t.drawTexture(fairygui.display.Image.getTexture(this._texture,s-h,0,h,a),i-h,0,h,a),r&&o&&t.drawTexture(fairygui.display.Image.getTexture(this._texture,0,n-o,r,o),0,e-o,r,o),h&&o&&t.drawTexture(fairygui.display.Image.getTexture(this._texture,s-h,n-o,h,o),i-h,e-o,h,o),u&&a&&this.drawTexture(0,fairygui.display.Image.getTexture(this._texture,r,0,s-r-h,a),r,0,u,a),u&&o&&this.drawTexture(1,fairygui.display.Image.getTexture(this._texture,r,n-o,s-r-h,o),r,e-o,u,o),_&&r&&this.drawTexture(2,fairygui.display.Image.getTexture(this._texture,0,a,r,n-a-o),0,a,r,_),_&&h&&this.drawTexture(3,fairygui.display.Image.getTexture(this._texture,s-h,a,h,n-a-o),i-h,a,h,_),u&&_&&this.drawTexture(4,fairygui.display.Image.getTexture(this._texture,r,a,s-r-h,n-a-o),r,a,u,_)}else t.drawTexture(this._texture,0,0,i,e);this.repaint()},s.drawTexture=function(t,i,e,s,n,r){void 0===n&&(n=0),void 0===r&&(r=0),-1==t||0==(this._tileGridIndice&1<<t)?this.graphics.drawTexture(i,e,s,n,r):this.graphics.fillTexture(i,e,s,n,r)},r(0,s,"scaleByTile",function(){return this._scaleByTile},function(t){this._scaleByTile!=t&&(this._scaleByTile=t,this.markChanged())}),r(0,s,"texture",function(){return this._texture},function(t){this._texture!=t&&(this._texture=t,this._texture?this.size(this._texture.width*this._textureScaleX,this._texture.height*this._textureScaleY):this.size(0,0),this.markChanged())}),r(0,s,"scale9Grid",function(){return this._scale9Grid},function(t){this._scale9Grid=t,this.markChanged()}),r(0,s,"tileGridIndice",function(){return this._tileGridIndice},function(t){this._tileGridIndice!=t&&(this._tileGridIndice=t,this.markChanged())}),i.getTexture=function(t,i,e,s,n){t.$GID||(t.$GID=C.getGID());var r=t.$GID+"."+i+"."+e+"."+s+"."+n,h=fairygui.display.Image._textureCache[r];return h||(h=fairygui.display.Image._textureCache[r]=x.create(t,i,e,s,n)),h},i.clearCache=function(){fairygui.display.Image._textureCache={}},i._textureCache={},i}(b)),Lt=function(t){function i(){this.interval=0,this.swing=!1,this.repeatDelay=0,this._texture=null,this._needRebuild=!1,this._playing=!1,this._playState=null,this._frameCount=0,this._frames=null,this._currentFrame=0,this._boundsRect=null,this._start=0,this._end=0,this._times=0,this._endAt=0,this._status=0,this._endHandler=null,i.__super.call(this),this._playState=new T,this._playing=!0,this.mouseEnabled=!1,this.setPlaySettings(),this.on("display",this,this.__addToStage),this.on("undisplay",this,this.__removeFromStage)}n(i,"fairygui.display.MovieClip",t,"MovieClip1");var s=i.prototype;return s.setPlaySettings=function(t,i,e,s,n){void 0===t&&(t=0),void 0===i&&(i=-1),void 0===e&&(e=0),void 0===s&&(s=-1),this._start=t,this._end=i,(-1==this._end||this._end>this._frameCount-1)&&(this._end=this._frameCount-1),this._times=e,this._endAt=s,-1==this._endAt&&(this._endAt=this._end),this._status=0,this._endHandler=n,this.currentFrame=t},s.update=function(){this._playing&&0!=this._frameCount&&3!=this._status&&(this._playState.update(this),this._currentFrame!=this._playState.currentFrame&&(1==this._status?(this._currentFrame=this._start,this._playState.currentFrame=this._currentFrame,this._status=0):2==this._status?(this._currentFrame=this._endAt,this._playState.currentFrame=this._currentFrame,this._status=3,null!=this._endHandler&&this._endHandler.run()):(this._currentFrame=this._playState.currentFrame,this._currentFrame==this._end&&this._times>0&&(this._times--,0==this._times?this._status=2:this._status=1)),this.setFrame(this._frames[this._currentFrame])))},s.setFrame=function(t){this.graphics.clear(),null!=t&&this.graphics.drawTexture(t.texture,t.rect.x,t.rect.y)},s.__addToStage=function(){this._playing&&e.timer.frameLoop(1,this,this.update)},s.__removeFromStage=function(){this._playing&&e.timer.clear(this,this.update)},r(0,s,"frames",function(){return this._frames},function(t){this._frames=t,null!=this._frames?this._frameCount=this._frames.length:this._frameCount=0,(-1==this._end||this._end>this._frameCount-1)&&(this._end=this._frameCount-1),(-1==this._endAt||this._endAt>this._frameCount-1)&&(this._endAt=this._frameCount-1),(this._currentFrame<0||this._currentFrame>this._frameCount-1)&&(this._currentFrame=this._frameCount-1),this._frameCount>0?this.setFrame(this._frames[this._currentFrame]):this.setFrame(null),this._playState.rewind()}),r(0,s,"playing",function(){return this._playing},function(t){this._playing=t,t&&null!=this.stage?e.timer.frameLoop(1,this,this.update):e.timer.clear(this,this.update)}),r(0,s,"frameCount",function(){return this._frameCount}),r(0,s,"boundsRect",function(){return this._boundsRect},function(t){this._boundsRect=t}),r(0,s,"currentFrame",function(){return this._currentFrame},function(t){this._currentFrame!=t&&(this._currentFrame=t,this._playState.currentFrame=t,this.setFrame(this._currentFrame<this._frameCount?this._frames[this._currentFrame]:null))}),i}(b);e.__init([wt,St,Z,it,K,rt,ot,dt,pt,U])}(window,document,Laya);